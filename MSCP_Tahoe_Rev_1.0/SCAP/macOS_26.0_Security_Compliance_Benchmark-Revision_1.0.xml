<?xml version="1.0" encoding="UTF-8"?>
<data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" id="scap_gov.nist.mscp.content_collection_macOS_26.0" schematron-version="1.4">
  <data-stream timestamp="2025-09-11T15:25:32" id="scap_gov.nist.mscp.content_datastream_macOS_26.0" scap-version="1.4" use-case="CONFIGURATION">
    <dictionaries>
      <component-ref xmlns:ns0="http://www.w3.org/1999/xlink" id="scap_gov.nist.mscp.content_cref_macOS_26.0_macOS-cpe-dictionary.xml" ns0:type="simple" ns0:href="#scap_gov.nist.mscp.content_comp_macOS_26.0_macOS-cpe-dictionary.xml">
        <catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
          <uri name="macOS-cpe-oval.xml" uri="#scap_gov.nist.mscp.content_cref_macOS_26.0_macOS-cpe-oval.xml"/>
        </catalog>
      </component-ref>
    </dictionaries>
    <checklists>
      <component-ref xmlns:ns0="http://www.w3.org/1999/xlink" id="scap_gov.nist.mscp.content_cref_macOS_26.0_xccdf.xml" ns0:type="simple" ns0:href="#scap_gov.nist.mscp.content_comp_macOS_26.0_xccdf.xml">
        <catalog xmlns="urn:oasis:names:tc:entity:xmlns:xml:catalog">
          <uri name="oval.xml" uri="#scap_gov.nist.mscp.content_cref_macOS_26.0_check_1"/>
          <uri name="ocil.xml" uri="#scap_gov.nist.mscp.content_cref_macOS_26.0_check_2"/>
        </catalog>
      </component-ref>
    </checklists>
    <checks>
      <component-ref xmlns:ns0="http://www.w3.org/1999/xlink" id="scap_gov.nist.mscp.content_cref_macOS_26.0_macOS-cpe-oval.xml" ns0:type="simple" ns0:href="#scap_gov.nist.mscp.content_comp_macOS_26.0_macOS-cpe-oval.xml"/>
      <component-ref xmlns:ns0="http://www.w3.org/1999/xlink" id="scap_gov.nist.mscp.content_cref_macOS_26.0_check_1" ns0:type="simple" ns0:href="#scap_gov.nist.mscp.content_comp_macOS_26.0_check_1"/>
      <component-ref xmlns:ns0="http://www.w3.org/1999/xlink" id="scap_gov.nist.mscp.content_cref_macOS_26.0_check_2" ns0:type="simple" ns0:href="#scap_gov.nist.mscp.content_comp_macOS_26.0_check_2"/>
    </checks>
  </data-stream>
  <component id="scap_gov.nist.mscp.content_comp_macOS_26.0_xccdf.xml" timestamp="2025-09-11T15:25:32">
    <Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2" id="xccdf_gov.nist.mscp.content_benchmark_macOS_26.0" style="SCAP_1.4" resolved="true" xml:lang="en">
      <status date="2025-09-11Z">draft</status>
      <title>macOS 26.0: Security Configuration</title>
      <description>
        macOS 26.0: Security Configuration
      </description>
      <reference href="https://csrc.nist.gov/projects/security-content-automation-protocol/scap-releases/scap-1-3">
        <title xmlns="http://purl.org/dc/elements/1.1/">Security Content Automation Protocol</title>
        <publisher xmlns="http://purl.org/dc/elements/1.1/">National Institute of Standards and Technology</publisher>
      </reference>
      <reference href="macOS-cpe-dictionary.xml">platform-cpe-dictionary</reference>
      <reference href="macOS-cpe-oval.xml">platform-cpe-oval</reference>
      <platform idref="cpe:2.3:o:apple:macos:26.0:*:*:*:*:*:*:*"/>
      <version time="2025-09-11T15:25:32" update="https://github.com/usnistgov/macos_security">1.0</version>
      <metadata>
        <creator xmlns="http://purl.org/dc/elements/1.1/">National Institute of Standards and Technology</creator>
        <publisher xmlns="http://purl.org/dc/elements/1.1/">National Institute of Standards and Technology</publisher>
        <source xmlns="http://purl.org/dc/elements/1.1/">https://github.com/usnistgov/macos_security/releases/latest</source>
        <contributor xmlns="http://purl.org/dc/elements/1.1/">Bob Gendler - National Institute of Standards and Technology</contributor>
        <contributor xmlns="http://purl.org/dc/elements/1.1/">Dan Brodjieski - National Aeronautics and Space Administration</contributor>
        <contributor xmlns="http://purl.org/dc/elements/1.1/">Allen Golbig - Jamf</contributor>
      </metadata>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-171">
        <title>800-171</title>
        <description>This profile selects all rules tagged as 800-171.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_privilege_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_50_percent_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r4_high">
        <title>800-53r4_high</title>
        <description>This profile selects all rules tagged as 800-53r4_high.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_enforce_access_restrictions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_gui_sessions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_fail_secure_state_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_created_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_modified_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_removal_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_isolate_security_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_crypto_audit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_50_percent_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r4_low">
        <title>800-53r4_low</title>
        <description>This profile selects all rules tagged as 800-53r4_low.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_50_percent_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r4_moderate">
        <title>800-53r4_moderate</title>
        <description>This profile selects all rules tagged as 800-53r4_moderate.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_created_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_modified_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_removal_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_account_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_50_percent_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r5_high">
        <title>800-53r5_high</title>
        <description>This profile selects all rules tagged as 800-53r5_high.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_enforce_access_restrictions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_gui_sessions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_fail_secure_state_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_authorized_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_isolate_security_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_crypto_audit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_non_repudiation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r5_low">
        <title>800-53r5_low</title>
        <description>This profile selects all rules tagged as 800-53r5_low.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r5_moderate">
        <title>800-53r5_moderate</title>
        <description>This profile selects all rules tagged as 800-53r5_moderate.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cisv8">
        <title>cisv8</title>
        <description>This profile selects all rules tagged as cisv8.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_encrypted_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_install_macos_updates_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_menu_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_software_update_download_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_auto_backup_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_softwareupdate_current_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_listen_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wake_network_access_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_download_software_update_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_menu_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_off_load_records_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ess_installed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_warn_fraudulent_website_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_library_validation_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_anti_virus_installed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_world_writable_system_folder_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_open_safe_downloads_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_advertising_privacy_protection_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sleep_and_display_sleep_apple_silicon_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_software_update_app_update_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mfa_network_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_full_website_address_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mobile_file_integrity_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_world_writable_library_folder_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_terminal_secure_keyboard_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_directory_services_configured_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_status_bar_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_wide_applications_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_prevent_cross-site_tracking_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cmmc_lvl1">
        <title>cmmc_lvl1</title>
        <description>This profile selects all rules tagged as cmmc_lvl1.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cmmc_lvl2">
        <title>cmmc_lvl2</title>
        <description>This profile selects all rules tagged as cmmc_lvl2.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dvdram_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_bluray_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_enclave_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_disk_image_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_cd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_dvd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_removable_media_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bluray_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_cd_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cnssi-1253_high">
        <title>cnssi-1253_high</title>
        <description>This profile selects all rules tagged as cnssi-1253_high.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_off_load_records_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_enforce_dual_auth_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_enforce_access_restrictions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_gui_sessions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dvdram_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_verify_remote_disconnection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logoff_capability_and_message_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_fail_secure_state_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_execution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_allow_info_passed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_remove_software_components_after_updates_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_autofill_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_bluray_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_predictable_behavior_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_enclave_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_disk_image_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_authorized_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_disconnect_remote_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_cd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_isolate_security_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_messages_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_grant_privs_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_parental_controls_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_change_security_attributes_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_dvd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_default_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_removable_media_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_crypto_audit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_privilege_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bluray_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_facetime_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_cd_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_non_repudiation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notify_unauthorized_baseline_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_calendar_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_lower_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_upper_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cnssi-1253_low">
        <title>cnssi-1253_low</title>
        <description>This profile selects all rules tagged as cnssi-1253_low.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_off_load_records_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dvdram_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_verify_remote_disconnection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logoff_capability_and_message_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_execution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_allow_info_passed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_remove_software_components_after_updates_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_autofill_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_bluray_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_predictable_behavior_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_enclave_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_disk_image_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_disconnect_remote_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_cd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_messages_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_grant_privs_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_parental_controls_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_change_security_attributes_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_dvd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_default_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_removable_media_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_privilege_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bluray_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_facetime_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_cd_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_calendar_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_lower_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_upper_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cnssi-1253_moderate">
        <title>cnssi-1253_moderate</title>
        <description>This profile selects all rules tagged as cnssi-1253_moderate.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_off_load_records_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_enforce_access_restrictions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_gui_sessions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dvdram_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_verify_remote_disconnection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_logoff_capability_and_message_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_execution_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_allow_info_passed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_remove_software_components_after_updates_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_autofill_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_bluray_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_predictable_behavior_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_enclave_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_disk_image_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_limit_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_provide_disconnect_remote_access_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_cd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_messages_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_grant_privs_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_parental_controls_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_change_security_attributes_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_blank_dvd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_default_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_removable_media_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_reauth_privilege_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bluray_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_facetime_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_cd_read_only_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_non_repudiation_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_calendar_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_lower_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_upper_case_character_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cis_lvl1">
        <title>cis_lvl1</title>
        <description>This profile selects all rules tagged as cis_lvl1.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_encrypted_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_install_macos_updates_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_menu_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_software_update_download_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_softwareupdate_current_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wake_network_access_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_warn_fraudulent_website_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_anti_virus_installed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_world_writable_system_folder_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_open_safe_downloads_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_advertising_privacy_protection_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_guest_folder_removed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_software_update_app_update_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_full_website_address_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mobile_file_integrity_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_terminal_secure_keyboard_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_status_bar_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_wide_applications_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_software_update_deferral_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_prevent_cross-site_tracking_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_cis_lvl1" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_cis_lvl1" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_cis_lvl2">
        <title>cis_lvl2</title>
        <description>This profile selects all rules tagged as cis_lvl2.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_encrypted_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_install_macos_updates_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_menu_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_software_update_download_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_auto_backup_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_softwareupdate_current_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wake_network_access_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_warn_fraudulent_website_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_anti_virus_installed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_world_writable_system_folder_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_open_safe_downloads_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_advertising_privacy_protection_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sleep_and_display_sleep_apple_silicon_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_guest_folder_removed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_software_update_app_update_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_full_website_address_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mobile_file_integrity_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_world_writable_library_folder_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_terminal_secure_keyboard_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_show_status_bar_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_system_wide_applications_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_software_update_deferral_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_safari_prevent_cross-site_tracking_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_cis_lvl2" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_stig">
        <title>stig</title>
        <description>This profile selects all rules tagged as stig.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_facetime_app_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_camera_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_stig" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_ddm">
        <title>ddm</title>
        <description>This profile selects all rules tagged as ddm.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_system_settings_download_software_update_enforce_recommended" selected="true"/>
      </Profile>
      <Profile id="xccdf_gov.nist.mscp.content_profile_800-53r5_privacy">
        <title>800-53r5_privacy</title>
        <description>This profile selects all rules tagged as 800-53r5_privacy.</description>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_privacy_principle_minimization_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_pii_deidentification_recommended" selected="true"/>
        <select idref="xccdf_gov.nist.mscp.content_rule_os_pii_quality_control_recommended" selected="true"/>
      </Profile>
      <Group id="xccdf_gov.nist.mscp.content_group_all_rules">
        <title>All rules</title>
        <description>
         All the rules
        </description>
        <warning category="general">
          The check/fix commands outlined in this section must be run with elevated privileges.
        </warning>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_internet_accounts_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the Internet Accounts System Preference Pane</title>
          <description>The Internet Accounts System Setting _MUST_ be disabled to prevent the addition of unauthorized internet accounts.

[IMPORTANT]
====
Some organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c com.apple.Internet-Accounts-Settings.extension
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), CM-7(5), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20, CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06, 03.04.08</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8, 15.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95381-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.Internet-Accounts-Settings.extension&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:1"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_encrypted_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Time Machine Volumes are Encrypted</title>
          <description>Time Machine volumes _MUST_ be encrypted.
            
            /usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.TimeMachine.plist | grep -c NotEncrypted
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.4.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.6, 3.11, 11.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95410-7</ident>
          <fixtext>. Go to System Settings -&gt; Time Machine
. Click *Select Disk*
. Select existing Backup Disk under *Available Disks*
. Click *Encrypt Backups*
. Click *Use Disk*

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:2"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_install_macos_updates_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce macOS Updates are Automatically Installed</title>
          <description>Software Update _MUST_ be configured to enforce automatic installation of macOS updates is enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticallyInstallMacOSUpdates').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95380-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SoftwareUpdate) payload type:

[source,xml]
----
&lt;key&gt;AutomaticallyInstallMacOSUpdates&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:3"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Session Lock After Screen Saver is Started</title>
          <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95395-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;askForPasswordDelay&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:4"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Session Lock After Screen Saver is Started</title>
          <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95395-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;askForPasswordDelay&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:5"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Session Lock After Screen Saver is Started</title>
          <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95395-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;askForPasswordDelay&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:6"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Session Lock After Screen Saver is Started</title>
          <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95395-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;askForPasswordDelay&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:7"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_wallet_applepay_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the System Settings Pane for Wallet and Apple Pay</title>
          <description>The System Settings pane for Wallet and Apple Pay _MUST_ be disabled.

Disabling the System Settings pane prevents the users from configuring Wallet and Apple Pay.
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c "com.apple.WalletSettingsExtension"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06, 03.04.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002052</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95418-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.WalletSettingsExtension&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:8"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_menu_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Location Services Is In the Menu Bar</title>
          <description>Location Services menu item _MUST_ be enabled.
            
            /usr/bin/defaults read /Library/Preferences/com.apple.locationmenu.plist ShowSystemServices
            
            
Result: {'boolean': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.1.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95385-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/defaults write /Library/Preferences/com.apple.locationmenu.plist ShowSystemServices -bool true
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:9"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_guest_access_smb_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Guest Access to Shared SMB Folders</title>
          <description>Guest access to shared Server Message Block (SMB) folders _MUST_ be disabled.

Turning off guest access prevents anonymous users from accessing files shared via SMB.
            
            /usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess
            
            
Result: {'boolean': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(9), AC-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2, AC-2(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.13.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95373-7</ident>
          <fixtext>[source,bash]
----
/usr/sbin/sysadminctl -smbGuestAccess off
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:10"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_printer_sharing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Printer Sharing</title>
          <description>Printer Sharing _MUST_ be disabled.
            
            /usr/sbin/cupsctl | /usr/bin/grep -c "_share_printers=0"
            
            
Result: {'boolean': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002240</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95391-9</ident>
          <fixtext>[source,bash]
----
/usr/sbin/cupsctl --no-share-printers
/usr/bin/lpstat -p | awk '{print $2}'| /usr/bin/xargs -I{} lpadmin -p {} -o printer-is-shared=false
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:11"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_menu_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Bluetooth Menu</title>
          <description>The bluetooth menu _MUST_ be enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.controlcenter')\
.objectForKey('Bluetooth').js
EOS
            
            
Result: {'integer': 18}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8, 13.9</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95359-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.controlcenter) payload type:

[source,xml]
----
&lt;key&gt;Bluetooth&lt;/key&gt;
&lt;integer&gt;18&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:12"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_system_wide_preferences_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Administrator Password to Modify System-Wide Preferences</title>
          <description>The system _MUST_ be configured to require an administrator password in order to modify the system-wide preferences in System Settings.

Some Preference Panes in System Settings contain settings that affect the entire system. Requiring a password to unlock these system-wide settings reduces the risk of a non-authorized user modifying system configurations.
            
            authDBs=("system.preferences" "system.preferences.energysaver" "system.preferences.network" "system.preferences.printing" "system.preferences.sharing" "system.preferences.softwareupdate" "system.preferences.startupdisk" "system.preferences.timemachine")
result="1"
for section in ${authDBs[@]}; do
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "shared")]/following-sibling::*[1])' -) != "false" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath '//*[contains(text(), "group")]/following-sibling::*[1]/text()' - ) != "admin" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "authenticate-user")]/following-sibling::*[1])' -) != "true" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "session-owner")]/following-sibling::*[1])' -) != "false" ]]; then
    result="0"
  fi
done
echo $result
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6, AC-6(2), AC-6(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6, AC-6(1), AC-6(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002069</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.8 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95408-1</ident>
          <fixtext>[source,bash]
----
authDBs=("system.preferences" "system.preferences.energysaver" "system.preferences.network" "system.preferences.printing" "system.preferences.sharing" "system.preferences.softwareupdate" "system.preferences.startupdisk" "system.preferences.timemachine")

for section in ${authDBs[@]}; do
  /usr/bin/security -q authorizationdb read "$section" &gt; "/tmp/$section.plist"

  class_key_value=$(/usr/libexec/PlistBuddy -c "Print :class" "/tmp/$section.plist" 2&gt;&amp;1)
  if [[ "$class_key_value" == *"Does Not Exist"* ]]; then
    /usr/libexec/PlistBuddy -c "Add :class string user" "/tmp/$section.plist"
  else
    /usr/libexec/PlistBuddy -c "Set :class user" "/tmp/$section.plist"
  fi

  key_value=$(/usr/libexec/PlistBuddy -c "Print :shared" "/tmp/$section.plist" 2&gt;&amp;1)  	
  if [[ "$key_value" == *"Does Not Exist"* ]]; then
    /usr/libexec/PlistBuddy -c "Add :shared bool false" "/tmp/$section.plist"
  else
    /usr/libexec/PlistBuddy -c "Set :shared false" "/tmp/$section.plist"
  fi

  auth_user_key=$(/usr/libexec/PlistBuddy -c "Print :authenticate-user" "/tmp/$section.plist" 2&gt;&amp;1)  	
  if [[ "$auth_user_key" == *"Does Not Exist"* ]]; then
    /usr/libexec/PlistBuddy -c "Add :authenticate-user bool true" "/tmp/$section.plist"
  else
    /usr/libexec/PlistBuddy -c "Set :authenticate-user true" "/tmp/$section.plist"
  fi

  session_owner_key=$(/usr/libexec/PlistBuddy -c "Print :session-owner" "/tmp/$section.plist" 2&gt;&amp;1)  	
  if [[ "$session_owner_key" == *"Does Not Exist"* ]]; then
    /usr/libexec/PlistBuddy -c "Add :session-owner bool false" "/tmp/$section.plist"
  else
    /usr/libexec/PlistBuddy -c "Set :session-owner false" "/tmp/$section.plist"
  fi

  group_key=$(/usr/libexec/PlistBuddy -c "Print :group" "/tmp/$section.plist" 2&gt;&amp;1)
  if [[ "$group_key" == *"Does Not Exist"* ]]; then
    /usr/libexec/PlistBuddy -c "Add :group string admin" "/tmp/$section.plist"
  else
    /usr/libexec/PlistBuddy -c "Set :group admin" "/tmp/$section.plist"
  fi

  /usr/bin/security -q authorizationdb write "$section" &lt; "/tmp/$section.plist"
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:13"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Location Services</title>
          <description>Location Services _MUST_ be enabled.
            
            /usr/bin/sudo -u _locationd /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.locationd')\
.objectForKey('LocationServicesEnabled').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.1.1 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95384-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool true; 
pid=$(/bin/launchctl print system | /usr/bin/awk '/\tcom.apple.locationd/ {print $1}')
kill -9 $pid
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:14"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_improve_search_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Improve Search Information to Apple</title>
          <description>Sending data to Apple to help improve search _MUST_ be disabled. This will disable "Improve Search" within Spotlight in System Settings.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of search data will mitigate the risk of unwanted data being sent to Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\
.objectForKey('Search Queries Data Sharing Status').js
EOS
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002024</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.9.1</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95378-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.assistant.support) payload type:

[source,xml]
----
&lt;key&gt;Search Queries Data Sharing Status&lt;/key&gt;
&lt;integer&gt;2&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:15"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_guest_account_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the Guest Account</title>
          <description>Guest access _MUST_ be disabled.

Turning off guest access prevents anonymous users from accessing files.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('DisableGuestAccount'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('EnableGuestAccount'))
  if ( pref1 == true &amp;&amp; pref2 == false ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2, AC-2(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2, AC-2(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002063</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.13.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2, 6.2, 6.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95374-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;DisableGuestAccount&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;EnableGuestAccount&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:16"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_software_update_download_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Software Update Downloads Updates Automatically</title>
          <description>Software Update _MUST_ be configured to enforce automatic downloads of updates is enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticDownload').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95403-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SoftwareUpdate) payload type:

[source,xml]
----
&lt;key&gt;AutomaticDownload&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:17"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_personalized_advertising_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Personalized Advertising</title>
          <description>Ad tracking and targeted ads _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling ad tracking ensures that applications and advertisers are unable to track users' interests and deliver targeted advertisements.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowApplePersonalizedAdvertising').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002200</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95390-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowApplePersonalizedAdvertising&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:18"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Bluetooth When no Approved Device is Connected</title>
          <description>The macOS system _MUST_ be configured to disable Bluetooth unless there is an approved device connected.

[IMPORTANT]
====
Information System Security Officers (ISSOs) may make the risk-based decision not to disable Bluetooth, so as to maintain necessary functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCXBluetooth')\
.objectForKey('DisableBluetooth').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-18, SC-8, AC-18(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-18(3), SC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.16, 03.13.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002062</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8, 12.6, 13.9</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95358-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

NOTE: The following settings are in the (com.apple.ManagedClient.preferences) payload. This payload requires the additional settings to be sub-payloads within, containing their defined payload types.

Create a configuration profile containing the following keys in the (com.apple.MCXBluetooth) payload type:

[source,xml]
----
&lt;key&gt;DisableBluetooth&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:19"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_remote_management_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Remote Management</title>
          <description>Remote Management _MUST_ be disabled.
            
            /usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep -c "RemoteDesktopEnabled = 0"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002250</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 5.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95393-5</ident>
          <fixtext>[source,bash]
----
/System/Library/CoreServices/RemoteManagement/ARDAgent.app/Contents/Resources/kickstart -deactivate -stop
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:20"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_prompt_username_password_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Login Window to Prompt for Username and Password</title>
          <description>The login window _MUST_ be configured to prompt all users for both a username and a password.

By default, the system displays a list of known users on the login window, which can make it easier for a malicious user to gain access to someone else's account. Requiring users to type in both their username and password mitigates the risk of unauthorized users gaining access to the information system.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('SHOWFULLNAME').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005052</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95387-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;SHOWFULLNAME&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:21"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_apple_watch_unlock_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prevent Apple Watch from Terminating a Session Lock</title>
          <description>Apple Watches are not an approved authenticator and their use _MUST_ be disabled.

Disabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using an authorized identification and authentication procedures.

NOTE: Unlocking the system with an Apple Watch is not an approved authenticator for US Federal Government usage as it has not been verified to meet the strength requirements outlined in NIST SP 800-63.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAutoUnlock').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000001</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95355-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowAutoUnlock&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:22"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_smbd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Server Message Block Sharing</title>
          <description>Support for Server Message Block (SMB) file sharing is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.smbd" =&gt; disabled'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002001</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 5.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95401-6</ident>
          <fixtext>[source,bash]
----
/bin/launchctl disable system/com.apple.smbd
----
The system may need to be restarted for the update to take effect.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:23"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_secure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Secure Hot Corners</title>
          <description>Hot corners _MUST_ be secured.

The information system conceals, via the session lock, information previously visible on the display with a publicly viewable image. Although hot comers can be used to initiate a session lock or to launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.

[NOTE]
====
The check and fix are for the last logged in user. To get the last logged in user, run the following.
[source,bash]
----
CURRENT_USER=$( /usr/bin/defaults read /Library/Preferences/com.apple.loginwindow lastUserName )
----
====
            
            bl_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-bl-corner 2&gt;/dev/null)"
tl_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tl-corner 2&gt;/dev/null)"
tr_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tr-corner 2&gt;/dev/null)"
br_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-br-corner 2&gt;/dev/null)"

if [[ "$bl_corner" != "6" ]] &amp;&amp; [[ "$tl_corner" != "6" ]] &amp;&amp; [[ "$tr_corner" != "6" ]] &amp;&amp; [[ "$br_corner" != "6" ]]; then
  echo "0"
fi
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.7.1 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95376-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults delete /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-bl-corner 2&gt;/dev/null
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults delete /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tl-corner 2&gt;/dev/null
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults delete /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tr-corner 2&gt;/dev/null
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults delete /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-br-corner 2&gt;/dev/null
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:24"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Timeout</title>
          <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11, IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10, 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000070</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95397-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;idleTime&lt;/key&gt;
&lt;string&gt;1200&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:25"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Timeout</title>
          <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11, IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10, 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000070</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95397-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;idleTime&lt;/key&gt;
&lt;string&gt;1200&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:26"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Timeout</title>
          <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11, IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10, 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000070</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95397-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;idleTime&lt;/key&gt;
&lt;string&gt;1200&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:27"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_timeout_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Timeout</title>
          <description>The screen saver timeout _MUST_ be set to 900 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 900 seconds of inactivity.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 900 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11, IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10, 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000070</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95397-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;idleTime&lt;/key&gt;
&lt;string&gt;900&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:28"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Auto Logout After 86400 Seconds of Inactivity</title>
          <description>Auto logout _MUST_ be configured to automatically terminate a user session and log out the after 86400 seconds of inactivity.

NOTE:The maximum that macOS can be configured for autologoff is 86400 seconds.

[IMPORTANT]
====
The automatic logout may cause disruptions to an organization's workflow and/or loss of data. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting to disable the automatic logout setting.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('.GlobalPreferences')\
.objectForKey('com.apple.autologout.AutoLogOutDelay').js
EOS
            
            
Result: {'integer': '86400'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-12, AC-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01, 03.01.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000160</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95357-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (.GlobalPreferences) payload type:

[source,xml]
----
&lt;key&gt;com.apple.autologout.AutoLogOutDelay&lt;/key&gt;
&lt;string&gt;86400&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:29"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_logout_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Auto Logout After 86400 Seconds of Inactivity</title>
          <description>Auto logout _MUST_ be configured to automatically terminate a user session and log out the after 86400 seconds of inactivity.

NOTE:The maximum that macOS can be configured for autologoff is 86400 seconds.

[IMPORTANT]
====
The automatic logout may cause disruptions to an organization's workflow and/or loss of data. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting to disable the automatic logout setting.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('.GlobalPreferences')\
.objectForKey('com.apple.autologout.AutoLogOutDelay').js
EOS
            
            
Result: {'integer': '86400'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-12, AC-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01, 03.01.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000160</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95357-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (.GlobalPreferences) payload type:

[source,xml]
----
&lt;key&gt;com.apple.autologout.AutoLogOutDelay&lt;/key&gt;
&lt;string&gt;86400&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:30"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_password_hints_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Password Hints</title>
          <description>Password hints _MUST_ be disabled.

Password hints leak information about passwords that are currently in use and can lead to loss of confidentiality.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('RetriesUntilHint').js
EOS
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003012</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95389-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;RetriesUntilHint&lt;/key&gt;
&lt;integer&gt;0&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:31"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screen_sharing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Screen Sharing and Apple Remote Desktop</title>
          <description>Support for both Screen Sharing and Apple Remote Desktop (ARD) is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling screen sharing and ARD helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.
            
            result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.screensharing" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.screensharing 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95394-3</ident>
          <fixtext>[source,bash]
----
/bin/launchctl bootout system/com.apple.screensharing
/bin/launchctl disable system/com.apple.screensharing
----
NOTE - This will apply to the whole system

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:32"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_machine_auto_backup_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Time Machine for Automatic Backups</title>
          <description>Automatic backups _MUST_ be enabled when using Time Machine.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.TimeMachine')\
.objectForKey('AutoBackup').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.4.1 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 11.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95409-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.TimeMachine) payload type:

[source,xml]
----
&lt;key&gt;AutoBackup&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:33"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_touchid_unlock_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable TouchID for Unlocking the Device</title>
          <description>TouchID enables the ability to unlock a Mac system with a user's fingerprint.

TouchID _MUST_ be disabled for "Unlocking your Mac" on all macOS devices that are capable of using Touch ID.

The system _MUST_ remain locked until the user establishes access using an authorized identification and authentication method.

NOTE: TouchID is not an approved biometric authenticator for US Federal Government usage as it has not been verified to meet the strength requirements outlined in NIST SP 800-63.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFingerprintForUnlock').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002090</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95415-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowFingerprintForUnlock&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:34"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_when_connected_to_ethernet_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Wi-Fi When Connected to Ethernet</title>
          <description>The macOS should be configured to automatically disable Wi-Fi when connected to ethernet.

The use of Wi-Fi to connect to unauthorized networks may facilitate the exfiltration of mission data. Therefore, wireless networking capabilities internally embedded within information system components should be disabled when not intended to be used.

NOTE: If the system requires Wi-Fi to connect to an authorized network, this is not applicable.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, AC-18(1), AC-18(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-4, AC-18(1), AC-18(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.01.16</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95420-6</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_softwareupdate_current_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Software Update is Updated and Current</title>
          <description>Make sure Software Update is updated and current.

NOTE: Automatic fix can cause unplanned restarts and may lose work.
            
            softwareupdate_date_epoch=$(/bin/date -j -f "%Y-%m-%d" "$(/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist LastFullSuccessfulDate | /usr/bin/awk '{print $1}')" "+%s")
thirty_days_epoch=$(/bin/date -v -30d "+%s")
if [[ $softwareupdate_date_epoch -lt $thirty_days_epoch ]]; then
  /bin/echo "0"
else
  /bin/echo "1"
fi
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95405-7</ident>
          <fixtext>[source,bash]
----
/usr/sbin/softwareupdate -i -a
----
NOTE - This will apply to the whole system

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:36"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable External Intelligence Integrations</title>
          <description>Integration with external intelligence systems _MUST_ be disabled unless approved by the organization. Disabling external intelligence integration will mitigate the risk of data being sent to unapproved third party.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowExternalIntelligenceIntegrations').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95365-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowExternalIntelligenceIntegrations&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:37"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_siri_listen_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Siri Listen For is Disabled</title>
          <description>Siri has the ability to listen for "Hey Siri" or "Siri". Listen for _MUST_ be disabled.
            
            /usr/bin/sudo /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Siri')\
.objectForKey('VoiceTriggerUserEnabled').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95399-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Siri) payload type:

[source,xml]
----
&lt;key&gt;VoiceTriggerUserEnabled&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:38"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_internet_sharing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Internet Sharing</title>
          <description>If the system does not require Internet sharing, support for it is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Internet sharing helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('forceInternetSharingOff').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-4, AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.01.20</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002007</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95382-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;forceInternetSharingOff&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:39"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_filevault_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce FileVault</title>
          <description>FileVault _MUST_ be enforced.

The information system implements cryptographic mechanisms to protect the confidentiality and integrity of information stored on digital media during transport outside of controlled areas.

NOTE: See the FileVault supplemental to implement this rule.
            
            dontAllowDisable=$(/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('dontAllowFDEDisable').js
EOS
)
fileVault=$(/usr/bin/fdesetup status | /usr/bin/grep -c "FileVault is On.")
if [[ "$dontAllowDisable" == "true" ]] &amp;&amp; [[ "$fileVault" == 1 ]]; then
  echo "1"
else
  echo "0"
fi
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-28, SC-28(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-28, SC-28(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005020</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.6, 3.11</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95367-9</ident>
          <fixtext>NOTE: See the FileVault supplemental to implement this rule.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;dontAllowFDEDisable&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:40"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_override_disallow_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Gatekeeper to Disallow End User Override</title>
          <description>Gatekeeper _MUST_ be configured with a configuration profile to prevent normal users from overriding its settings.

If users are allowed to disable Gatekeeper or set it to a less restrictive setting, malware could be introduced into the system.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.managed')\
.objectForKey('DisableOverride').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-5, SI-7(15)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-5, SI-7(15)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.02</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95372-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempolicy.managed) payload type:

[source,xml]
----
&lt;key&gt;DisableOverride&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:41"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable SSH Server for Remote Access Sessions</title>
          <description>SSH service _MUST_ be disabled for remote access.
            
            result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.openssh.sshd" =&gt; enabled')
running=$(/bin/launchctl print system/com.openssh.sshd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95406-5</ident>
          <fixtext>[source,bash]
----
/usr/sbin/systemsetup -f -setremotelogin off &gt;/dev/null
/bin/launchctl disable system/com.openssh.sshd
----
NOTE: Systemsetup with -setremotelogin flag will fail unless you grant Full Disk Access to systemsetup or its parent process. Requires supervision.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:42"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_siri_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Siri</title>
          <description>Support for Siri is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAssistant').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06, 03.04.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002020</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95398-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowAssistant&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:43"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_content_caching_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Content Caching Service</title>
          <description>Content caching _MUST_ be disabled.

Content caching is a macOS service that helps reduce Internet data usage and speed up software installation on Mac computers. It is not recommended for devices furnished to employees to act as a caching server.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowContentCaching').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002140</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.8 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95362-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowContentCaching&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:44"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_ssh_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable SSH Server for Remote Access Sessions</title>
          <description>Remote access sessions _MUST_ use encrypted methods to protect unauthorized individuals from gaining access.
            
            /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.openssh.sshd" =&gt; enabled'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(8), AC-3, CM-7, CM-7(1), AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, CM-7, CM-7(1), IA-2(8), IA-2(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.05.04</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95407-3</ident>
          <fixtext>[source,bash]
----
/bin/launchctl enable system/com.openssh.sshd
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:45"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_gatekeeper_identified_developers_allowed_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Apply Gatekeeper Settings to Block Applications from Unidentified Developers</title>
          <description>The information system implements cryptographic mechanisms to authenticate software prior to installation.

Gatekeeper settings must be configured correctly to only allow the system to run applications downloaded from the Mac App Store or applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS to verify that the application has not been modified by a malicious third party.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('AllowIdentifiedDevelopers'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('EnableAssessment'))
  if ( pref1 == true &amp;&amp; pref2 == true ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-14, CM-5, SI-7(15), SI-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-5(3), CM-5, SI-7(15)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002060</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95371-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempolicy.control) payload type:

[source,xml]
----
&lt;key&gt;AllowIdentifiedDevelopers&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;EnableAssessment&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:46"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_screensaver_password_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Password</title>
          <description>Users _MUST_ authenticate when unlocking the screen saver.

The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPassword').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10, 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000002</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95396-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;askForPassword&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:47"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable macOS Application Firewall</title>
          <description>The macOS Application Firewall is the built-in firewall that comes with macOS, and it _MUST_ be enabled.

When the macOS Application Firewall is enabled, the flow of information within the information system and between interconnected systems will be controlled by approved authorizations.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
.objectForKey('EnableFirewall').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, SC-7(12), CM-7, CM-7(1), SC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-4, AC-6(1), AC-19, SC-7, CM-7, CM-7(1), SC-7(12)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.04.06, 03.13.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.5, 13.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95369-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.firewall) payload type:

[source,xml]
----
&lt;key&gt;EnableFirewall&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:48"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_find_my_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Find My Service</title>
          <description>The Find My service _MUST_ be disabled.

A Mobile Device Management (MDM) solution _MUST_ be used to carry out remote locking and wiping instead of Apple's Find My service.

Apple's Find My service uses a personal AppleID for authentication. Organizations should rely on MDM solutions, which have much more secure authentication requirements, to perform remote lock and remote wipe.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFindMyDevice'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFindMyFriends'))
  let pref3 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.icloud.managed')\
.objectForKey('DisableFMMiCloudSetting'))
  if ( pref1 == false &amp;&amp; pref2 == false &amp;&amp; pref3 == true ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002180</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95368-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowFindMyDevice&lt;/key&gt;
&lt;false/&gt;
&lt;key&gt;allowFindMyFriends&lt;/key&gt;
&lt;false/&gt;
----

Create a configuration profile containing the following keys in the (com.apple.icloud.managed) payload type:

[source,xml]
----
&lt;key&gt;DisableFMMiCloudSetting&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:49"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_hot_corners_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Hot Corners</title>
          <description>Hot corners _MUST_ be disabled.

The information system conceals, via the session lock, information previously visible on the display with a publicly viewable image. Although hot comers can be used to initiate a session lock or to launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '"wvous-bl-corner" = 0|"wvous-br-corner" = 0|"wvous-tl-corner" = 0|"wvous-tr-corner" = 0'
            
            
Result: {'integer': 4}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000007</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95375-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

NOTE: The following settings are in the (com.apple.ManagedClient.preferences) payload. This payload requires the additional settings to be sub-payloads within, containing their defined payload types.

Create a configuration profile containing the following keys in the (com.apple.dock) payload type:

[source,xml]
----
&lt;key&gt;wvous-bl-corner&lt;/key&gt;
&lt;integer&gt;0&lt;/integer&gt;
&lt;key&gt;wvous-br-corner&lt;/key&gt;
&lt;integer&gt;0&lt;/integer&gt;
&lt;key&gt;wvous-tr-corner&lt;/key&gt;
&lt;integer&gt;0&lt;/integer&gt;
&lt;key&gt;wvous-tl-corner&lt;/key&gt;
&lt;integer&gt;0&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:50"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_diagnostics_reports_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Sending Diagnostic and Usage Data to Apple</title>
          <description>The ability to submit diagnostic data to Apple _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of diagnostic and usage information will mitigate the risk of unwanted data being sent to Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
let pref1 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SubmitDiagInfo')\
.objectForKey('AutoSubmit').js
let pref2 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowDiagnosticSubmission').js
if ( pref1 == false &amp;&amp; pref2 == false ){
    return("true")
} else {
    return("false")
}
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-11, AC-20, SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20, SI-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002021</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.3.1 (level 1), 2.6.3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95364-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SubmitDiagInfo) payload type:

[source,xml]
----
&lt;key&gt;AutoSubmit&lt;/key&gt;
&lt;false/&gt;
----

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowDiagnosticSubmission&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:51"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_critical_update_install_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Critical Security Updates to be Installed</title>
          <description>Ensure that security updates are installed as soon as they are available from Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('CriticalUpdateInstall').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.01</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4, 7.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95363-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SoftwareUpdate) payload type:

[source,xml]
----
&lt;key&gt;CriticalUpdateInstall&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:52"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_wake_network_access_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Wake for Network Access Is Disabled</title>
          <description>Wake for network access _MUST_ be disabled.
            
            /usr/bin/pmset -g custom | /usr/bin/awk '/womp/ { sum+=$2 } END {print sum}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.10.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95417-2</ident>
          <fixtext>[source,bash]
----
/usr/bin/pmset -a womp 0
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:53"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_sharing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Bluetooth Sharing</title>
          <description>Bluetooth Sharing _MUST_ be disabled.

Bluetooth Sharing allows users to wirelessly transmit files between the macOS and Bluetooth-enabled devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files via Bluetooth Sharing. When Bluetooth Sharing is disabled, this risk is mitigated.

[NOTE]
====
The check and fix are for the last logged in user. To get the last logged in user, run the following.
[source,bash]
----
CURRENT_USER=$( /usr/bin/defaults read /Library/Preferences/com.apple.loginwindow lastUserName )
----
====
            
            /usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults -currentHost read com.apple.Bluetooth PrefKeyServicesEnabled
            
            
Result: {'boolean': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-18(4), CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, AC-18(4), CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002110</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.10 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3, 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95361-2</ident>
          <fixtext>[source,bash]
----
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults -currentHost write com.apple.Bluetooth PrefKeyServicesEnabled -bool false
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:54"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_automatic_login_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Unattended or Automatic Logon to the System</title>
          <description>Automatic logon _MUST_ be disabled.

When automatic logons are enabled, the default user account is automatically logged on at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer and find it already logged in. Disabling automatic logons mitigates this risk.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('com.apple.login.mcx.DisableAutoLoginClient').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-5(13)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-5(13)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002066</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.13.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95356-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;com.apple.login.mcx.DisableAutoLoginClient&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:55"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Login Window to Show A Custom Message</title>
          <description>The login window _MUST_ be configured to show a custom access warning message.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS
            
            
Result: {'base64': 'Center for Internet Security Test Message'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95386-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;LoginwindowText&lt;/key&gt;
&lt;string&gt;Center for Internet Security Test Message&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:56"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Login Window to Show A Custom Message</title>
          <description>The login window _MUST_ be configured to show a custom access warning message.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS
            
            
Result: {'base64': 'Center for Internet Security Test Message'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95386-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;LoginwindowText&lt;/key&gt;
&lt;string&gt;Center for Internet Security Test Message&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:57"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_loginwindow_loginwindowtext_enable_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Login Window to Show A Custom Message</title>
          <description>The login window _MUST_ be configured to show a custom access warning message.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS
            
            
Result: {'base64': 'Center for Internet Security Test Message'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.11.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95386-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;LoginwindowText&lt;/key&gt;
&lt;string&gt;Center for Internet Security Test Message&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:58"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_improve_siri_dictation_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Improve Siri and Dictation Information to Apple</title>
          <description>The ability for Apple to store and review audio of your Siri and Dictation interactions _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of Siri and Dictation information will mitigate the risk of unwanted data being sent to Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\
.objectForKey('Siri Data Sharing Opt-In Status').js
EOS
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002210</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.3.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95379-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.assistant.support) payload type:

[source,xml]
----
&lt;key&gt;Siri Data Sharing Opt-In Status&lt;/key&gt;
&lt;integer&gt;2&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:59"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_download_software_update_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Software Update Downloads Updates Automatically using DDM.</title>
          <description>Software Update _MUST_ be configured to enforce automatic downloads of updates from Apple and that the user cannot modify the setting within System Settings.
            
            /usr/bin/plutil -convert json /var/db/softwareupdate/SoftwareUpdateDDMStatePersistence.plist -o - | /usr/bin/jq --raw-output .'SUCorePersistedStatePolicyFields.SUCoreDDMDeclarationGlobalSettings.automaticallyDownload'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95403-2</ident>
          <fixtext>This is implemented by Declarative Device Management (DDM).

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:60"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_touch_id_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the Touch ID System Settings Pane</title>
          <description>The System Settings pane for Touch ID _MUST_ be disabled.

Disabling the System Settings pane prevents the users from configuring Touch ID.
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c "com.apple.Touch-ID-Settings.extension"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06, 03.04.08</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95414-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.Touch-ID-Settings.extension&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:61"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_external_intelligence_sign_in_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable External Intelligence Integration Sign In</title>
          <description>The ability to sign into an external intelligence systems _MUST_ be disabled unless approved by the organiztion. Disabling external intelligence integration will mitigate the risk of data being sent to unapproved third party.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowExternalIntelligenceIntegrationsSignIn').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95366-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowExternalIntelligenceIntegrationsSignIn&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:62"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_bluetooth_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the Bluetooth System Settings Pane</title>
          <description>The Bluetooth System Setting pane _MUST_ be disabled to prevent access to the bluetooth configuration.
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c com.apple.BluetoothSettings
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002260</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95360-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.BluetoothSettings&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:63"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_location_services_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Location Services</title>
          <description>Location Services _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.  Disabling Location Services helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.
            
            /usr/bin/sudo -u _locationd /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.locationd')\
.objectForKey('LocationServicesEnabled').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002004</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95383-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/defaults write /var/db/locationd/Library/Preferences/ByHost/com.apple.locationd LocationServicesEnabled -bool false; 
pid=$(/bin/launchctl print system | /usr/bin/awk '/\tcom.apple.locationd/ {print $1}')
kill -9 $pid
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:64"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_usb_restricted_mode_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>USB Devices Must be Authorized Before Allowing</title>
          <description>USB devices connected to a Mac _MUST_ be authorized.

[IMPORTANT]
====
This feature is removed if a smartcard is paired or smartcard attribute mapping is configured.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
  function run() {
    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowUSBRestrictedMode'))
    if ( pref1 == false ) {
      return("false")
    } else {
      return("true")
    }
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7, SC-41</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005090</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95416-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowUSBRestrictedMode&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:65"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure macOS to Use an Authorized Time Server</title>
          <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS
            
            
Result: {'string': 'time.nist.gov'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000170</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95411-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;timeServer&lt;/key&gt;
&lt;string&gt;time.nist.gov&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:66"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure macOS to Use an Authorized Time Server</title>
          <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS
            
            
Result: {'string': 'time.apple.com'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000170</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95411-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;timeServer&lt;/key&gt;
&lt;string&gt;time.apple.com&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:67"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure macOS to Use an Authorized Time Server</title>
          <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS
            
            
Result: {'string': 'time.apple.com'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000170</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95411-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;timeServer&lt;/key&gt;
&lt;string&gt;time.apple.com&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:68"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure macOS to Use an Authorized Time Server</title>
          <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS
            
            
Result: {'string': 'time.nist.gov'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000170</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95411-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;timeServer&lt;/key&gt;
&lt;string&gt;time.nist.gov&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:69"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_time_server_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce macOS Time Synchronization</title>
          <description>Time synchronization _MUST_ be enforced on all networked systems.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.timed')\
.objectForKey('TMAutomaticTimeOnlyEnabled').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000014</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95412-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

NOTE: The following settings are in the (com.apple.ManagedClient.preferences) payload. This payload requires the additional settings to be sub-payloads within, containing their defined payload types.

Create a configuration profile containing the following keys in the (com.apple.timed) payload type:

[source,xml]
----
&lt;key&gt;TMAutomaticTimeOnlyEnabled&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:70"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_siri_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the System Settings Pane for Siri</title>
          <description>The System Settings pane for Siri _MUST_ be hidden.

Hiding the System Settings pane prevents the users from configuring Siri.

NOTE: Disabling the Siri System Settings pane blocks the user from opting into Apple Intelligence.
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c com.apple.Siri-Settings.extension
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06, 03.04.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002053</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95400-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.Siri-Settings.extension&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:71"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_improve_assistive_voice_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Sending Audio Recordings and Transcripts to Apple</title>
          <description>The ability for Apple to store and review audio of your audio recordings and transcripts of your vocal shortcuts and voice control interactions _MUST_ be disabled. This will disable "Improve Assistive Voice Features" in Privacy &amp; Security within System Settings.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of this information will mitigate the risk of unwanted data being sent to Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Accessibility')\
.objectForKey('AXSAudioDonationSiriImprovementEnabled').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002023</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95377-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Accessibility) payload type:

[source,xml]
----
&lt;key&gt;AXSAudioDonationSiriImprovementEnabled&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:72"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_airplay_receiver_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Airplay Receiver</title>
          <description>Airplay Receiver allows you to send content from another Apple device to be displayed on the screen as it's being played from your other device.

Support for Airplay Receiver is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAirPlayIncomingRequests').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002080</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.1.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95354-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowAirPlayIncomingRequests&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:73"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_security_update_install_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Automatic Installs of Available Security Updates using DDM.</title>
          <description>Ensure that available security updates are installed as soon as they are available from Apple and that the user cannot modify the setting within System Settings.
            
            /usr/bin/plutil -convert json /var/db/softwareupdate/SoftwareUpdateDDMStatePersistence.plist -o - | /usr/bin/jq --raw-output .'SUCorePersistedStatePolicyFields.SUCoreDDMDeclarationGlobalSettings.automaticallyInstallSystemAndSecurityUpdates'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.01</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4, 7.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95602-9</ident>
          <fixtext>This is implemented by Declarative Device Management (DDM).

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:74"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_token_removal_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure User Session Lock When a Smart Token is Removed</title>
          <description>The screen lock _MUST_ be configured to initiate automatically when the smart token is removed from the system.

Session locks are temporary actions taken when users stop work and move away from the immediate vicinity of the information system but do not want to log out because of the temporary nature of their absences. While a session lock is not an acceptable substitute for logging out of an information system for longer periods of time, they prevent a malicious user from accessing the information system when a user has removed their smart token.

[IMPORTANT]
====
Information System Security Officers (ISSOs) may make the risk-based decision not to enforce a session lock when a smart token is removed, so as to maintain necessary workflow capabilities, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('tokenRemovalAction').js
EOS
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000005</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95413-1</ident>
          <fixtext>This is implemented by a Configuration Profile.
Create a configuration profile containing the following keys in the (com.apple.security.smartcard) payload type:

[source,xml]
----
&lt;key&gt;tokenRemovalAction&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:75"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_media_sharing_disabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Media Sharing</title>
          <description>Media sharing _MUST_ be disabled.

When Media Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Media Sharing helps prevent the unauthorized connection of devices and the unauthorized transfer of information. Disabling Media Sharing mitigates this risk.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMediaSharing'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMediaSharingModification'))
  if ( pref1 == false &amp;&amp; pref2 == false ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002100</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.9 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95388-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowMediaSharing&lt;/key&gt;
&lt;false/&gt;
&lt;key&gt;allowMediaSharingModification&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:76"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_menu_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Wifi Menu</title>
          <description>The WiFi menu _MUST_ be enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.controlcenter')\
.objectForKey('WiFi').js
EOS
            
            
Result: {'integer': 18}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8, 12.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95421-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.controlcenter) payload type:

[source,xml]
----
&lt;key&gt;WiFi&lt;/key&gt;
&lt;integer&gt;18&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:77"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_firewall_stealth_mode_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Firewall Stealth Mode</title>
          <description>Firewall Stealth Mode _MUST_ be enabled.

When stealth mode is enabled, the Mac will not respond to any probing requests, and only requests from authorized applications will still be authorized.

[IMPORTANT]
====
Enabling firewall stealth mode may prevent certain remote mechanisms used for maintenance and compliance scanning from properly functioning. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting not to enable stealth mode.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
.objectForKey('EnableStealthMode').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1), SC-7(16), SC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-7, CM-7, CM-7(1), SC-7(16)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06, 03.13.01</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.5, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95370-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.firewall) payload type:

[source,xml]
----
&lt;key&gt;EnableStealthMode&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;EnableFirewall&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:78"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_rae_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Remote Apple Events</title>
          <description>If the system does not require Remote Apple Events, support for Apple Remote Events is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Remote Apple Events helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.
            
            /bin/launchctl print-disabled system | /usr/bin/grep -c '"com.apple.AEServer" =&gt; disabled'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.3.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95392-7</ident>
          <fixtext>[source,bash]
----
/usr/sbin/systemsetup -setremoteappleevents off
/bin/launchctl disable system/com.apple.AEServer
----
NOTE: Systemsetup with -setremoteappleevents flag will fail unless you grant Full Disk Access to systemsetup or its parent process. Requires supervision.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:79"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_system_settings_wifi_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Wi-Fi Interface</title>
          <description>The macOS system must be configured with Wi-Fi support software disabled if not connected to an authorized trusted network.

Allowing devices and users to connect to or from the system without first authenticating them allows untrusted access and can lead to a compromise or attack. Since wireless communications can be intercepted it is necessary to use encryption to protect the confidentiality of information in transit. Wireless technologies include for example  microwave packet radio (UHF/VHF) 802.11x and Bluetooth. Wireless networks use authentication protocols (e.g. EAP/TLS PEAP) which provide credential protection and mutual authentication.

NOTE: If the system requires Wi-Fi to connect to an authorized network, this is not applicable.
            
            /usr/sbin/networksetup -listallnetworkservices | /usr/bin/grep -c "*Wi-Fi"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, AC-18, AC-18(1), AC-18(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-4, AC-18(1), AC-18(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.01.16</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.2, 12.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95419-8</ident>
          <fixtext>To disable Wi-Fi on a macOS system, run the following command.
[source,bash]
----
/usr/sbin/networksetup -setnetworkserviceenabled "Wi-Fi" off
----

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_pam_login_smartcard_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Multifactor Authentication for Login</title>
          <description>The system _MUST_ be configured to enforce multifactor authentication.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/login will be automatically modified to its original state following any update or major upgrade to the operating system.
            
            /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)' /etc/pam.d/login
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(3), IA-2(4), IA-5(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.03, 03.05.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003050</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95132-7</ident>
          <fixtext>[source,bash]
----
/bin/cat &gt; /etc/pam.d/login &lt;&lt; LOGIN_END
# login: auth account password session
auth        sufficient    pam_smartcard.so
auth        optional      pam_krb5.so use_kcminit
auth        optional      pam_ntlm.so try_first_pass
auth        optional      pam_mount.so try_first_pass
auth        required      pam_opendirectory.so try_first_pass
auth        required      pam_deny.so
account     required      pam_nologin.so
account     required      pam_opendirectory.so
password    required      pam_opendirectory.so
session     required      pam_launchd.so
session     required      pam_uwtmp.so
session     optional      pam_mount.so
LOGIN_END


/bin/chmod 644 /etc/pam.d/login
/usr/sbin/chown root:wheel /etc/pam.d/login
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:81"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_smartcard_allow_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Allow Smartcard Authentication</title>
          <description>Smartcard authentication _MUST_ be allowed.

The use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.

When enabled, the smartcard can be used for login, authorization, and screen saver unlocking.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('allowSmartCard').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(12)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(12), IA-5(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003030</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95135-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.smartcard) payload type:

[source,xml]
----
&lt;key&gt;allowSmartCard&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:82"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_pam_sudo_smartcard_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Multifactor Authentication for Privilege Escalation Through the sudo Command</title>
          <description>The system _MUST_ be configured to enforce multifactor authentication when the sudo command is used to elevate privilege.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/sudo will be automatically modified to its original state following any update or major upgrade to the operating system.
            
            /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)' /etc/pam.d/sudo
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(3), IA-2(4), IA-5(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.03, 03.05.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003052</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95134-3</ident>
          <fixtext>[source,bash]
----

/bin/cat &gt; /etc/pam.d/sudo &lt;&lt; SUDO_END
# sudo: auth account password session
auth        sufficient    pam_smartcard.so
auth        required      pam_opendirectory.so
auth        required      pam_deny.so
account     required      pam_permit.so
password    required      pam_deny.so
session     required      pam_permit.so
SUDO_END

/bin/chmod 444 /etc/pam.d/sudo
/usr/sbin/chown root:wheel /etc/pam.d/sudo
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:83"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_high_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Smartcard Certificate Trust to High</title>
          <description>The macOS system _MUST_ be configured to block access to users who are no longer authorized (i.e., users with revoked certificates).

To prevent the use of untrusted certificates, the certificates on a smartcard card _MUST_ meet the following criteria: its issuer has a system-trusted certificate, the certificate is not expired, its "valid-after" date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) checking.

By setting the smartcard certificate trust level to high, the system will execute a hard revocation, i.e., a network connection is required. A verified positive response from the OSCP/CRL server is required for authentication to succeed.

NOTE: Before applying this setting, please see the smartcard supplemental guidance.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('checkCertificateTrust').js
EOS
            
            
Result: {'integer': 3}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(2), SC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(12), IA-5(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95136-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.smartcard) payload type:

[source,xml]
----
&lt;key&gt;checkCertificateTrust&lt;/key&gt;
&lt;integer&gt;3&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:84"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_smartcard_certificate_trust_enforce_moderate_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Smartcard Certificate Trust to Moderate</title>
          <description>The macOS system _MUST_ be configured to block access to users who are no longer authorized (i.e., users with revoked certificates).

To prevent the use of untrusted certificates, the certificates on a smartcard card _MUST_ meet the following criteria: its issuer has a system-trusted certificate, the certificate is not expired, its "valid-after" date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) checking.

By setting the smartcard certificate trust level to moderate, the system will execute a soft revocation, i.e., if the OCSP/CRL server is unreachable, authentication will still succeed.

NOTE: Before applying this setting, please see the smartcard supplemental guidance.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('checkCertificateTrust').js
EOS
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(2), SC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(12), IA-5(2)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001060</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95137-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.smartcard) payload type:

[source,xml]
----
&lt;key&gt;checkCertificateTrust&lt;/key&gt;
&lt;integer&gt;2&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:85"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_smartcard_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Smartcard Authentication</title>
          <description>Smartcard authentication _MUST_ be enforced.

The use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.

When enforceSmartCard is set to "true", the smartcard must be used for login, authorization, and unlocking the screensaver.

CAUTION: enforceSmartCard will apply to the whole system. No users will be able to login with their password unless the profile is removed or a user is exempt from smartcard enforcement.

NOTE: enforceSmartcard requires allowSmartcard to be set to true in order to work.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('enforceSmartCard').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(6), IA-2, IA-5(2), IA-2(12), IA-2(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(1), IA-2(2), IA-2(3), IA-2(4), IA-2(6), IA-2(11), IA-5(2), IA-5(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01, 03.05.03, 03.05.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003020</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95138-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.smartcard) payload type:

[source,xml]
----
&lt;key&gt;enforceSmartCard&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;allowSmartCard&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:86"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_pam_su_smartcard_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Multifactor Authentication for the su Command</title>
          <description>The system _MUST_ be configured such that, when the su command is used, multifactor authentication is enforced.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/su will be automatically modified to its original state following any update or major upgrade to the operating system.
            
            /usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_rootok.so)' /etc/pam.d/su
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(3), IA-2(4), IA-5(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.03, 03.05.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003051</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95133-5</ident>
          <fixtext>[source,bash]
----
/bin/cat &gt; /etc/pam.d/su &lt;&lt; SU_END
# su: auth account password session
auth        sufficient    pam_smartcard.so
auth        required      pam_rootok.so
auth        required      pam_group.so no_warn group=admin,wheel ruser root_only fail_safe
account     required      pam_permit.so
account     required      pam_opendirectory.so no_check_shell
password    required      pam_opendirectory.so
session     required      pam_launchd.so
SU_END

# Fix new file ownership and permissions
/bin/chmod 644 /etc/pam.d/su
/usr/sbin/chown root:wheel /etc/pam.d/su
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:87"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_auth_ssh_password_authentication_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Password Authentication for SSH</title>
          <description>If remote login through SSH is enabled, password based authentication _MUST_ be disabled for user login.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.
            
            /usr/sbin/sshd -G | /usr/bin/grep -Ec '^(passwordauthentication\s+no|kbdinteractiveauthentication\s+no)'
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(1), IA-2(2), IA-2(6), IA-2, IA-5(2), MA-4, IA-2(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(1), IA-2(2), IA-2(3), IA-2(4), IA-2(6), IA-2(11), IA-5(2), IA-5(11), MA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01, 03.05.03, 03.05.04, 03.07.05</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001150</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.3, 6.4, 6.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95139-2</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')
if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi
echo "passwordauthentication no" &gt;&gt; "${include_dir}01-mscp-sshd.conf"
echo "kbdinteractiveauthentication no" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:88"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_fd_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Deletions of Object Attributes</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of attempts to delete file attributes (fd).

***Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to delete a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fd'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03, 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001020</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95118-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*-fd" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fd/' /etc/security/audit_control;/usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:89"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_record_reduction_report_generation_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Audit Record Reduction and Report Generation</title>
          <description>The system _IS_ configured with the ability provide and implement an audit record reduction and report generation capability.

Audit record reduction is a process that manipulates collected audit log information and organizes it into a summary format that is more meaningful to analysts. Audit record reduction and report generation capabilities do not always emanate from the same system or from the same organizational entities that conduct audit logging activities. The audit record reduction capability includes modern data mining techniques with advanced data filters to identify anomalous behavior in audit records. The report generation capability provided by the system can generate customizable reports. Time ordering of audit records can be an issue if the granularity of the timestamp in the record is insufficient.

Audit record reduction and report generation can be done with tools built into macOS such as auditreduce and praudit. These tools are protected by System Integrity Protection (SIP).
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.06</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95128-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_folder_group_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Folders Group to Wheel</title>
          <description>Audit log files _MUST_ have the group set to wheel.

The audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.
            
            /bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $4}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001015</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95124-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/chgrp wheel /var/audit
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:91"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_failure_halt_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Shut Down Upon Audit Failure</title>
          <description>The audit service _MUST_ be configured to shut down the computer if it is unable to audit system events.

Once audit failure occurs, user and system activity are no longer recorded, and malicious activity could go undetected. Audit processing failures can occur due to software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.
            
            /usr/bin/awk -F':' '/^policy/ {print $NF}' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'ahlt'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001010</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95111-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/^policy.*/policy: ahlt,argv/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:92"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_failed_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Failed Change of Object Attributes</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of failed attempts to modify file attributes (-fm).

Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to modify a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fm'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03, 03.03.08</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95120-2</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*-fm" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fm/' /etc/security/audit_control;/usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:93"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_off_load_records_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Off-Load Audit Records</title>
          <description>Audit records should be off-loaded onto a different system or media from the system being audited.

Information stored in only one location is vulnerable to accidental or incidental deletion or alteration. Off-loading is a common process in information systems with limited audit storage capacity.

To secure audit records by off-loading, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-4(1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.9</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95127-7</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_records_processing_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Audit Record Reduction and Report Generation</title>
          <description>The macOS should be configured to provide and implement the capability to process, sort, and search audit records for events of interest based on organizationally defined fields.

Events of interest can be identified by the content of audit records, including system resources involved, information objects accessed, identities of individuals, event types, event locations, event dates and times, Internet Protocol addresses involved, or event success or failure. Organizations may define event criteria to any degree of granularity required, such as locations selectable by a general networking location or by specific system component.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-7(1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95129-3</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_control_mode_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit_Control Owner to Mode 440 or Less Permissive</title>
          <description>/etc/security/audit_control _MUST_ be configured so that it is readable only by the root user and group wheel.
            
            /bin/ls -l /etc/security/audit_control | /usr/bin/awk '!/-r--[r-]-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/xargs
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001130</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95108-7</ident>
          <fixtext>[source,bash]
----
/bin/chmod 440 /etc/security/audit_control
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:96"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_acls_folders_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Folder to Not Contain Access Control Lists</title>
          <description>The audit log folder _MUST_ not contain access control lists (ACLs).

Audit logs contain sensitive data about the system and users. This rule ensures that the audit service is configured to create log folders that are readable and writable only by system administrators in order to prevent normal users from reading audit logs.
            
            /bin/ls -lde /var/audit | /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000031</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95102-0</ident>
          <fixtext>[source,bash]
----
/bin/chmod -N /var/audit
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:97"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_fm_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Changes of Object Attributes</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of attempts to modify file attributes (fm).

Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions attempts to modify a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '^fm'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03, 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001021</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95119-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*fm" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,fm/' /etc/security/audit_control;/usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:98"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_auditd_enabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Security Auditing</title>
          <description>The information system _MUST_ be configured to generate audit records.

Audit records establish what types of events have occurred, when they occurred, and which users were involved. These records aid an organization in their efforts to establish, correlate, and investigate the events leading up to an outage or attack.

The content required to be captured in an audit record varies based on the impact level of an organization's system. Content that may be necessary to satisfy this requirement includes, for example, time stamps, source addresses, destination addresses, user identifiers, event descriptions, success/fail indications, filenames involved, and access or flow control rules invoked.

The information system initiates session audits at system start-up.

NOTE: Security auditing is NOT enabled by default on macOS Tahoe.
            
            LAUNCHD_RUNNING=$(/bin/launchctl print system | /usr/bin/grep -c -E '\tcom.apple.auditd')
AUDITD_RUNNING=$(/usr/sbin/audit -c | /usr/bin/grep -c "AUC_AUDITING")
if [[ $LAUNCHD_RUNNING == 1 ]] &amp;&amp; [[ -e /etc/security/audit_control ]] &amp;&amp; [[ $AUDITD_RUNNING == 1 ]]; then
  echo "pass"
else
  echo "fail"
fi
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-3, AU-3(1), AU-8, AU-12, AU-12(1), AU-12(3), AU-14(1), MA-4(1), CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-3, AU-3(1), AU-8, AU-12, AU-12(3), AU-14(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.02, 03.03.03, 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95104-6</ident>
          <fixtext>[source,bash]
----
if [[ ! -e /etc/security/audit_control ]] &amp;&amp; [[ -e /etc/security/audit_control.example ]];then
  /bin/cp /etc/security/audit_control.example /etc/security/audit_control
fi

/bin/launchctl enable system/com.apple.auditd
/bin/launchctl bootstrap system /System/Library/LaunchDaemons/com.apple.auditd.plist
/usr/sbin/audit -i
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:99"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_ad_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Administrative Action Events</title>
          <description>The auditing system _MUST_ be configured to flag administrative action (ad) events.

Administrative action events include changes made to the system (e.g. modifying authentication policies). If audit records do not include ad events, it is difficult to identify incidents and to correlate incidents to subsequent events.

Audit records can be generated from various components within the information system (e.g., via a module or policy filter).

The information system audits the execution of privileged functions.

NOTE: We recommend changing the line "43127:AUE_MAC_SYSCALL:mac_syscall(2):ad" to "43127:AUE_MAC_SYSCALL:mac_syscall(2):zz" in the file /etc/security/audit_event. This will prevent sandbox violations from being audited by the ad flag.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'ad'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AC-6(9), AU-12, AC-2(4), AU-2, MA-4(1), CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AC-2(4), AC-6(9), AU-12, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.07, 03.03.01, 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001001</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95116-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*[^-]ad" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,ad/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:100"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_ex_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Failed Program Execution on the System</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed program execute (-ex) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using program execution restrictions (e.g., denying users access to execute certain processes).

This configuration ensures that audit lists include events in which program execution has failed.
Without auditing the enforcement of program execution, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-ex'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001024</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95117-8</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*-ex" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-ex/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:101"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_files_mode_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Files to Mode 440 or Less Permissive</title>
          <description>The audit service _MUST_ be configured to create log files that are readable only by the root user and group wheel. To achieve this, audit log files _MUST_ be configured to mode 440 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.
            
            /bin/ls -l $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '!/-r--r-----|current|total/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001016</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95113-7</ident>
          <fixtext>[source,bash]
----
/bin/chmod 440 /var/audit/*
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:102"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_aa_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Authorization and Authentication Events</title>
          <description>The auditing system _MUST_ be configured to flag authorization and authentication (aa) events.

Authentication events contain information about the identity of a user, server, or client. Authorization events contain information about permissions, rights, and rules. If audit records do not include aa events, it is difficult to identify incidents and to correlate incidents to subsequent events.

Audit records can be generated from various components within the information system (e.g., via a module or policy filter).
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'aa'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, MA-4(1), CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001044</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95115-2</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*[^-]aa" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,aa/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:103"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_control_owner_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit_Control Owner to Root</title>
          <description>/etc/security/audit_control _MUST_ have the owner set to root.
            
            /bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $3}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001120</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95109-5</ident>
          <fixtext>[source,bash]
----
/usr/sbin/chown root /etc/security/audit_control
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:104"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_files_owner_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Files to be Owned by Root</title>
          <description>Audit log files _MUST_ be owned by root.

The audit service _MUST_ be configured to create log files with the correct ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.
            
            /bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$3} END {print s}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001012</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95114-5</ident>
          <fixtext>[source,bash]
----
/usr/sbin/chown -R root /var/audit/*
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:105"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Retention to 7d</title>
          <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "7d", the audit service will not delete audit logs until the log data criteria is met.
            
            /usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control
            
            
Result: {'string': '7d'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-4, AU-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001029</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95130-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:106"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Retention to 60d OR 5G</title>
          <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "60d OR 5G", the audit service will not delete audit logs until the log data criteria is met.
            
            /usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control
            
            
Result: {'string': '60d OR 5G'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-4, AU-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001029</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95130-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:60d OR 5G/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:107"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Retention to 60d OR 5G</title>
          <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "60d OR 5G", the audit service will not delete audit logs until the log data criteria is met.
            
            /usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control
            
            
Result: {'string': '60d OR 5G'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-4, AU-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001029</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95130-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:60d OR 5G/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:108"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_retention_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Retention to 7d</title>
          <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "7d", the audit service will not delete audit logs until the log data criteria is met.
            
            /usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control
            
            
Result: {'string': '7d'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-4, AU-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001029</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95130-1</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/^expire-after.*/expire-after:7d/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:109"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_fr_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Failed Read Actions on the System</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file read (-fr) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying access to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to read a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fr'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03, 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95121-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*-fr" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fr/' /etc/security/audit_control;/usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:110"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_settings_failure_notify_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Failure Notification</title>
          <description>The audit service _MUST_ be configured to immediately print messages to the console or email administrator users when an auditing failure occurs.

It is critical for the appropriate personnel to be made aware immediately if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of a potentially harmful failure in the auditing system's capability, and system operation may be adversely affected.
            
            /usr/bin/grep -c "logger -s -p" /etc/security/audit_warn
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-5(2), AU-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-5, AU-5(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001031</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95131-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/logger -p/logger -s -p/' /etc/security/audit_warn; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:111"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_folder_owner_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Folders to be Owned by Root</title>
          <description>Audit log folders _MUST_ be owned by root.

The audit service _MUST_ be configured to create log folders with the correct ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log folders are set to only be readable and writable by system administrators, the risk is mitigated.
            
            /bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $3}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001013</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95125-1</ident>
          <fixtext>[source,bash]
----
/usr/sbin/chown root /var/audit
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:112"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_enforce_dual_auth_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Dual Authorization for Movement and Deletion of Audit Information</title>
          <description>All bulk manipulation of audit information should be authorized via automatic processes, and any manual manipulation of audit information should require dual authorization. In addition, dual authorization mechanisms should require the approval of two authorized individuals before being executed.

An authorized user may intentionally or accidentally move or delete audit records without those specific actions being authorized, which would result in the loss of information that could, in the future, be critical for forensic investigation.

To enforce dual authorization before audit information can be moved or deleted, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9(5)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95110-3</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_control_acls_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit_Control to Not Contain Access Control Lists</title>
          <description>/etc/security/audit_control _MUST_ not contain Access Control Lists (ACLs).
            
            /bin/ls -le /etc/security/audit_control | /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001140</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95106-1</ident>
          <fixtext>[source,bash]
----
/bin/chmod -N /etc/security/audit_control
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:114"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_lo_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Log In and Log Out Events</title>
          <description>The audit system _MUST_ be configured to record all attempts to log in and out of the system (lo).

Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing both successful and unsuccessful attempts to switch to another user account (by way of monitoring login and logout events) mitigates this risk.

The information system monitors login and logout events.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '^lo'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AC-17(1), AU-2, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AC-17(1), AU-12, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001002</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95123-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*[^-]lo" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,lo/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:115"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_alert_processing_fail_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Alert Audit Processing Failure</title>
          <description>It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected. Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded. This requirement applies to each audit data storage repository (i.e., distinct information system component where audit records are stored), the centralized audit storage capacity of organizations (i.e., all audit data storage repositories combined), or both.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95103-8</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_flags_fw_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Audit All Failed Write Actions on the System</title>
          <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file write (-fw) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying users access to edit a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to change a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.
            
            /usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fw'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(12), AU-12, AU-2, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-2, AU-12, AU-9, CM-5(1), MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.01, 03.03.03, 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001023</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.14, 8.2, 8.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95122-8</ident>
          <fixtext>[source,bash]
----
/usr/bin/grep -qE "^flags.*-fw" /etc/security/audit_control || /usr/bin/sed -i.bak '/^flags/ s/$/,-fw/' /etc/security/audit_control;/usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:117"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_folders_mode_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Folders to Mode 700 or Less Permissive</title>
          <description>The audit log folder _MUST_ be configured to mode 700 or less permissive so that only the root user is able to read, write, and execute changes to folders.

Because audit logs contain sensitive data about the system and users, the audit service _MUST_ be configured to mode 700 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.
            
            /usr/bin/stat -f %A $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')
            
            
Result: {'integer': 700}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001017</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95126-9</ident>
          <fixtext>[source,bash]
----
/bin/chmod 700 /var/audit
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:118"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Capacity Warning</title>
          <description>The audit service _MUST_ be configured to notify the system administrator when the amount of free disk space remaining reaches an organization defined value.

This rule ensures that the system administrator is notified in advance that action is required to free up more disk space for audit logs.
            
            /usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control
            
            
Result: {'integer': '25'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-5(1)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001030</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95105-3</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:119"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_configure_capacity_notify_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Capacity Warning</title>
          <description>The audit service _MUST_ be configured to notify the system administrator when the amount of free disk space remaining reaches an organization defined value.

This rule ensures that the system administrator is notified in advance that action is required to free up more disk space for audit logs.
            
            /usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control
            
            
Result: {'integer': '25'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-5(1)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001030</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95105-3</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i.bak 's/.*minfree.*/minfree:25/' /etc/security/audit_control; /usr/sbin/audit -s
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:120"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_files_group_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Files Group to Wheel</title>
          <description>Audit log files _MUST_ have the group set to wheel.

The audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.
            
            /bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$4} END {print s}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001014</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95112-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/chgrp -R wheel /var/audit/*
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:121"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_control_group_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit_Control Group to Wheel</title>
          <description>/etc/security/audit_control _MUST_ have the group set to wheel.
            
            /bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $4}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001110</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95107-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/chgrp wheel /etc/security/audit_control
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:122"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_audit_acls_files_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Audit Log Files to Not Contain Access Control Lists</title>
          <description>The audit log files _MUST_ not contain access control lists (ACLs).

This rule ensures that audit information and audit files are configured to be readable and writable only by system administrators, thereby preventing unauthorized access, modification, and deletion of files.
            
            /bin/ls -le $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $1}' | /usr/bin/grep -c ":"
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000030</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95101-2</ident>
          <fixtext>[source,bash]
----
/bin/chmod -RN /var/audit
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:123"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_enforce_access_restrictions_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Access Restrictions</title>
          <description>The information system _IS_ configured to enforce access restrictions and support auditing of the enforcement actions.

The inherent configuration of a macOS provides users with the ability to set their own permission settings to control who can view and alter files on the computer.

link:https://support.apple.com/guide/mac-help/change-permissions-for-files-folders-or-disks-mchlp1203/mac[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-5(1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95184-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_information_validation_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Information Input Validation</title>
          <description>Check the validity of the following information inputs: organization-defined information inputs to the systems.

Checking the valid syntax and semantics of system inputs—including character set, length, numerical range, and acceptable values—verifies that inputs match specified definitions for format and content. For example, if the organization specifies that numerical values between 1-100 are the only acceptable inputs for a field in a given application, inputs of "387," "abc," or "%K%" are invalid inputs and are not accepted as input to the system. Valid inputs are likely to vary from field to field within a software application. Applications typically follow well-defined protocols that use structured messages (i.e., commands or queries) to communicate between software modules or system components. Structured messages can contain raw or unstructured data interspersed with metadata or control information. If software applications use attacker-supplied inputs to construct structured messages without properly encoding such messages, then the attacker could insert malicious commands or special characters that can cause the data to be interpreted as control information or metadata. Consequently, the module or component that receives the corrupted output will perform the wrong operations or otherwise interpret the data incorrectly. Prescreening inputs prior to passing them to interpreters prevents the content from being unintentionally interpreted as commands. Input validation ensures accurate and correct inputs and prevents attacks such as cross-site scripting and a variety of injection attacks.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-10</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95210-1</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD Unused Connection Timeout to 900</title>
          <description>If SSHD is enabled it _MUST_ be configured with unused connection timeout set to 900.

This will set the time out when there are no open channels within an session.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectiontimeout/{print $2}'
            
            
Result: {'integer': '900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000130</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95314-1</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'unusedconnectiontimeout 900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "unusedconnectiontimeout 900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:126"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_unused_connection_timeout_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD Unused Connection Timeout to 900</title>
          <description>If SSHD is enabled it _MUST_ be configured with unused connection timeout set to 900.

This will set the time out when there are no open channels within an session.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectiontimeout/{print $2}'
            
            
Result: {'integer': '900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000130</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95314-1</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'unusedconnectiontimeout 900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "unusedconnectiontimeout 900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:127"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_privacy_principle_minimization_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Implement the Privacy Principle of Minimization</title>
          <description>Implement the privacy principle of minimization using organization-defined processes.

The principle of minimization states that organizations should only process personally identifiable information that is directly relevant and necessary to accomplish an authorized purpose and should only maintain personally identifiable information for as long as is necessary to accomplish the purpose. Organizations have processes in place, consistent with applicable laws and policies, to implement the principle of minimization.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SA-8(33)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95266-3</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Login Grace Time to 30</title>
          <description>If SSHD is enabled then it _MUST_ be configured to wait only 30 seconds before timing out logon attempts.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'
            
            
Result: {'integer': '30'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000053</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95311-7</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'logingracetime 30' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "logingracetime 30" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:129"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_login_grace_time_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Login Grace Time to 30</title>
          <description>If SSHD is enabled then it _MUST_ be configured to wait only 30 seconds before timing out logon attempts.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'
            
            
Result: {'integer': '30'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000053</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95311-7</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'logingracetime 30' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "logingracetime 30" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:130"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_limit_gui_sessions_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Concurrent GUI Sessions to 10 for all Accounts</title>
          <description>The information system _IS_ configured to limit the number of concurrent graphical user interface (GUI) sessions to a maximum of ten for all users.

Operating system management includes the ability to control the number of users and user sessions that utilize an operating system. Limiting the number of allowed users and sessions per user helps reduce the risks related to Denial-of-Service (DoS) attacks. This requirement addresses concurrent sessions for information system accounts and does not address concurrent sessions by single users via multiple system accounts. The maximum number of concurrent sessions should be defined based upon mission needs and the operational environment for each system.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-10</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95218-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_owner_group_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System Log Files Owned by Root and Group to Wheel</title>
          <description>The system log files _MUST_ be owned by root.

System logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.
            
            /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2&gt; /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004030</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95233-3</ident>
          <fixtext>[source,bash]
----
/usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2&gt; /dev/null | /usr/bin/awk -F":" '!/^root:wheel:/{print $3}')
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:132"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_firewall_default_deny_require_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Control Connections to Other Systems via a Deny-All and Allow-by-Exception Firewall Policy</title>
          <description>A deny-all and allow-by-exception firewall policy _MUST_ be employed for managing connections to other systems.

Organizations _MUST_ ensure the built-in packet filter firewall is configured correctly to employ the default deny rule.

Failure to restrict network connectivity to authorized systems permits inbound connections from malicious systems. It also permits outbound connections that may facilitate the exfiltration of data.

If you are using a third-party firewall solution, this setting does not apply.

[IMPORTANT]
====
Configuring the built-in packet filter firewall to employ the default deny rule has the potential to interfere with applications on the system in an unpredictable manner. Information System Security Officers (ISSOs) may make the risk-based decision not to configure the built-in packet filter firewall to employ the default deny rule to avoid losing functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /sbin/pfctl -a '*' -sr &amp;&gt; /dev/null | /usr/bin/grep -c "block drop in all"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, SC-7(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-7(5), AC-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.13.06</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95193-9</ident>
          <fixtext>NOTE: See the firewall supplemental which includes a script that has an example policy to implement this rule.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:133"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_access_control_mobile_devices_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Access Control for Mobile Devices</title>
          <description>A mobile device is a computing device that has a small form factor such that it can easily be carried by a single individual; is designed to operate without a physical connection; possesses local, non-removable or removable data storage; and includes a self-contained power source. Mobile device functionality may also include voice communication capabilities, on-board sensors that allow the device to capture information, and/or built-in features for synchronizing local data with remote locations. Examples include smart phones and tablets. Mobile devices are typically associated with a single individual. The processing, storage, and transmission capability of the mobile device may be comparable to or merely a subset of notebook/desktop systems, depending on the nature and intended purpose of the device. Protection and control of mobile devices is behavior or policy-based and requires users to take physical action to protect and control such devices when outside of controlled areas. Controlled areas are spaces for which organizations provide physical or procedural controls to meet the requirements established for protecting information and systems.

Due to the large variety of mobile devices with different characteristics and capabilities, organizational restrictions may vary for the different classes or types of such devices. Usage restrictions and specific implementation guidance for mobile devices include configuration management, device identification and authentication, implementation of mandatory protective software, scanning devices for malicious code, updating virus protection software, scanning for critical software updates and patches, conducting primary operating system (and possibly other resident software) integrity checks, and disabling unnecessary hardware.

Usage restrictions and authorization to connect may vary among organizational systems. For example, the organization may authorize the connection of mobile devices to its network and impose a set of usage restrictions, while a system owner may withhold authorization for mobile device connection to specific applications or impose additional usage restrictions before allowing mobile device connections to a system.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-19</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.18</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95154-1</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_functions_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Block Non-Privileged Users from Executing Privileged Functions</title>
          <description>The information system _IS_ configured to block standard users from executing privileged functions.

Privileged functions include disabling, circumventing, or altering implemented security safeguards and countermeasures.

The inherent configuration of the macOS does not allow for non-privileged users to be able to execute functions requiring privilege.

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AuthenticationAndAuthorizationGuide/Introduction/Introduction.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95264-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_dvdram_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable DVD-RAM</title>
          <description>DVD-RAM media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["dvdram"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95183-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:136"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ess_installed_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Must Use ESS</title>
          <description>The approved ESS solution _MUST_ be installed and configured to run.

The macOS system must employ automated mechanisms to determine the state of system components. The DoD requires the installation and use of an approved ESS solution to be implemented on the operating system. For additional information, reference all applicable ESS OPORDs and FRAGOs on SIPRNET.
            
            Ask the System Administrator (SA) or Information System Security Officer (ISSO) if the approved ESS solution is loaded on the system.
If the installed components of the ESS solution are not at the DoD approved minimal versions, this is a finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-2(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95187-1</ident>
          <fixtext>Install the approved ESS solution onto the system.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_fips_compliant_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit SSHD to FIPS Compliant Connections</title>
          <description>If SSHD is enabled then it _MUST_ be configured to limit the Ciphers, HostbasedAcceptedAlgorithms, HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms, CASignatureAlgorithms to algorithms that are FIPS 140 validated.

FIPS 140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meet federal requirements.

Operating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.

NOTE: For more information on FIPS compliance with the version of SSHD included in the macOS, the manual page apple_ssh_and_fips has additional information.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            fips_sshd_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
total=0
for config in $fips_sshd_config; do
  total=$(expr $(/usr/sbin/sshd -G | /usr/bin/grep -i -c "$config") + $total)
done

echo $total
            
            
Result: {'integer': 7}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-17(2), IA-7, SC-13, SC-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-17(2), IA-7, SC-8(1), SC-13, MA-4(6)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.08, 03.13.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000054</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95310-9</ident>
          <fixtext>[source,bash]
----
if [ -f /etc/ssh/crypto.conf ] &amp;&amp; /usr/bin/grep -q "Include /etc/ssh/crypto.conf" /etc/ssh/sshd_config.d/100-macos.conf 2&gt;/bin/null; then
  /bin/ln -fs /etc/ssh/crypto/fips.conf /etc/ssh/crypto.conf
fi

include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

fips_sshd_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
sshd_config=$(/usr/sbin/sshd -G)
for config in $fips_sshd_config; do
  if ! echo $sshd_config | /usr/bin/grep -q -i "$config" 2&gt;/dev/null; then
    /usr/bin/grep -qxF "$config" "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "$config" &gt;&gt; "${include_dir}01-mscp-sshd.conf"
  fi
done

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:138"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_firmware_password_require_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Firmware Password</title>
          <description>A firmware password _MUST_ be enabled and set.

Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding the "Option" key down during startup. Setting a firmware password restricts access to these tools.

To set a firmware passcode use the following command:

[source,bash]
----
/usr/sbin/firmwarepasswd -setpasswd
----

NOTE: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through the use of a machine specific binary generated and provided by Apple. Schedule a support call, and provide proof of purchase before the firmware binary will be generated.

NOTE: Firmware passwords are not supported on Apple Silicon devices. This rule is only applicable to Intel devices.
            
            /usr/sbin/firmwarepasswd -check | /usr/bin/grep -c "Password Enabled: Yes"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.05</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003013</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95194-7</ident>
          <fixtext>NOTE: See discussion on remediation and how to enable firmware password.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:139"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_photos_enhanced_search_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Photos Enhanced Visual Search</title>
          <description>Enhanced Visualed Search _MUST_ be disabled in the Photos app.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Enhanced Visual Search will mitigate the risk of unwanted data being sent to Apple.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.photos.shareddefaults')\
.objectForKey('IPXDefaultEnhancedVisualSearchEnabled').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95254-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.photos.shareddefaults) payload type:

[source,xml]
----
&lt;key&gt;IPXDefaultEnhancedVisualSearchEnabled&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:140"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_power_nap_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Power Nap</title>
          <description>Power Nap _MUST_ be disabled.

NOTE: Power Nap allows your Mac to perform actions while a Mac is asleep. This can interfere with USB power and may cause devices such as smartcards to stop functioning until a reboot and must therefore be disabled on all applicable systems.

The following Macs support Power Nap:

* MacBook (Early 2015 and later)
* MacBook Air (Late 2010 and later)
* MacBook Pro (all models with Retina display)
* Mac mini (Late 2012 and later)
* iMac (Late 2012 and later)
* Mac Pro (Late 2013 and later)
            
            /usr/bin/pmset -g custom | /usr/bin/awk '/powernap/ { sum+=$2 } END {print sum}'
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.10.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95260-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/pmset -a powernap 0
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:141"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_warn_fraudulent_website_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Warn When Visiting A Fraudulent Website in Safari Is Enabled</title>
          <description>Warn when visiting a fraudulent website _MUST_ be enabled in Safari.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'WarnAboutFraudulentWebsites = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1, 9.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95289-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;WarnAboutFraudulentWebsites&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:142"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_power_nap_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Power Nap</title>
          <description>Power Nap _MUST_ be enabled.

NOTE: Power nap can interfere with USB power and may cause devices such as smartcards to stop functioning until a reboot.

The following Macs support Power Nap:

* MacBook (Early 2015 and later)
* MacBook Air (Late 2010 and later)
* MacBook Pro (all models with Retina display)
* Mac mini (Late 2012 and later)
* iMac (Late 2012 and later)
* Mac Pro (Late 2013 and later)
            
            /usr/bin/pmset -g custom | /usr/bin/awk '/powernap/ { sum+=$2 } END {print sum}'
            
            
Result: {'integer': 1}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95261-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/pmset -a powernap 1
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:143"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_root_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Root Login</title>
          <description>To assure individual accountability and prevent unauthorized access, logging in as root at the login window _MUST_ be disabled.

The macOS system _MUST_ require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users _MUST_ never log in directly as root.
            
            /usr/bin/dscl . -read /Users/root UserShell 2&gt;&amp;1 | /usr/bin/grep -c "/usr/bin/false"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000100</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95282-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/dscl . -create /Users/root UserShell /usr/bin/false
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:144"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_reauth_devices_change_authenticators_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Devices to Reauthenticate when Changing Authenticators</title>
          <description>The macOS should be configured to require users to reauthenticate when the device authenticator is changed.

Without reauthentication, users may access resources or perform tasks for which they are not authorization. When operating systems provide the capability to change device authenticators, it is critical the device reauthenticate.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95274-7</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce SSH to Display Policy Banner</title>
          <description>SSH _MUST_ be configured to display a policy banner.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.
            
            /usr/sbin/sshd -G | /usr/bin/grep -c "^banner /etc/banner"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000024</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95259-8</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'banner /etc/banner' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "banner /etc/banner" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:146"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_account_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Account Enabled Actions </title>
          <description>The macOS should be configured to automatically notify system administrators and Information System Security Officers (ISSOs) when accounts are enabled.

Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing and maintaining access by enabling a new or previously disabled account.  Configuring the information system to send a notification when  a new or disabled account is enabled is one method for mitigating this risk. A comprehensive account management process should not only notify when accounts are enabled, but also maintain an audit record of these actions.  Such a process greatly reduces the risk that accounts will be surreptitiously enabled and provides logging that can be used for forensic purposes.

To enable notifications and audit logging of enabled accounts, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95242-4</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_clear_history_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Clearning of Browsing History in Safari Is Disabled</title>
          <description>Clearing of browser history _MUST_ be disabled in Safari.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariHistoryClearing').js
EOS
            
            
Result: {'string': 'false'}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95601-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowSafariHistoryClearing&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:148"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_logical_access_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Approved Authorization for Logical Access</title>
          <description>The information system _IS_ configured to enforce an approved authorization process before granting users logical access.

The inherent configuration of the macOS does not grant users logical access without authorization. Authorization is achieved on the macOS through permissions, which are controlled at many levels, from the Mach and BSD components of the kernel, through higher levels of the operating system and, for networked applications, through the networking protocols. Permissions can be granted at the level of directories, subdirectories, files or applications, or specific data within files or functions within applications.

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AuthenticationAndAuthorizationGuide/Permissions/Permissions.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3, 6.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95219-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_password_proximity_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Proximity Based Password Sharing Requests</title>
          <description>Proximity based password sharing requests _MUST_ be disabled.

The default behavior of macOS is to allow users to request passwords from other known devices (macOS and iOS). This feature _MUST_ be disabled to prevent passwords from being shared.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordProximityRequests').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005060</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95251-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowPasswordProximityRequests&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:150"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_library_validation_enabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Library Validation</title>
          <description>Library validation  _MUST_ be enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.libraryvalidation')\
.objectForKey('DisableLibraryValidation').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 2.3, 2.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95215-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.security.libraryvalidation) payload type:

[source,xml]
----
&lt;key&gt;DisableLibraryValidation&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:151"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Notes Transcription</title>
          <description>Apple Intelligence features such as Notes Transcription that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowNotesTranscription').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.4 (level 1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95238-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowNotesTranscription&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:152"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mdm_require_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Enrollment in Mobile Device Management</title>
          <description>You _MUST_ enroll your Mac in a Mobile Device Management (MDM) software.

User Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager (ASM) is required to manage certain security settings. Currently these include:

* Allowed Kernel Extensions
* Allowed Approved System Extensions
* Privacy Preferences Policy Control Payload
* ExtensibleSingleSignOn
* FDEFileVault

In macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were previously locked behind ABM:

* Activation Lock Bypass
* Access to Bootstrap Tokens
* Scheduling Software Updates
* Query list and delete local users
            
            /usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep -c "Yes (User Approved)"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-2, CM-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-2, CM-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.01, 03.04.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005110</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 5.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95227-5</ident>
          <fixtext>Ensure that system is enrolled via UAMDM.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:153"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_skip_apple_intelligence_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence During Setup Assistant</title>
          <description>The prompt for setting up Apple Intelligence during Setup Assistant _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Intelligence")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-4, AC-20, CM-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95603-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;Intelligence&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:154"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_provide_automated_account_management_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Employ Automated Mechanisms for Account Management Functions</title>
          <description>The organization should employ automated mechanisms to support the management of information system accounts.

The use of automated mechanisms prevents against human error and provide a faster and more efficient means of relaying time-sensitive information and account management.

To employ automated mechanisms for account management functions, many operating systems can be integrated with an enterprise-level directory service that meets or exceeds this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95270-5</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_verify_remote_disconnection_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Verify remote disconnection of sessions</title>
          <description>The information system implements remote disconnect verification at the termination of non-local maintenance and diagnostic sessions.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MA-4(7)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MA-4(7)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95331-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_secure_name_resolution_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Secure Name Address Resolution Service</title>
          <description>The information system requests and performs data origin authentication and data integrity verification on the name/address resolution responses the system receives from authoritative sources.

NOTE: macOS supports encrypted DNS settings with the com.apple.dnsSettings.managed payload, however, the system must be integrated with a DNS server that supports encrypted DNS. link:https://developer.apple.com/documentation/devicemanagement/dnssettings[]
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-21</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-21</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.9</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95294-5</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_logoff_capability_and_message_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display logoff capability and message to prevent exploitation</title>
          <description>Provides a logout capability for user-initiated communications sessions whenever authentication is used to gain access to the system.

Displays an explicit logout message to users indicating the reliable termination of authenticated communications sessions.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-12(1), AC-12(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-12(1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95220-0</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_anti_virus_installed_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Must Use an Approved Antivirus Program</title>
          <description>An approved antivirus product _MUST_ be installed and configured to run.

Malicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.'
            
            /usr/bin/xprotect status | /usr/bin/grep -cE "(launch scans: enabled|background scans: enabled)"
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-2</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.10 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 10.5, 10.1, 10.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95158-2</ident>
          <fixtext>[source,bash]
----
/bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XProtect.daemon.scan.plist
/bin/launchctl load -w /Library/Apple/System/Library/LaunchDaemons/com.apple.XprotectFramework.PluginService.plist
----

NOTE: These services cannot be unloaded or loaded while System Integrity Protection (SIP) is enabled.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:159"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_fail_secure_state_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System to Fail to a Known Safe State if System Initialization, Shutdown, or Abort Fails</title>
          <description>The information system _IS_ configured to fail to a known safe state in the event of a failed system initialization, shutdown, or abort.

Failure to a known safe state helps prevent systems from failing to a state that may cause loss of data or unauthorized access to system resources.

Apple File System (APFS) is the default file system for Mac computers using macOS 10.13 and all later versions. APFS includes native encryption, safe document saves, stable snapshots, and crash protection; these features ensure that the macOS fails to safe state.

link:https://developer.apple.com/videos/play/wwdc2017/715/[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-24</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-24</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95190-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_screensaver_loginwindow_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver at Login Window</title>
          <description>A default screen saver _MUST_ be configured to display at the login window and _MUST_ not display any sensitive information.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('moduleName').js
EOS
            
            
Result: {'string': 'Tahoe'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95290-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;moduleName&lt;/key&gt;
&lt;string&gt;Tahoe&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:161"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mail_smart_reply_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Mail Smart Replies</title>
          <description>Apple Intelligence features such as Mail Smart Replies that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMailSmartReplies').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95222-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowMailSmartReplies&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:162"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_world_writable_system_folder_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure No World Writable Files Exist in the System Folder</title>
          <description>Folders in /System/Volumes/Data/System _MUST_ not be world-writable.
            
            /usr/bin/find /System/Volumes/Data/System -type d -perm -2 -ls | /usr/bin/grep -vE "downloadDir|locks" | /usr/bin/wc -l | /usr/bin/xargs
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95333-1</ident>
          <fixtext>[source,bash]
----
IFS=$'\n'
for sysPermissions in $( /usr/bin/find /System/Volumes/Data/System -type d -perm -2 | /usr/bin/grep -vE "downloadDir|locks" ); do
  /bin/chmod -R o-w "$sysPermissions"
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:163"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_handoff_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Handoff</title>
          <description>Handoff _MUST_ be disabled.

Handoff allows you to continue working on a document or project when the user switches from one Apple device to another. Disabling Handoff prevents data transfers to unauthorized devices.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowActivityContinuation').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005058</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95199-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowActivityContinuation&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:164"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_account_created_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Account Created Actions</title>
          <description>The macOS should be configured to automatically notify system administrators and Information System Security Officers (ISSOs) when new accounts are created.

Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing and maintaining access by creating a new account. Configuring the information system to send a notification when new accounts are created is one method for mitigating this risk. A comprehensive account management process should not only notify when new accounts are created, but also maintain an audit record of accounts made. Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.

To enable notifications and audit logging of accounts created, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95240-8</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_iphone_mirroring_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iPhone Mirroring</title>
          <description>iPhone Mirroing _MUST_ be disabled to prevent file transfers to or from unauthorized devices. Disabling iPhone Mirroring also prevents potentially unauthorized applications from appearing as if they are installed on the Mac.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowiPhoneMirroring').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-3, AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002271</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 6.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95212-7</ident>
          <fixtext>This is implemented by a Configuration Profile

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowiPhoneMirroring&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:166"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_application_sandboxing_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Separate Execution Domain for Processes</title>
          <description>The inherent configuration of the macOS _IS_ in compliance as Apple has implemented multiple features Mandatory access controls (MAC), System Integrity Protection (SIP), and application sandboxing.

link:https://support.apple.com/guide/security/system-integrity-protection-secb7ea06b49/web[]

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AppSandboxDesignGuide/AboutAppSandbox/AboutAppSandbox.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-39</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95160-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_limit_auditable_events_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Only allow authorized users to select auditable events</title>
          <description>Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent the auditing of critical events. Misconfigured audits may degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95216-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_prevent_priv_execution_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prevent Software From Executing at Higher Privilege Levels than Users Executing The Software</title>
          <description>In certain situations, software applications/programs need to execute with elevated privileges to perform required functions. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking such applications/programs, those users are indirectly provided with greater privileges than assigned by the organizations.Some programs and processes are required to operate at a higher privilege level and therefore should be excluded from the organization-defined software list after review.

The inherent configuration of the macOS does not allow for non-privileged users to be able to execute functions requiring privilege.

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AuthenticationAndAuthorizationGuide/Permissions/Permissions.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6(8)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95263-0</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_open_safe_downloads_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Automatic Opening of Safe Files in Safari</title>
          <description>Open "safe" files after downloading _MUST_ be disabled in Safari.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'AutoOpenSafeDownloads = 0' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1, 9.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95284-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;AutoOpenSafeDownloads&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:170"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSH ServerAliveInterval option set to 900</title>
          <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 900.

Setting the Active Server Alive Maximum Count to 900 will log users out after a 900 seconds interval of inactivity.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveraliveinterval 900")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000110</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95306-7</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/ssh_config | /usr/bin/tr -d '*')

ssh_config_string=("ServerAliveInterval 900")
for ssh_config in $ssh_config_string; do
  ssh_setting=$(echo $ssh_config | /usr/bin/cut -d " " -f1)
  /usr/bin/grep -qEi "^$ssh_setting" "${include_dir}01-mscp-ssh.conf" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/" "${include_dir}01-mscp-ssh.conf" || echo "$ssh_config" &gt;&gt; "${include_dir}01-mscp-ssh.conf"
  for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
    config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2&gt;&amp;1)
    configfiles=$(echo "$config" | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\r')
    configarray=( ${(f)configfiles} )
    if ! echo $config | /usr/bin/grep -q -i "$ssh_config" ; then
      for c in $configarray; do
        if [[ "$c" == "/etc/ssh/crypto.conf" ]]; then
          continue
        fi
        
        /usr/bin/sudo -u $u /usr/bin/grep -qEi "^$ssh_setting" "$c" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/I" "$c"
        if [[ "$c" =~ ".ssh/config" ]]; then
          if /usr/bin/grep -qEi "$ssh_setting" "$c" 2&gt; /dev/null; then
            old_file=$(cat ~$u/.ssh/config)
            echo "$ssh_config" &gt; ~$u/.ssh/config
            echo "$old_file" &gt;&gt; ~$u/.ssh/config
          fi
        fi
      done
    fi
  done
done
---- 

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:171"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_interval_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSH ServerAliveInterval option set to 900</title>
          <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 900.

Setting the Active Server Alive Maximum Count to 900 will log users out after a 900 seconds interval of inactivity.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveraliveinterval 900")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000110</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95306-7</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/ssh_config | /usr/bin/tr -d '*')

ssh_config_string=("ServerAliveInterval 900")
for ssh_config in $ssh_config_string; do
  ssh_setting=$(echo $ssh_config | /usr/bin/cut -d " " -f1)
  /usr/bin/grep -qEi "^$ssh_setting" "${include_dir}01-mscp-ssh.conf" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/" "${include_dir}01-mscp-ssh.conf" || echo "$ssh_config" &gt;&gt; "${include_dir}01-mscp-ssh.conf"
  for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
    config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2&gt;&amp;1)
    configfiles=$(echo "$config" | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\r')
    configarray=( ${(f)configfiles} )
    if ! echo $config | /usr/bin/grep -q -i "$ssh_config" ; then
      for c in $configarray; do
        if [[ "$c" == "/etc/ssh/crypto.conf" ]]; then
          continue
        fi
        
        /usr/bin/sudo -u $u /usr/bin/grep -qEi "^$ssh_setting" "$c" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/I" "$c"
        if [[ "$c" =~ ".ssh/config" ]]; then
          if /usr/bin/grep -qEi "$ssh_setting" "$c" 2&gt; /dev/null; then
            old_file=$(cat ~$u/.ssh/config)
            echo "$ssh_config" &gt; ~$u/.ssh/config
            echo "$old_file" &gt;&gt; ~$u/.ssh/config
          fi
        fi
      done
    fi
  done
done
---- 

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:172"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mail_summary_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Mail Summary</title>
          <description>Apple Intelligence features such as Apple Mail Summary that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMailSummary').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.3 (level 1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95223-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowMailSummary&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:173"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ssh_fips_compliant_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit SSH to FIPS Compliant Connections</title>
          <description>SSH _MUST_ be configured to limit the Ciphers, HostbasedAcceptedAlgorithms, HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms, CASignatureAlgorithms to algorithms that are FIPS 140 validated.

FIPS 140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meet federal requirements.

Operating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.

NOTE: For more information on FIPS compliance with the version of SSH included in the macOS, the manual page apple_ssh_and_fips has additional information.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            fips_ssh_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
total=0
ret="pass"
for config in $fips_ssh_config; do
  if [[ "$ret" == "fail" ]]; then
    break
  fi
  for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
    sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -ci "$config")
    if [[ "$sshCheck" == "0" ]]; then
      ret="fail"
      break
    fi
  done
done
echo $ret
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-17(2), IA-7, SC-13, SC-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-17(2), IA-7, SC-8(1), SC-13</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.08, 03.13.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000057</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95304-2</ident>
          <fixtext>[source,bash]
----
if [ -f /etc/ssh/crypto.conf ] &amp;&amp; /usr/bin/grep -q "Include /etc/ssh/crypto.conf" /etc/ssh/ssh_config.d/100-macos.conf 2&gt;/dev/null; then
  /bin/ln -fs /etc/ssh/crypto/fips.conf /etc/ssh/crypto.conf
fi
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/ssh_config | /usr/bin/tr -d '*')

fips_ssh_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
for ssh_config in $fips_ssh_config; do
  ssh_setting=$(echo $ssh_config | /usr/bin/cut -d " " -f1)
  /usr/bin/grep -qEi "^$ssh_setting" "${include_dir}01-mscp-ssh.conf" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/" "${include_dir}01-mscp-ssh.conf" || echo "$ssh_config" &gt;&gt; "${include_dir}01-mscp-ssh.conf"
  for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
    config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2&gt;&amp;1)
    configfiles=$(echo "$config" | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\r')
    configarray=( ${(f)configfiles} )
    if ! echo $config | /usr/bin/grep -q -i "$ssh_config" ; then
      for c in $configarray; do
        if [[ "$c" == "/etc/ssh/crypto.conf" ]]; then
          continue
        fi
        
        /usr/bin/sudo -u $u /usr/bin/grep -qEi "^$ssh_setting" "$c" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/I" "$c"
        if [[ "$c" =~ ".ssh/config" ]]; then
          if /usr/bin/grep -qEi "$ssh_setting" "$c" 2&gt; /dev/null; then
            old_file=$(cat ~$u/.ssh/config)
            echo "$ssh_config" &gt; ~$u/.ssh/config
            echo "$old_file" &gt;&gt; ~$u/.ssh/config
          fi
        fi
      done
    fi
  done
done
----   

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:174"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_account_modified_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Account Modified Actions</title>
          <description>The macOS should be configured to automatically notify system administrators and Information System Security Officers (ISSOs) when accounts are modified.

Once an attacker establishes initial access to a system, the attacker often attempts to create a persistent method of reestablishing and maintaining access by modifying an existing account. Configuring the information system to send a notification when accounts are modified is one method for mitigating this risk. A comprehensive account management process should not only notify when new accounts are modified, but also maintain an audit record of these actions. Such a process greatly reduces the risk that accounts will be surreptitiously created and provides logging that can be used for forensic purposes.

To enable notifications and audit logging of modified account, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95243-2</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_account_removal_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Account Removed Actions</title>
          <description>The macOS should be configured to automatically notify system administrators and Information System Security Officers (ISSOs) when accounts are removed.

When operating system accounts are disabled, user accessibility is affected. Accounts are utilized for identifying individual operating system users or for identifying the operating system processes themselves. To detect and respond to events that affect user accessibility and system processing, operating systems should audit account removal actions and, as required, notify system administrators and ISSOs so they can investigate the event. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and also provides logging that can be used for forensic purposes.

To enable notifications and audit logging of removed accounts, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95244-0</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_allow_info_passed_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Allow Information Transfer with Other Operating Systems</title>
          <description>The information system _IS_ configured to allow the transfer of information to and from other operating systems and users.

The macOS is a UNIX 03-compliant operating system, which allows owners of object to have discretion over who should be authorized to access information.

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AuthenticationAndAuthorizationGuide/Permissions/Permissions.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3(4)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95157-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_allow_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Rapid Security Response Mechanism</title>
          <description>Rapid security response mechanism _MUST_ be enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowRapidSecurityResponseInstallation').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2, SI-2(5), SI-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.01, 03.14.02</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95272-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowRapidSecurityResponseInstallation&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:178"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mfa_network_non-priv_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce multifactor authentication for network access to non-privileged accounts</title>
          <description>The information system implements multifactor authentication for network access to non-privileged accounts.
            
            For directory bound systems:
The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95230-9</ident>
          <fixtext>For directory bound systems, the technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_remove_software_components_after_updates_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Must remove all software components after updated versions installed</title>
          <description>Previous versions of software components that are not removed from the information system after updates have been installed may be exploited by adversaries. Some information technology products may remove older versions of software automatically from the information system.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2(6)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-2(6)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95280-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_network_storage_restriction_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Network Storage Must Be Restricted</title>
          <description>Network Storage _MUST_ be restricted. 

NOTE: Apple's built in method using declative device management method only allows you to set network storage manament to Allowed, ReadOnly, and Disallowed.
            
            /usr/bin/plutil -convert json /var/db/ManagedConfigurationFiles/DiskManagement/DiskManagement_Settings.plist -o - | /usr/bin/jq --raw-output '.Restrictions.NetworkStorage'
            
            
Result: {'string': 'Allowed'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95232-5</ident>
          <fixtext>This is implemented by Declarative Device Management (DDM).

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:181"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_time_offset_limit_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Time Offset Within Limits</title>
          <description>The macOS system time  _MUST_ be monitored to not drift more than four minutes and thirty seconds.
            
            /usr/bin/sntp $(/usr/sbin/systemsetup -getnetworktimeserver | /usr/bin/awk '{print $4}') | /usr/bin/awk -F'.' '/\+\/\-/{if (substr($1,2) &gt;= 270) {print "No"} else {print "Yes"}}'
            
            
Result: {'string': 'Yes'}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95324-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/sntp -Ss $(/usr/sbin/systemsetup -getnetworktimeserver | /usr/bin/awk '{print $4}')
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:182"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_tftpd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Trivial File Transfer Protocol Service</title>
          <description>If the system does not require Trivial File Transfer Protocol (TFTP), support it is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling TFTP helps prevent the unauthorized connection of devices and the unauthorized transfer of information.

NOTE: TFTP service is disabled at startup by default macOS.
            
            result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.tftpd" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.tftpd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, IA-5(1), AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06, 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002038</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3, 3.1, 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95323-2</ident>
          <fixtext>[source,bash]
----
/bin/launchctl bootout system/com.apple.tftpd 
/bin/launchctl disable system/com.apple.tftpd
----
The system may need to be restarted for the update to take effect.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:183"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_password_autofill_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Password Autofill</title>
          <description>Password Autofill _MUST_ be disabled.

macOS allows users to save passwords and use the Password Autofill feature in Safari and compatible apps. To protect against malicious users gaining access to the system, this feature _MUST_ be disabled to prevent users from being prompted to save passwords in applications.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordAutoFill').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95249-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowPasswordAutoFill&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:184"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD ClientAliveInterval to 900</title>
          <description>If SSHD is enabled then it _MUST_ be configured with the Client Alive Interval set to 900.

Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client.

This setting works in conjunction with ClientAliveCountMax to determine the termination of the connection after the threshold has been reached.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'
            
            
Result: {'integer': '900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000051</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95309-1</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'clientaliveinterval 900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "clientaliveinterval 900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:185"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_interval_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD ClientAliveInterval to 900</title>
          <description>If SSHD is enabled then it _MUST_ be configured with the Client Alive Interval set to 900.

Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client.

This setting works in conjunction with ClientAliveCountMax to determine the termination of the connection after the threshold has been reached.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'
            
            
Result: {'integer': '900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000051</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95309-1</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'clientaliveinterval 900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "clientaliveinterval 900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:186"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_implement_memory_protection_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Protect Memory from Unauthorized Code Execution</title>
          <description>The information system _IS_ configured to implement non-executable data to protect memory from code execution.

Some adversaries launch attacks with the intent of executing code in non-executable regions of memory or in memory locations that are prohibited (e.g., buffer overflow attacks). Security safeguards (e.g., data execution prevention and address space layout randomization) can be employed to protect non-executable regions of memory. Data execution prevention safeguards can either be hardware-enforced or software-enforced; hardware-enforced methods provide the greater strength of mechanism.

macOS supports address space layout randomization (ASLR), position-independent executable (PIE), Stack Canaries, and NX stack and heap protection.

link:https://developer.apple.com/library/archive/documentation/Darwin/Conceptual/64bitPorting/transition/transition.html[]

link:https://developer.apple.com/library/archive/qa/qa1788/_index.html[]

link:https://www.apple.com/macos/security/[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-16</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-16</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95209-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_permissions_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Apple System Log Files To Mode 640 or Less Permissive</title>
          <description>The Apple System Logs (ASL) _MUST_ be configured to be writable by root and readable only by the root user and group wheel. To achieve this, ASL log files _MUST_ be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.
            
            /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2&gt; /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004002</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95162-4</ident>
          <fixtext>[source,bash]
----
/bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2&gt; /dev/null | /usr/bin/awk -F":" '!/640/{print $2}')
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:188"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_implement_cryptography_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Implement Approved Cryptography to Protect Information</title>
          <description>The information system _IS_ configured to implement approved cryptography to protect information.

Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The operating system must implement cryptographic modules that adhere to the higher standards that have been tested, validated, and approved by the federal government.

Apple is committed to the FIPS validation process and historically has always submitted and validated the cryptographic modules in macOS. macOS Tahoe for Apple Silicion will be submitted for FIPS validation. macOS Tahoe for Intel based processors will _NOT_ be submitted for FIPS validation.

link:https://csrc.nist.gov/Projects/cryptographic-module-validation-program/validated-modules[]

link:https://support.apple.com/guide/sccc/welcome/web[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement using FIPS Validated Cryptographic Modules.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-13</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-13</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.11</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95208-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_remote_access_methods_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Control remote access methods</title>
          <description>The information system monitors and controls remote access methods.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95278-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_private_browsing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Private Browsing in Safari Is Disabled</title>
          <description>Private browsing _MUST_ be disabled in Safari.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariPrivateBrowsing').js
EOS
            
            
Result: {'string': 'false'}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95599-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowSafariPrivateBrowsing&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:191"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_password_sharing_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Password Sharing</title>
          <description>Password Sharing _MUST_ be disabled.

The default behavior of macOS is to allow users to share a password over Airdrop between other macOS and iOS devices. This feature _MUST_ be disabled to prevent passwords from being shared.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordSharing').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95252-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowPasswordSharing&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:192"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_blank_bluray_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Blank Blu Ray</title>
          <description>Blank Blu Ray media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankbd"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95165-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:193"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_separate_functionality_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Separate User and System Functionality</title>
          <description>The information system _IS_ configured to separate user and system functionality.

Operating system management functionality includes functions necessary for administration and requires privileged user access. Allowing non-privileged users to access operating system management functionality capabilities increases the risk that non-privileged users may obtain elevated privileges. Operating system management functionality includes functions necessary to administer console, network components, workstations, or servers and typically requires privileged user access.

The inherent configuration of the macOS allows only privileged users to access operating system management functionalities.

link:https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/DesigningDaemons.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-2, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-2</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.03, 03.01.05, 03.01.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95295-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notes_transcription_summary_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Notes Transcription Summary</title>
          <description>Apple Intelligence features such as Notes Transcription Summary that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowNotesTranscriptionSummary').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.4 (level 1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95239-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowNotesTranscriptionSummary&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:195"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_obscure_password_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Obscure Passwords</title>
          <description>The information system _IS_ configured to obscure feedback of authentication information during the authentication process to protect the information from possible exploitation by unauthorized individuals.

The inherent configuration of a macOS uses NSSecureTextField for any text field that receives a password, which automatically obscures text which is entered.

link:https://developer.apple.com/documentation/appkit/nssecuretextfield[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-6, IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.11</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95246-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_authenticated_root_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Authenticated Root</title>
          <description>Authenticated Root _MUST_ be enabled.

When Authenticated Root is enabled the macOS is booted from a signed volume that is cryptographically protected to prevent tampering with the system volume.

NOTE: Authenticated Root is enabled by default on macOS systems.

WARNING: If more than one partition with macOS is detected, the csrutil command will hang awaiting input.
            
            /usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep -c "AuthenticatedRootVolumeEnabled = 1;"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, CM-5, SC-34, SI-7(6), SI-7, MA-4(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, CM-5, SC-34, SI-7, SI-7(6)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.05</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005070</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.6, 3.11</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95164-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/csrutil authenticated-root enable
----
NOTE: To re-enable "Authenticated Root", boot the affected system into "Recovery" mode, launch "Terminal" from the "Utilities" menu, and run the command.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:197"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_screensaver_timeout_loginwindow_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Screen Saver Timeout at LoginWindow</title>
          <description>The screen saver timeout at LoginWindow _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('loginWindowIdleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95291-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.screensaver) payload type:

[source,xml]
----
&lt;key&gt;loginWindowIdleTime&lt;/key&gt;
&lt;string&gt;1200&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:198"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_prohibit_remote_activation_collab_devices_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Remote Activation of Collaborative Computing Devices</title>
          <description>The inherent configuration of the macOS _IS_ in compliance.

Apple has implemented a green light physically next to your camera that will glow when the camera is activated. There is an orange dot indicator by the Control Center pull down menu item to indicate when the system's microphone is listening or activated.

The macOS has built into the system, the ability to grant or deny access to the camera and microphone which requires the application to have an entitlement to use the device.

link:https://support.apple.com/guide/mac-help/use-the-built-in-camera-mchlp2980/mac[]

link:https://support.apple.com/guide/mac-help/control-access-to-your-camera-mchlf6d108da/mac[]

link:https://support.apple.com/guide/mac-help/control-access-to-your-microphone-on-mac-mchla1b1e1fe/12.0/mac/12.0[]
            
            The technology partially supports this requirement and cannot be configured to be in full compliance.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-15</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.12</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95268-9</ident>
          <fixtext>The technology partially meets this requirement. An appropriate mitigation for the system must be implemented for full compliance.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_advertising_privacy_protection_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Advertising Privacy Protection in Safari Is Enabled</title>
          <description>Allow privacy-preserving measurement of ad effectiveness _MUST_ be enabled in Safari.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -c '"WebKitPreferences.privateClickMeasurementEnabled" = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95283-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;WebKitPreferences.privateClickMeasurementEnabled&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:200"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_predictable_behavior_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Must behave in predictable and documented manner</title>
          <description>The information system behaves in a predictable and documented manner that reflects organizational and system objectives when invalid inputs are received.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-10(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-10(3)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95262-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_config_data_install_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Installation of XProtect Remediator and Gatekeeper Updates Automatically</title>
          <description>Software Update _MUST_ be configured to update XProtect Remediator and Gatekeeper automatically.

This setting enforces definition updates for XProtect Remediator and Gatekeeper; with this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require the computer to be restarted.

link:https://support.apple.com/en-us/HT207005[]

NOTE: Software update will automatically update XProtect Remediator and Gatekeeper by default in the macOS.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('ConfigDataInstall').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-3, SI-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005130</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4, 7.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95176-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SoftwareUpdate) payload type:

[source,xml]
----
&lt;key&gt;ConfigDataInstall&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:202"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_setup_assistant_filevault_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce FileVault in Setup Assistant</title>
          <description>FileVault _MUST_ be enforced in Setup Assistant.

The information system implements cryptographic mechanisms to protect the confidentiality and integrity of information stored on digital media during transport outside of controlled areas.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX.FileVault2')\
.objectForKey('ForceEnableInSetupAssistant')
EOS
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-28, SC-28(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-28, SC-28(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.08</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.6, 3.11</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95296-0</ident>
          <fixtext>NOTE: See the FileVault supplemental to implement this rule.

Create a configuration profile containing the following keys in the (com.apple.MCX.FileVault2) payload type:

[source,xml]
----
&lt;key&gt;ForceEnableInSetupAssistant&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:203"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_reauth_users_change_authenticators_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require users to reauthenticate when changing authenticators</title>
          <description>Without reauthentication, users may access resources or perform tasks for which they do not have authorization. When operating systems provide the capability to change user authenticators, it is critical the user reauthenticate.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95276-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_map_pki_identity_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Map identity for PKI based authentication</title>
          <description>Without mapping the certificate used to authenticate to the user account, the ability to determine the identity of the individual user or group will not be available for forensic analysis.
            
            For directory bound systems, the technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95226-7</ident>
          <fixtext>For directory bound systems, the technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_managed_access_control_points_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Managed Access Control Points</title>
          <description>Route remote accesses through authorized and managed network access control points.

Organizations consider the Trusted Internet Connections (TIC) initiative requirements for external network connections since limiting the number of access control points for remote access reduces attack surfaces.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-17(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.12</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95225-9</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sleep_and_display_sleep_apple_silicon_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Sleep and Display Sleep Is Enabled on Apple Silicon Devices</title>
          <description>Apple Silicon MacBooks should set sleep timeout to 15 minutes (900 seconds) or less and the display sleep timeout should be 10 minutes (600 seconds) or less but less than the sleep setting.
            
            error_count=0
if /usr/sbin/ioreg -rd1 -c IOPlatformExpertDevice 2&gt;&amp;1 | /usr/bin/grep -q "MacBook"; then
  sleepMode=$(/usr/bin/pmset -b -g | /usr/bin/grep '^\s*sleep' 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  displaysleepMode=$(/usr/bin/pmset -b -g | /usr/bin/grep displaysleep 2&gt;&amp;1 | /usr/bin/awk '{print $2}')

  if [[ "$sleepMode" == "" ]] || [[ "$sleepMode" -gt 15 ]]; then
    ((error_count++))
  fi
  if [[ "$displaysleepMode" == "" ]] || [[ "$displaysleepMode" -gt 10 ]] || [[ "$displaysleepMode" -gt "$sleepMode" ]]; then
    ((error_count++))
  fi
fi
echo "$error_count"
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.10.1.2 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95302-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/pmset -a sleep 15
/usr/bin/pmset -a displaysleep 10
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:207"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_guest_folder_removed_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Remove Guest Folder if Present</title>
          <description>The guest folder _MUST_ be deleted if present.
            
            /bin/ls /Users/ | /usr/bin/grep -c "Guest"
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.9 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95198-8</ident>
          <fixtext>[source,bash]
----
/bin/rm -Rf /Users/Guest
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:208"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_secure_enclave_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Protected Storage for Cryptographic Keys</title>
          <description>A system _IS_ configured to provide protected storage for cryptographic keys either by hardware protected key store or an organizationally defined safeguard.

Macs with Apple Silicon or T2 processors provide protected storage for cryptographic keys via the secure enclave.

link:https://support.apple.com/guide/security/secure-enclave-sec59b0b31ff/1/web/1[]

NOTE: This will only return a proper result on a T2 or Apple Silicon Macs.
            
            /usr/sbin/ioreg -w 0 -c AppleSEPManager | /usr/bin/grep -q 'AppleSEPManager'; /bin/echo $?
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-28(3)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95293-7</ident>
          <fixtext>The hardware does not support the requirement.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_password_hint_remove_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Remove Password Hint From User Accounts</title>
          <description>User accounts _MUST_ not contain password hints.
            
            HINT=$(/usr/bin/dscl . -list /Users hint | /usr/bin/awk '{ print $2 }')

if [ -z "$HINT" ]; then
  echo "PASS"
else
  echo "FAIL"
fi
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003014</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.12.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95250-7</ident>
          <fixtext>[source,bash]
----
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  /usr/bin/dscl . -delete /Users/$u hint
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:210"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_disk_image_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Disk Images</title>
          <description>Disk images _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["disk-image"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95182-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:211"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD ClientAliveCountMax to 0</title>
          <description>If SSHD is enabled it _MUST_ be configured with the Client Alive Maximum Count set to 0.

This will set the number of client alive messages which may be sent without the SSH server receiving any messages back from the client.  If this threshold is reached while client alive messages are being sent, the SSH server will disconnect the client, terminating the session.  The client alive messages are sent through the encrypted channel and therefore will not be spoofable.  The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'
            
            
Result: {'integer': '0'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000052</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95308-3</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'clientalivecountmax 0' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "clientalivecountmax 0" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:212"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_client_alive_count_max_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD ClientAliveCountMax to 1</title>
          <description>If SSHD is enabled it _MUST_ be configured with the Client Alive Maximum Count set to 1.

This will set the number of client alive messages which may be sent without the SSH server receiving any messages back from the client.  If this threshold is reached while client alive messages are being sent, the SSH server will disconnect the client, terminating the session.  The client alive messages are sent through the encrypted channel and therefore will not be spoofable.  The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'
            
            
Result: {'integer': '1'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000052</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95308-3</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'clientalivecountmax 1' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "clientalivecountmax 1" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:213"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_auth_peripherals_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Must Authenticate Before Establishing a Connection</title>
          <description>Organizational devices requiring unique device-to-device identification and authentication may be defined by type, by device, or by a combination of type/device. Information systems typically use either shared known information (e.g., Media Access Control [MAC] or Transmission Control Protocol/Internet Protocol [TCP/IP] addresses) for device identification or organizational authentication solutions (e.g., IEEE 802.1x and Extensible Authentication Protocol [EAP], Radius server with EAP-Transport Layer Security [TLS] authentication, Kerberos) to identify/authenticate devices on local and/or wide area networks. Organizations determine the required strength of authentication mechanisms by the security categories of information systems. Because of the challenges of applying this control on large scale, organizations are encouraged to only apply the control to those limited number (and type) of devices that truly need to support this capability.
            
            The technology does support this requirement, however, third party solutions are required to implement at an infrastructure level.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.02</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 13.9</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95163-2</ident>
          <fixtext>This requirement is a permanent finding and can be fixed by implementing a third party solution.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_privacy_setup_prompt_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Privacy Setup Services During Setup Assistant</title>
          <description>The prompt for Privacy Setup services during Setup Assistant _MUST_ be disabled.

Organizations _MUST_ apply organization-wide configuration settings. The macOS Privacy Setup services prompt guides new users through enabling their own specific privacy settings; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing privacy settings with the potential to override organization-wide settings.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Privacy")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002036</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95267-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;Privacy&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:215"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_limit_dos_attacks_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Impact of Denial of Service Attacks</title>
          <description>The macOS should be configured to limit the impact of Denial of Service (DoS) attacks.

DoS attacks leave authorized users unable to access information systems, devices, or other network resources due to the actions of a malicious cyber threat actor. When this occurs, the organization must operate at degraded capacity; often resulting in an inability to accomplish its mission.

To limit the impact of DoS attacks, organizations may choose to employ increased capacity and service redundancy, which has the potential to reduce systems' susceptibility to some DoS attacks. Managing excess capacity may include, for example, establishing selected usage priorities, quotas, or partitioning. Many operating systems can be integrated with enterprise-level firewalls and networking equipment that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-5(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-5(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95217-6</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_software_update_app_update_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Software Update App Update Updates Automatically</title>
          <description>Software Update _MUST_ be configured to enforce automatic updates of App Updates is enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticallyInstallAppUpdates').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95402-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SoftwareUpdate) payload type:

[source,xml]
----
&lt;key&gt;AutomaticallyInstallAppUpdates&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:217"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_filevault_authorized_users_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>FileVault Authorized Users</title>
          <description>macOS _MUST_ be configured to only allow authorized users to unlock FileVault upon startup.
            
            /usr/bin/fdesetup list | /usr/bin/awk -F',' '{print $1}'
            
            
Result: {'string': 'a list containing authorized users that can unlock FileVault'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(11)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95191-3</ident>
          <fixtext>Remove the user that is not authorized to unlock FileVault using the fdesetup command.

[source,bash]
----
/usr/bin/fdesetup remove -user NOT_AUTHORIZED_USERNAME
----

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_image_playground_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Image Playground</title>
          <description>Apple Intelligence features such as Image Playground _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowImagePlayground').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005150</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95207-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowImagePlayground&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:219"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_secure_boot_verify_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Secure Boot Level Set to Full</title>
          <description>The Secure Boot security setting _MUST_ be set to full.

Full security is the default Secure Boot setting in macOS. During startup, when Secure Boot is set to full security, the Mac will verify the integrity of the operating system before allowing the operating system to boot.

NOTE: This will only return a proper result on a T2 or Apple Silicon Macs.
            
            /usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep -c "SecureBootLevel = full"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-7, SI-7(1), SI-7(5), SI-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-6</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005100</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95292-9</ident>
          <fixtext>NOTE: Boot into Recovery Mode and enable Full Secure Boot

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:220"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudo_log_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudo To Log Events</title>
          <description>Sudo _MUST_ be configured to log privilege escalation.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Log when a command is allowed by sudoers"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000190</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.11 (level 1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95316-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/^Defaults[[:blank:]]*\!log_allowed/s/^/# /' '{}' \;
/bin/echo "Defaults log_allowed" &gt;&gt; /etc/sudoers.d/mscp
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:221"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_pii_deidentification_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Remove Elements of Personally Identifiable Information from Datasets</title>
          <description>Remove the following elements of personally identifiable information from datasets: organization-defined elements of personally identifiable information and evaluate organization-defined frequency for effectiveness of de-identification.

De-identification is the general term for the process of removing the association between a set of identifying data and the data subject. Many datasets contain information about individuals that can be used to distinguish or trace an individual's identity, such as name, social security number, date and place of birth, mother's maiden name, or biometric records. Datasets may also contain other information that is linked or linkable to an individual, such as medical, educational, financial, and employment information. Personally identifiable information is removed from datasets by trained individuals when such information is not (or no longer) necessary to satisfy the requirements envisioned for the data. For example, if the dataset is only used to produce aggregate statistics, the identifiers that are not needed for producing those statistics are removed. Removing identifiers improves privacy protection since information that is removed cannot be inadvertently disclosed or improperly used. Organizations may be subject to specific de-identification definitions or methods under applicable laws, regulations, or policies. Re-identification is a residual risk with de-identified data. Re-identification attacks can vary, including combining new datasets or other improvements in data analytics. Maintaining awareness of potential attacks and evaluating for the effectiveness of the de-identification over time support the management of this residual risk.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-19</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95255-6</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_uucp_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Unix-to-Unix Copy Protocol Service</title>
          <description>The system _MUST_ not have the Unix-to-Unix Copy Protocol (UUCP) service active.

UUCP, a set of programs that enable the sending of files between different UNIX systems as well as sending commands to be executed on another system, is not essential and _MUST_ be disabled in order to prevent the unauthorized connection of devices, transfer of information, and tunneling.

NOTE: UUCP service is disabled at startup by default macOS.
            
            result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.uucp" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.uucp 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002006</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3, 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95330-7</ident>
          <fixtext>[source,bash]
----
/bin/launchctl bootout system/com.apple.uucp 
/bin/launchctl disable system/com.apple.uucp
----
The system may need to be restarted for the update to take effect.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:223"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_burn_support_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Burn Support</title>
          <description>Burn support _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '(BurnSupport = off;|ProhibitBurn = 1;)'
            
            
Result: {'integer': 2}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95170-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.finder) payload type:

[source,xml]
----
&lt;key&gt;ProhibitBurn&lt;/key&gt;
&lt;true/&gt;
----

Create a configuration profile containing the following keys in the (com.apple.DiscRecording) payload type:

[source,xml]
----
&lt;key&gt;BurnSupport&lt;/key&gt;
&lt;string&gt;off&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:224"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Login Window</title>
          <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
You are accessing a U.S. Government information system, which includes: 1) this computer, 2) this computer network, 3) all Government-furnished computers connected to this network, and 4) all Government-furnished devices and storage media attached to this network or to a computer on this network. You understand and consent to the following: you may access this information system for authorized use only; unauthorized use of the system is prohibited and subject to criminal and civil penalties; you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this information system at any time and for any lawful Government purpose, the Government may monitor, intercept, audit, and search and seize any communication or data transiting or stored on this information system; and any communications or data transiting or stored on this information system may be disclosed or used for any lawful Government purpose. This information system may contain Controlled Unclassified Information (CUI) that is subject to safeguarding or dissemination controls in accordance with law, regulation, or Government-wide policy. Accessing and using this system indicates your understanding of this warning.
----
            
            /bin/ls -ld /Library/Security/PolicyBanner.rtf* | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000025</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.8 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95257-2</ident>
          <fixtext>[source,bash]
----
bannerText="You are accessing a U.S. Government information system, which includes: 1) this computer, 2) this computer network, 3) all Government-furnished computers connected to this network, and 4) all Government-furnished devices and storage media attached to this network or to a computer on this network. You understand and consent to the following: you may access this information system for authorized use only; unauthorized use of the system is prohibited and subject to criminal and civil penalties; you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this information system at any time and for any lawful Government purpose, the Government may monitor, intercept, audit, and search and seize any communication or data transiting or stored on this information system; and any communications or data transiting or stored on this information system may be disclosed or used for any lawful Government purpose. This information system may contain Controlled Unclassified Information (CUI) that is subject to safeguarding or dissemination controls in accordance with law, regulation, or Government-wide policy. Accessing and using this system indicates your understanding of this warning."
/bin/mkdir /Library/Security/PolicyBanner.rtfd
/usr/bin/textutil -convert rtf -output /Library/Security/PolicyBanner.rtfd/TXT.rtf -stdin &lt;&lt;EOF
$bannerText
EOF
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:225"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Login Window</title>
          <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
Center for Internet Security Test Message
----
            
            /bin/ls -ld /Library/Security/PolicyBanner.rtf* | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000025</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.8 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95257-2</ident>
          <fixtext>[source,bash]
----
bannerText="Center for Internet Security Test Message"
/bin/mkdir /Library/Security/PolicyBanner.rtfd
/usr/bin/textutil -convert rtf -output /Library/Security/PolicyBanner.rtfd/TXT.rtf -stdin &lt;&lt;EOF
$bannerText
EOF
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:226"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Login Window</title>
          <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
Center for Internet Security Test Message
----
            
            /bin/ls -ld /Library/Security/PolicyBanner.rtf* | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000025</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.8 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95257-2</ident>
          <fixtext>[source,bash]
----
bannerText="Center for Internet Security Test Message"
/bin/mkdir /Library/Security/PolicyBanner.rtfd
/usr/bin/textutil -convert rtf -output /Library/Security/PolicyBanner.rtfd/TXT.rtf -stdin &lt;&lt;EOF
$bannerText
EOF
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:227"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_loginwindow_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Login Window</title>
          <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.
----
            
            /bin/ls -ld /Library/Security/PolicyBanner.rtf* | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000025</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.8 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95257-2</ident>
          <fixtext>[source,bash]
----
bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
/bin/mkdir /Library/Security/PolicyBanner.rtfd
/usr/bin/textutil -convert rtf -output /Library/Security/PolicyBanner.rtfd/TXT.rtf -stdin &lt;&lt;EOF
$bannerText
EOF
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:228"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_writing_tools_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Writing Tools</title>
          <description>Apple Intelligence features such as writing tools that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowWritingTools').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005160</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.5.1.2 (level 1)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95334-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowWritingTools&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:229"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_user_app_installation_prohibit_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit User Installation of Software into /Users/</title>
          <description>Users _MUST_ not be allowed to install software into /Users/.

Allowing regular users to install software, without explicit privileges, presents the risk of untested and potentially malicious software being installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceeds the rights of a regular user.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Users/" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-11(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-11(2)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005080</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95329-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;pathBlackList&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;/Users/&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:230"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_continuous_monitoring_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Automated Flaw Remediation</title>
          <description>The macOS system _MUST_ be configured to determine the state of system components with regard to flaw remediation.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-2(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95178-0</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_unique_identification_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Uniquely Identify Users and Processes</title>
          <description>The macOS is a UNIX 03-compliant operating system. The system uniquely identifies and authenticates organizational users or processes.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.05</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.1, 6.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95327-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_account_disabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Account Disabled Actions</title>
          <description>The macOS should be configured to automatically notify system administrators and Information System Security Officers (ISSOs) when accounts are disabled.

When operating system accounts are disabled, user accessibility is affected. Accounts are utilized for identifying individual operating system users or for identifying the operating system processes themselves. To detect and respond to events that affect user accessibility and system processing, operating systems should audit account disabling actions and, as required, notify system administrators and ISSOs so they can investigate the event. Such a capability greatly reduces the risk that operating system accessibility will be negatively affected for extended periods of time and also provides logging that can be used for forensic purposes.

To enable notifications and audit logging of disabled accounts, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95241-6</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_rapid_security_response_removal_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable User Ability from Being Able to Undo Rapid Security Responses</title>
          <description>Rapid security response (RSR) mechanism _MUST_ be enabled and the ability for the user to disable RSR _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowRapidSecurityResponseRemoval').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-2, SI-2(5), SI-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.01, 03.14.02</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95273-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowRapidSecurityResponseRemoval&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:234"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_touchid_prompt_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable TouchID Prompt during Setup Assistant</title>
          <description>The prompt for TouchID during Setup Assistant _MUST_ be disabled.

macOS prompts new users through enabling TouchID during Setup Assistant; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing to enable TouchID to override organization-wide settings.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Biometric")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005054</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95326-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;Biometric&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:235"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_filevault_autologin_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable FileVault Automatic Login</title>
          <description>If FileVault is enabled, automatic login _MUST_ be disabled, so that both FileVault and login window authentication are required.

The default behavior of macOS when FileVault is enabled is to automatically log in to the computer once successfully passing your FileVault credentials.

NOTE: DisableFDEAutoLogin does not have to be set on Apple Silicon based macOS systems that are smartcard enforced as smartcards are available at pre-boot.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('DisableFDEAutoLogin').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, IA-5(13), AC-2(11)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(11), AC-3, IA-5(13)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000033</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3, 6.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95192-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;DisableFDEAutoLogin&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:236"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_skip_screen_time_prompt_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Screen Time Prompt During Setup Assistant</title>
          <description>The prompt for Screen Time setup during Setup Assistant _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("ScreenTime")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005055</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95300-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;ScreenTime&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:237"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_provide_disconnect_remote_access_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Provide Ability to Disconnect or Disable Remote Access</title>
          <description>Without the ability to immediately disconnect or disable remote access, an attack or other compromise taking place would not be immediately stopped.Operating system remote access functionality must have the capability to immediately disconnect current users remotely accessing the information system and/or disable further remote access. The speed of disconnect or disablement varies based on the criticality of missions functions and the need to eliminate immediate or future remote access to organizational information systems.The remote access functionality (e.g., SSH) may implement features such as automatic disconnect (or user-initiated disconnect) in case of adverse information based on an indicator of compromise or attack.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-17(9)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-17(9)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95271-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_blank_cd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Blank CD</title>
          <description>Blank CD media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankcd"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95166-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:239"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_isolate_security_functions_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Separate User and System Functionality</title>
          <description>The information system _IS_ configured to isolate security functions from non-security functions.

link:https://support.apple.com/guide/security/welcome/web[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95214-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_messages_app_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Messages App</title>
          <description>The macOS built-in Messages.app _MUST_ be disabled.

The Messages.app establishes a connection to Apple's iCloud service, even when security controls to disable iCloud access have been put in place.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Messages.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95228-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;pathBlackList&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;/Applications/Messages.app&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:241"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_config_profile_ui_install_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Installation of Configuration Profiles through the User Interface</title>
          <description>Installation of configuration profiles through the user interface _MUST_ be disabled and only be permitted through an authorized MDM server.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowUIConfigurationProfileInstallation').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.05</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95177-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowUIConfigurationProfileInstallation&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:242"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_required_crypto_module_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure all Federal Laws, Executive Orders, Directives, Policies, Regulations, Standards, and Guidance for Authentication to a Cryptographic Module are Met</title>
          <description>The inherent configuration of the macOS _IS_ in compliance by implementing mechanisms for authentication to a cryptographic module that meet the requirements of all applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for such authentication

macOS contains many open source projects that may use their own cryptographic libraries typically for the purposes of maintaining platform independence. These services are not covered by the Apple FIPS Validation of the CoreCrypto and CoreCrypto Kernel modules.

Apple is committed to the FIPS validation process and historically has always submitted and validated the cryptographic modules in macOS. macOS Tahoe for Apple Silicion will be submitted for FIPS validation. macOS Tahoe for Intel based processors will _NOT_ be submitted for FIPS validation.

link:https://csrc.nist.gov/Projects/cryptographic-module-validation-program/validated-modules[]

link:https://support.apple.com/guide/sccc/welcome/web[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95281-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_per_source_penalties_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD PerSourcePenalties</title>
          <description>If SSHD is enabled then it _MUST_ be configured with the Per Source Penalties configured.

Per Source Penalities controls penalties for various conditions that may represent attacks on sshd.

Penalties are enabled by default.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/grep -q "persourcepenalties no" &amp;&amp; echo "no" || echo "yes"
            
            
Result: {'string': 'yes'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95312-5</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'persourcepenalties yes' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "persourcepenalties yes" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:244"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_malicious_code_prevention_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure the System Implements Malicious Code Protection Mechanisms</title>
          <description>The inherent configuration of the macOS _IS_ in compliance as Apple has designed the system with three layers of protection against malware. Each layer of protection is comprised of one or more malicious code protection mechanisms, which are automatically implemented and which, collectively, meet the requirements of all applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance for malicious code prevention.

1. This  first layer of defense targets the distribution of malware; the aim is to prevent malware from ever launching.
The following mechanisms are inherent to the macOS design and constitute the first layer of protection against malicious code:
*	The Apple App Store: the safest way to add new applications to a Mac is by downloading them from the App Store; all apps available for download from the App Store have been reviewed for signs of tampering and signed by Apple to indicate that the app meets security requirements and does not contain malware.
*	XProtect: a built-in, signature-based, anti-virus, anti-malware technology inherent to all Macs. XProtect automatically detects and blocks the execution of known malware.
  *	In macOS 10.15 and all subsequent releases, XProtect checks for known malicious content when:
    *	an app is first launched,
    *	an app has been changed (in the file system), and
    *	XProtect signatures are updated.
*	YARA: another built-in tool (inherent to all Macs), which conducts signature-based detection of malware. Apple updates YARA rules regularly.
*	Gatekeeper: a security feature inherent to all Macs; Gatekeeper scans apps to detect malware and/or revocations of a developer's signing certificate and prevents unsafe apps from running.
*	Notarization: Apple performs regular, automated scans to detect signs of malicious content and to verify developer ID-signed software; when no issues are found, Apple notarizes the software and delivers the results of scans to the system owner.

2. The second layer of defense targets malware that manages to appear on a Mac before it runs; the aim is to quickly identify and block any malware present on a Mac in order to prevent the malware from running and further spreading.
The following mechanisms are inherent to the macOS design and constitute the second layer of protection against malicious code:
*	XProtect (defined above).
*	Gatekeeper (defined above).
*	Notarization (defined above).

3.  The third layer of defense targets infected Mac system(s); the aim is to remediate Macs on which malware has managed to successfully execute.
The following mechanism is inherent to the macOS design and constitutes the third layer of protection against malicious code:
*	Apple's XProtect: a technology included on all macOS systems. XProtect will remediate infections upon receiving updated information delivered and when infections are detected

link:https://support.apple.com/guide/security/protecting-against-malware-sec469d47bd8/1/web/1[]

link:https://support.apple.com/guide/security/app-security-overview-sec35dd877d0/web[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.02</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 10.1, 10.2, 10.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95224-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_genmoji_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Genmoji AI Creation</title>
          <description>Apple Intelligence features such as Genmoji _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowGenmoji').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005140</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95196-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowGenmoji&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:246"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_airdrop_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable AirDrop</title>
          <description>AirDrop _MUST_ be disabled to prevent file transfers to or from unauthorized devices.
AirDrop allows users to share and receive files from other nearby Apple devices.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAirDrop').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-3, AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002009</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.1.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 6.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95156-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowAirDrop&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:247"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudoers_timestamp_type_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudoers Timestamp Type</title>
          <description>The file /etc/sudoers _MUST_ be configured to not include a timestamp_type of global or ppid and be configured for timestamp record types of tty.

This rule ensures that the "sudo" command will prompt for the administrator's password at least once in each newly opened terminal window. This prevents a malicious user from taking advantage of an unlocked computer or an abandoned logon session by bypassing the normal password prompt requirement.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/awk -F": " '/Type of authentication timestamp record/{print $2}'
            
            
Result: {'string': 'tty'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-5(1), IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95318-2</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_type/d; /!tty_tickets/d' '{}' \;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:248"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_grant_privs_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Allow Administrators to Promote Other Users to Administrator Status</title>
          <description>The information system _IS_ configured to allow current administrators to promote standard users to administrator user status.

The macOS is a UNIX 03-compliant operating system which allows administrators of the system to grant privileges to other users.

link:https://support.apple.com/guide/mac-help/set-up-other-users-on-your-mac-mtusr001/mac[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3(4)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95197-0</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_store_encrypted_passwords_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Encrypt Stored Passwords</title>
          <description>The information system _IS_ configured to encrypt stored passwords.

Passwords need to be protected at all times, and encryption is the standard method for protecting passwords. If passwords are not encrypted, they can be plainly read (i.e., clear text) and easily compromised.

link:https://developer.apple.com/documentation/opendirectory/kodattributetypeauthenticationauthority[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1), IA-5(1)(c)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1), IA-5(1)(c)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.11</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95315-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_parental_controls_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Parental Controls</title>
          <description>Parental Controls _MUST_ be enabled.

Control of program execution is a mechanism used to prevent program execution of unauthorized programs, which is critical to maintaining a secure system baseline.

Parental Controls on the macOS consist of many different payloads, which are set individually depending on the type of control required. Enabling parental controls allows for further configuration of these restrictions.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
.objectForKey('familyControlsEnabled').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95248-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:251"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_prevent_unauthorized_disclosure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Prevent the Unauthorized Disclosure of Data via Shared Resources</title>
          <description>The information system _IS_ configured to ensure that the unauthorized disclosure of data does not occur when resources are shared.

The inherent configuration of the macOS does not allow for resources to be shared between users without authorization.

link:https://developer.apple.com/library/archive/documentation/Security/Conceptual/AuthenticationAndAuthorizationGuide/Permissions/Permissions.html[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.04</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95265-5</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_terminate_session_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Terminate all sessions and network connections when maintenance is completed</title>
          <description>Terminates session and network connections when non-local maintenance is completed.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95322-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_system_read_only_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure System Volume is Read Only</title>
          <description>The System volume _MUST_ be mounted as read-only in order to ensure that configurations critical to the integrity of the macOS have not been compromised. System Integrity Protection (SIP) will prevent the system volume from being mounted as writable.

NOTE: The system volume is read only by default in macOS.
            
            /usr/sbin/system_profiler SPStorageDataType | /usr/bin/awk '/Mount Point: \/$/{x=NR+2}(NR==x){print $2}'
            
            
Result: {'string': 'No'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-34, MA-4(1), SI-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-34, SI-7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95319-0</ident>
          <fixtext>NOTE: To remount the System volume as Read Only, rebooting the computer will mount it as Read Only.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:254"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set SSH Active Server Alive Maximum to 0</title>
          <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 0. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveralivecountmax 0")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000140</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95305-9</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/ssh_config | /usr/bin/tr -d '*')

ssh_config=("ServerAliveCountMax 0")

ssh_setting=$(echo $ssh_config | /usr/bin/cut -d " " -f1)
/usr/bin/grep -qEi "^$ssh_setting" "${include_dir}01-mscp-ssh.conf" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/" "${include_dir}01-mscp-ssh.conf" || echo "$ssh_config" &gt;&gt; "${include_dir}01-mscp-ssh.conf"
for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
  config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2&gt;&amp;1)
  configfiles=$(echo "$config" | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\r')
  configarray=( ${(f)configfiles} )
  if ! echo $config | /usr/bin/grep -q -i "$ssh_config" ; then
    for c in $configarray; do
      if [[ "$c" == "/etc/ssh/crypto.conf" ]]; then
        continue
      fi
      
      /usr/bin/sudo -u $u /usr/bin/grep -qEi "^$ssh_setting" "$c" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/I" "$c"
      if [[ "$c" =~ ".ssh/config" ]]; then
        if /usr/bin/grep -qEi "$ssh_setting" "$c" 2&gt; /dev/null; then
          old_file=$(cat ~$u/.ssh/config)
          echo "$ssh_config" &gt; ~$u/.ssh/config
          echo "$old_file" &gt;&gt; ~$u/.ssh/config
        fi
      fi
    done
  fi
done

----  

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:255"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ssh_server_alive_count_max_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set SSH Active Server Alive Maximum to 0</title>
          <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 0. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveralivecountmax 0")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000140</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95305-9</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/ssh_config | /usr/bin/tr -d '*')

ssh_config=("ServerAliveCountMax 0")

ssh_setting=$(echo $ssh_config | /usr/bin/cut -d " " -f1)
/usr/bin/grep -qEi "^$ssh_setting" "${include_dir}01-mscp-ssh.conf" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/" "${include_dir}01-mscp-ssh.conf" || echo "$ssh_config" &gt;&gt; "${include_dir}01-mscp-ssh.conf"
for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
  config=$(/usr/bin/sudo -u $u /usr/bin/ssh -Gv . 2&gt;&amp;1)
  configfiles=$(echo "$config" | /usr/bin/awk '/Reading configuration data/ {print $NF}'| /usr/bin/tr -d '\r')
  configarray=( ${(f)configfiles} )
  if ! echo $config | /usr/bin/grep -q -i "$ssh_config" ; then
    for c in $configarray; do
      if [[ "$c" == "/etc/ssh/crypto.conf" ]]; then
        continue
      fi
      
      /usr/bin/sudo -u $u /usr/bin/grep -qEi "^$ssh_setting" "$c" &amp;&amp; /usr/bin/sed -i "" "s/^$ssh_setting.*/${ssh_config}/I" "$c"
      if [[ "$c" =~ ".ssh/config" ]]; then
        if /usr/bin/grep -qEi "$ssh_setting" "$c" 2&gt; /dev/null; then
          old_file=$(cat ~$u/.ssh/config)
          echo "$ssh_config" &gt; ~$u/.ssh/config
          echo "$old_file" &gt;&gt; ~$u/.ssh/config
        fi
      fi
    done
  fi
done

----  

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:256"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_hibernate_mode_destroyfvkeyonstandby_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable DestroyFVKeyOnStandby on Hibernate</title>
          <description>DestroyFVKeyOnStandby on hibernate _MUST_ be enabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('DestroyFVKeyOnStandby').js
EOS
            
            
Result: {'string': 'true'}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95200-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.MCX) payload type:

[source,xml]
----
&lt;key&gt;DestroyFVKeyOnStandby&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:257"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_nfsd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Network File System Service</title>
          <description>Support for Network File Systems (NFS) services is non-essential and, therefore, _MUST_ be disabled.
            
            isDisabled=$(/sbin/nfsd status | /usr/bin/awk '/nfsd service/ {print $NF}')    
if [[ "$isDisabled" == "disabled" ]] &amp;&amp; [[ -z $(/usr/bin/pgrep nfsd) ]]; then
  echo "pass"
else
  echo "fail"
fi
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002003</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 4.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95235-8</ident>
          <fixtext>[source,bash]
----
/bin/launchctl disable system/com.apple.nfsd
/bin/rm -rf /etc/exports
----
The system may need to be restarted for the update to take effect.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:258"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_change_security_attributes_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Allow Administrators to Modify Security Settings and System Attributes</title>
          <description>The information system _IS_ configured to allow administrators to modify security settings and system attributes.

The macOS is a UNIX 03-compliant operating system, which allows administrators of the system to change security settings and system attributes, including those which are kept within preference panes that are locked for standard users. .

link:https://support.apple.com/guide/mac-help/change-permissions-for-files-folders-or-disks-mchlp1203/mac[]
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3(4)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3(4)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95175-6</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_permit_root_login_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Root Login for SSH</title>
          <description>If SSH is enabled to assure individual accountability and prevent unauthorized access, logging in as root via SSH _MUST_ be disabled.

The macOS system MUST  require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users _MUST_ never log in directly as root.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/permitrootlogin/{print $2}'
            
            
Result: {'string': 'no'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2(5)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-001100</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95313-3</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'permitrootlogin no' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "permitrootlogin no" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:260"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_account_modification_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable AppleID and Internet Account Modifications</title>
          <description>The system _MUST_ disable account modification. 

Account modification includes adding additional or modifying internet accounts in Apple Mail, Calendar, Contacts, in the Internet Account System Setting Pane, or the AppleID System Setting Pane.

This prevents the addition of unauthorized accounts.

[IMPORTANT]
====
Some organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAccountModification').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002120</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95155-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowAccountModification&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:261"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_httpd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the Built-in Web Server</title>
          <description>The built-in web server which is managed by launchd is a non-essential service built into macOS and _MUST_ be disabled and not running.

NOTE: The built in web server service is disabled at startup by default macOS.
            
            result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"org.apache.httpd" =&gt; enabled')
running=$(/bin/launchctl print system/org.apache.httpd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002008</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 4.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95204-4</ident>
          <fixtext>[source,bash]
----
/usr/sbin/apachectl stop 2&gt;/dev/null
/bin/launchctl disable system/org.apache.httpd
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:262"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_nonlocal_maintenance_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System for Non-local Maintenance</title>
          <description>Non-local maintenance and diagnostic activities are those activities conducted by individuals communicating through a network, either an external network or an internal network.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.07.05</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95237-4</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_asl_log_files_owner_group_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Apple System Log Files Owned by Root and Group to Wheel</title>
          <description>The Apple System Logs (ASL) _MUST_ be owned by root.

ASL logs contain sensitive data about the system and users. If ASL log files are set to only be readable and writable by system administrators, the risk is mitigated.
            
            /usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2&gt; /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004001</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95161-6</ident>
          <fixtext>[source,bash]
----
/usr/sbin/chown root:wheel $(/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/* | /usr/bin/awk '{ print $2 }') 2&gt; /dev/null | /usr/bin/awk '!/^root:wheel:/{print $1}' | /usr/bin/awk -F":" '!/^root:wheel:/{print $3}')
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:264"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_hibernate_mode_intel_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Hibernate Mode (Intel)</title>
          <description>Hibernate mode _MUST_ be enabled.

This will store a copy of memory to persistent storage, and will remove power to memory. This setting will stop the potential for a cold-boot attack.
            
            error_count=0
if /usr/sbin/ioreg -rd1 -c IOPlatformExpertDevice 2&gt;&amp;1 | /usr/bin/grep -q "MacBook"; then
  hibernateMode=$(/usr/bin/pmset -b -g | /usr/bin/grep hibernatemode 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyLowValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelaylow 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyHighValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelayhigh 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyThreshValue=$(/usr/bin/pmset -g | /usr/bin/grep highstandbythreshold 2&gt;&amp;1 | /usr/bin/awk '{print $2}')

  if [[ "$hibernateStandbyLowValue" == "" ]] || [[ "$hibernateStandbyLowValue" -gt 900 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateStandbyHighValue" == "" ]] || [[ "$hibernateStandbyHighValue" -gt 900 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateStandbyThreshValue" == "" ]] || [[ "$hibernateStandbyThreshValue" -lt 90 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateMode" == "" ]] || [[ "$hibernateMode" != 25 ]]; then
    ((error_count++))
  fi
fi
echo "$error_count"
            
            
Result: {'integer': 0}</description>
          <ident system="https://ncp.nist.gov/cce">CCE-95201-0</ident>
          <fixtext>[source,bash]
----
/usr/bin/pmset -a standbydelaylow 900
/usr/bin/pmset -a standbydelayhigh 900
/usr/bin/pmset -a highstandbythreshold 90
/usr/bin/pmset -a hibernatemode 25
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:265"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mfa_network_access_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce multifactor authentication for network access to privileged accounts</title>
          <description>The information system implements multifactor authentication for network access to privileged accounts.
            
            For directory bound systems:
The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95229-1</ident>
          <fixtext>For directory bound systems, the technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_identify_non-org_users_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Uniquely Identify and Authenticate Non-Organizational Users</title>
          <description>The information system uniquely identifies and authenticates non-organizational users (or processes acting on behalf of non-organizational users).
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95206-9</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_recovery_lock_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Recovery Lock</title>
          <description>A recovery lock password _MUST_ be enabled and set.

Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding down specific key combinations during startup. Setting a recovery lock restricts access to these tools.

IMPORTANT: Recovery lock passwords are not supported on Intel devices. This rule is only applicable to Apple Silicon devices.
            
            /usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep -c "IsRecoveryLockEnabled = 1"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.05</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005120</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95277-0</ident>
          <fixtext>NOTE: The SetRecoveryLock command can be used to set a Recovery Lock password and must be from your MDM.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:268"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_blank_dvd_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Blank DVD</title>
          <description>Blank DVD media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankdvd"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95167-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:269"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_loginwindow_adminhostinfo_disabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prevent AdminHostInfo from Being Available at Login Window</title>
          <description>The system _MUST_ be configured to not display sensitive information at the login window. If the key `AdminHostInfo` is configured with a string value, it will allow the HostName, IP Address, and operating system version and build to be displayed when clicking on the clock area of the login window.

Configuring this key to be an integer value, since it expects a string value, will effectively disable the behavior.

NOTE: This configuration requires it to be deployed via Managed Preferences rather than directly to com.apple.loginwindow.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.integerForKey('AdminHostInfo')
EOS
            
            
Result: {'integer': -1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-11(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.10</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000009</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95600-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

NOTE: The following settings are in the (com.apple.ManagedClient.preferences) payload. This payload requires the additional settings to be sub-payloads within, containing their defined payload types.

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;AdminHostInfo&lt;/key&gt;
&lt;integer&gt;-1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:270"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_show_full_website_address_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Show Full Website Address in Safari Is Enabled</title>
          <description>Show full website address _MUST_ be enabled in Safari.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'ShowFullURLInSmartSearchField = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95287-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;ShowFullURLInSmartSearchField&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:271"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_home_folders_default_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure User's Home Folders to Apple's Default</title>
          <description>The system _MUST_ be configured to prevent access to other user's home folders.

Configuring the operating system to use the most restrictive permissions possible for user home directories helps to protect against inadvertent disclosures.
            
            Verify the macOS system is configured so that permissions are set correctly on user home directories with the following commands:
/bin/ls -le /Users

This command will return a listing of the permissions of the root of every user account configured on the system. For each of the users, the permissions must be "drwxr-xr-x+", with the user listed as the owner and the group listed as \"staff\". The plus(+) sign indicates an associated Access Control List, which must be:
0: group:everyone deny delete

For every authorized user account, also run the following command:
/usr/bin/sudo /bin/ls -le /Users/userid, where userid is an existing user.

This command will return the permissions of all the objects under the users' home directory. The permissions for each of the subdirectories must be:
drwx------+
0: group:everyone deny delete

The exception is the \"Public\" directory, whose permissions must match the following:

drwxr-xr-x+
0: group:everyone deny delete

If the permissions returned by either of these checks differ from what is shown, this is a finding.
            
            
Result: </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.05</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95202-8</ident>
          <fixtext>Configure the macOS system to set the appropriate permissions for each user on the system with the following command:

`/usr/sbin/diskutil resetUserPermissions / DeviceNode UID`, where "DeviceNode UID" is the ID number for the user whose home directory permissions need to be repaired.

NOTE: Using the `/usr/sbin/diskutil resetUserPermissions` command will only reset the permissions on the default folder set. Other folders in the home directory will not be affected.
</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mobile_file_integrity_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Apple Mobile File Integrity</title>
          <description>Mobile file integrity _MUST_ be enabled.
            
            /usr/sbin/nvram -p | /usr/bin/grep -c "amfi_get_out_of_my_way=1"
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 2.3, 2.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95231-7</ident>
          <fixtext>[source,bash]
----
/usr/sbin/nvram boot-args=""
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:273"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_gatekeeper_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Gatekeeper</title>
          <description>Gatekeeper _MUST_ be enabled.

Gatekeeper is a security feature that ensures that applications are digitally signed by an Apple-issued certificate before they are permitted to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.

Administrator users will still have the option to override these settings on a case-by-case basis.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('EnableAssessment').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-14, CM-5, SI-7(1), SI-7(15), SI-3</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-5(3), CM-5, SI-3, SI-7(15)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.14.02</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002064</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.6.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 10.1, 10.2, 10.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95195-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempolicy.control) payload type:

[source,xml]
----
&lt;key&gt;EnableAssessment&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:274"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sip_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure System Integrity Protection is Enabled</title>
          <description>System Integrity Protection (SIP) _MUST_ be enabled.

SIP is vital to protecting the integrity of the system as it prevents malicious users and software from making unauthorized and/or unintended modifications to protected files and folders; ensures the presence of an audit record generation capability for defined auditable events for all operating system components; protects audit tools from unauthorized access, modification, and deletion; restricts the root user account and limits the actions that the root user can perform on protected parts of the macOS; and prevents non-privileged users from granting other users direct access to the contents of their home directories and folders.

NOTE: SIP is enabled by default in macOS.
            
            /usr/bin/csrutil status | /usr/bin/grep -c 'System Integrity Protection status: enabled.'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-3, AU-9, AU-9(3), CM-5, CM-5(6), SC-4, SI-2, SI-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-3, AU-6(4), AU-7(1), AU-7, AU-9, AU-9(3), CM-5(6), CM-5, SC-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.02, 03.03.08, 03.04.05, 03.13.04</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005001</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 2.3, 2.6, 10.5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95298-6</ident>
          <fixtext>[source,bash]
----
/usr/bin/csrutil enable
----
NOTE: To reenable "System Integrity Protection", boot the affected system into "Recovery" mode, launch "Terminal" from the "Utilities" menu, and run the command.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:275"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_removable_media_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Removable Storage Devices</title>
          <description>Removable media, such as USB connected external hard drives, thumb drives, and optical media, _MUST_ be disabled for users.

Disabling removable storage devices reduces the risks and known vulnerabilities of such devices (e.g., malicious code insertion)

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["harddisk-external"]
EOS
            
            
Result: {'string': 'deny'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95279-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;alert&lt;/string&gt;
        &lt;string&gt;eject&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:276"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_world_writable_library_folder_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure No World Writable Files Exist in the Library Folder</title>
          <description>Folders in /System/Volumes/Data/Library _MUST_ not be world-writable.

NOTE: Some vendors are known to create world-writable folders to the System Library folder. You may need to add more exclusions to this check and fix to match your environment.
            
            /usr/bin/find /Library -type d -perm -002 ! -perm -1000 ! -xattrname com.apple.rootless 2&gt;/dev/null | /usr/bin/wc -l | /usr/bin/xargs
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.7 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95332-3</ident>
          <fixtext>[source,bash]
----
IFS=$'\n'
for libPermissions in $(/usr/bin/find /Library -type d -perm -002 ! -perm -1000 ! -xattrname com.apple.rootless 2&gt;/dev/null); do
  /bin/chmod -R o-w "$libPermissions"
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:277"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_dictation_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Dictation</title>
          <description>Dictation _MUST_ be disabled on Intel based Macs as the feature On Device Dictation is only available on Apple Silicon devices.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowDictation').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002230</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95180-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowDictation&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:278"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Remote Login</title>
          <description>Remote login service _MUST_ be configured to display a policy banner at login.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.
            
            bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
test "$(cat /etc/banner)" = "$bannerText" &amp;&amp; echo "1" || echo "0"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000023</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95258-0</ident>
          <fixtext>[source,bash]
----
bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
/bin/echo "${bannerText}" &gt; /etc/banner
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:279"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_policy_banner_ssh_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Display Policy Banner at Remote Login</title>
          <description>Remote login service _MUST_ be configured to display a policy banner at login.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.
            
            bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
test "$(cat /etc/banner)" = "$bannerText" &amp;&amp; echo "1" || echo "0"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-8</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000023</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95258-0</ident>
          <fixtext>[source,bash]
----
bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
/bin/echo "${bannerText}" &gt; /etc/banner
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:280"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_terminal_secure_keyboard_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Secure Keyboard Entry Terminal.app is Enabled</title>
          <description>Secure keyboard entry _MUST_ be enabled in Terminal.app.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Terminal')\
.objectForKey('SecureKeyboardEntry').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.4.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95321-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Terminal) payload type:

[source,xml]
----
&lt;key&gt;SecureKeyboardEntry&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:281"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_peripherals_identify_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>The macOS system must uniquely identify peripherals before establishing a connection.</title>
          <description>Without identifying devices, unidentified or unknown devices may be introduced, thereby facilitating malicious activity.

Peripherals include, but are not limited to, such devices as flash drives, external storage, and printers.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95253-1</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_time_server_enabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enable Time Synchronization Daemon</title>
          <description>The macOS time synchronization daemon (timed) _MUST_ be enabled for proper time synchronization to an authorized time server.

NOTE: The time synchronization daemon is enabled by default on macOS.
            
            /bin/launchctl print system | /usr/bin/grep -c -E '\tcom.apple.timed'
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-12(1), SC-45(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-8(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000180</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.3.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95325-7</ident>
          <fixtext>[source,bash]
----
/bin/launchctl load -w /System/Library/LaunchDaemons/com.apple.timed.plist
----

NOTE: The service `timed` cannot be unloaded or loaded while System Integrity Protection (SIP) is enabled.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:283"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Login to Other User's Active and Locked Sessions</title>
          <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.
            
            RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000090</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95328-1</ident>
          <fixtext>[source,bash]
----
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver 2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "$SS_RULE" == *psso* ]]; then
    /usr/bin/security -q authorizationdb read psso-screensaver &gt; "/tmp/psso-screensaver-mscp.plist"
    /usr/bin/sed -i.bak 's/&lt;string&gt;authenticate-session-owner-or-admin&lt;\/string&gt;/&lt;string&gt;authenticate-session-owner&lt;\/string&gt;/' /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write psso-screensaver-mscp &lt; /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write system.login.screensaver psso-screensaver-mscp 2&gt;&amp;1
else
    /usr/bin/security -q authorizationdb write system.login.screensaver "authenticate-session-owner" 2&gt;&amp;1
fi
----

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;screenUnlockMode&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:284"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Login to Other User's Active and Locked Sessions</title>
          <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.
            
            RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000090</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95328-1</ident>
          <fixtext>[source,bash]
----
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver 2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "$SS_RULE" == *psso* ]]; then
    /usr/bin/security -q authorizationdb read psso-screensaver &gt; "/tmp/psso-screensaver-mscp.plist"
    /usr/bin/sed -i.bak 's/&lt;string&gt;authenticate-session-owner-or-admin&lt;\/string&gt;/&lt;string&gt;authenticate-session-owner&lt;\/string&gt;/' /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write psso-screensaver-mscp &lt; /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write system.login.screensaver psso-screensaver-mscp 2&gt;&amp;1
else
    /usr/bin/security -q authorizationdb write system.login.screensaver "authenticate-session-owner" 2&gt;&amp;1
fi
----

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;screenUnlockMode&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:285"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Login to Other User's Active and Locked Sessions</title>
          <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.
            
            RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000090</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95328-1</ident>
          <fixtext>[source,bash]
----
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver 2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "$SS_RULE" == *psso* ]]; then
    /usr/bin/security -q authorizationdb read psso-screensaver &gt; "/tmp/psso-screensaver-mscp.plist"
    /usr/bin/sed -i.bak 's/&lt;string&gt;authenticate-session-owner-or-admin&lt;\/string&gt;/&lt;string&gt;authenticate-session-owner&lt;\/string&gt;/' /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write psso-screensaver-mscp &lt; /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write system.login.screensaver psso-screensaver-mscp 2&gt;&amp;1
else
    /usr/bin/security -q authorizationdb write system.login.screensaver "authenticate-session-owner" 2&gt;&amp;1
fi
----

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;screenUnlockMode&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:286"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_unlock_active_user_session_disable_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Login to Other User's Active and Locked Sessions</title>
          <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.
            
            RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT
            
            
Result: {'string': 'PASS'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-2, IA-2(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000090</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95328-1</ident>
          <fixtext>[source,bash]
----
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver 2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "$SS_RULE" == *psso* ]]; then
    /usr/bin/security -q authorizationdb read psso-screensaver &gt; "/tmp/psso-screensaver-mscp.plist"
    /usr/bin/sed -i.bak 's/&lt;string&gt;authenticate-session-owner-or-admin&lt;\/string&gt;/&lt;string&gt;authenticate-session-owner&lt;\/string&gt;/' /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write psso-screensaver-mscp &lt; /tmp/psso-screensaver-mscp.plist
    /usr/bin/security -q authorizationdb write system.login.screensaver psso-screensaver-mscp 2&gt;&amp;1
else
    /usr/bin/security -q authorizationdb write system.login.screensaver "authenticate-session-owner" 2&gt;&amp;1
fi
----

Create a configuration profile containing the following keys in the (com.apple.loginwindow) payload type:

[source,xml]
----
&lt;key&gt;screenUnlockMode&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:287"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_protect_dos_attacks_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Protect Against Denial of Service Attacks by Ensuring Rate-Limiting Measures on Network Interfaces</title>
          <description>The macOS should be configured to prevent Denial of Service (DoS) attacks by enforcing rate-limiting measures on network interfaces.

DoS attacks leave authorized users unable to access information systems, devices, or other network resources due to the actions of a malicious cyber threat actor. When this occurs, the organization must operate at degraded capacity; often resulting in an inability to accomplish its mission.

To prevent DoS attacks by ensuring rate-limiting measures on network interfaces, many operating systems can be integrated with enterprise-level firewalls and networking equipment that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-5</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95269-7</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudo Timeout Period to 0</title>
          <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"
            
            
Result: {'integer': 1}</description>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95317-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \;
/bin/echo "Defaults timestamp_timeout=0" &gt;&gt; /etc/sudoers.d/mscp
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:289"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudo Timeout Period to 0</title>
          <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"
            
            
Result: {'integer': 1}</description>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95317-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \;
/bin/echo "Defaults timestamp_timeout=0" &gt;&gt; /etc/sudoers.d/mscp
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:290"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudo Timeout Period to 0</title>
          <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"
            
            
Result: {'integer': 1}</description>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95317-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \;
/bin/echo "Defaults timestamp_timeout=0" &gt;&gt; /etc/sudoers.d/mscp
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:291"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sudo_timeout_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Sudo Timeout Period to 0</title>
          <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.
            
            /usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep -c "Authentication timestamp timeout: 0.0 minutes"
            
            
Result: {'integer': 1}</description>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95317-4</ident>
          <fixtext>[source,bash]
----
/usr/bin/find /etc/sudoers* -type f -exec sed -i '' '/timestamp_timeout/d' '{}' \;
/bin/echo "Defaults timestamp_timeout=0" &gt;&gt; /etc/sudoers.d/mscp
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:292"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_siri_prompt_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Siri Setup during Setup Assistant</title>
          <description>The prompt for Siri during Setup Assistant _MUST_ be disabled.

Organizations _MUST_ apply organization-wide configuration settings. The macOS Siri Assistant Setup prompt guides new users through enabling their own specific Siri settings; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing Siri settings with the potential to override organization-wide settings.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Siri")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002039</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95299-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;Siri&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:293"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_appleid_prompt_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple ID Setup during Setup Assistant</title>
          <description>The prompt for Apple ID setup during Setup Assistant _MUST_ be disabled.

macOS will automatically prompt new users to set up an Apple ID while they are going through Setup Assistant if this is not disabled, misleading new users to think they need to create Apple ID accounts upon their first login.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("AppleID")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002035</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95159-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;AppleID&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:294"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_error_message_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Generate Error Messages without Exploitable Information</title>
          <description>The information system _IS_ configured to generate error messages that provide the information necessary for corrective actions without revealing information that could be exploited by adversaries.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95186-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_pii_quality_control_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Personally Identifiable Information Quality Operations</title>
          <description>Check the accuracy, relevance, timeliness, and completeness of personally identifiable information across the information life cycle organization-defined frequency; and correct or delete inaccurate or outdated personally identifiable information.

Personally identifiable information quality operations include the steps that organizations take to confirm the accuracy and relevance of personally identifiable information throughout the information life cycle. The information life cycle includes the creation, collection, use, processing, storage, maintenance, dissemination, disclosure, and disposal of personally identifiable information. Personally identifiable information quality operations include editing and validating addresses as they are collected or entered into systems using automated address verification look-up application programming interfaces. Checking personally identifiable information quality includes the tracking of updates or changes to data over time, which enables organizations to know how and what personally identifiable information was changed should erroneous information be identified. The measures taken to protect personally identifiable information quality are based on the nature and context of the personally identifiable information, how it is to be used, how it was obtained, and the potential de-identification methods employed. The measures taken to validate the accuracy of personally identifiable information used to make determinations about the rights, benefits, or privileges of individuals covered under federal programs may be more comprehensive than the measures used to validate personally identifiable information used for less sensitive purposes.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-18</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95256-4</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_directory_services_configured_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Integrate System into a Directory Services Infrastructure</title>
          <description>The macOS system _MUST_ be integrated into a directory services infrastructure.

A directory service infrastructure enables centralized user and rights management, as well as centralized control over computer and user configurations. Integrating the macOS systems used throughout an organization into a directory services infrastructure ensures more administrator oversight and security than allowing distinct user account databases to exist on each separate system.
            
            /usr/bin/dscl localhost -list . | /usr/bin/grep -qvE '(Contact|Search|Local|^$)'; /bin/echo $?
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95181-4</ident>
          <fixtext>Integrate the system into an existing directory services infrastructure.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:297"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_show_status_bar_enabled_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Show Safari shows the Status Bar is Enabled</title>
          <description>Safari _MUST_ be configured to show the status bar.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -c 'ShowOverlayStatusBar = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.10 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95288-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;ShowOverlayStatusBar&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:298"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_crypto_audit_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Protect Audit Integrity with Cryptographic Mechanisms</title>
          <description>The information system _IS_ configured to implement cryptographic mechanisms to protect the integrity of audit information and audit tools.

The Apple T2 Security Chip includes a dedicated Advanced Encryption Standard (AES) crypto engine built into the direct memory access (DMA) path between the flash storage and main system memory, which powers line-speed encrypted storage with FileVault and makes internal volume highly efficient.

link:https://www.apple.com/euro/mac/shared/docs/Apple_T2_Security_Chip_Overview.pdf[]

NOTE: This will only apply to a Mac that includes a T2 security chip.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-9(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-9(3)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95179-8</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_skip_unlock_with_watch_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Unlock with Apple Watch During Setup Assistant</title>
          <description>The prompt for Apple Watch unlock setup during Setup Assistant _MUST_ be disabled.

Disabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using an authorized identification and authentication procedures.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("WatchMigration")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005056</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95301-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;WatchMigration&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:300"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_reader_summary_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Apple Intelligence Safari Reader Summary</title>
          <description>Apple Intelligence features such as Safari Reader Summary that use off device AI _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariSummary').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95286-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowSafariSummary&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:301"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_reauth_privilege_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require users to reauthenticate for privilege escalation</title>
          <description>Without reauthentication, users may access resources or perform tasks for which they do not have authorization. When operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.01</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95275-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_system_wide_applications_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Appropriate Permissions Are Enabled for System Wide Applications</title>
          <description>Applications in the System Applications Directory (/Applications) _MUST_ not be world-writable.
            
            /usr/bin/find /Applications -iname "*\.app" -type d -perm -2 -ls | /usr/bin/wc -l | /usr/bin/xargs
            
            
Result: {'integer': 0}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.5 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95320-8</ident>
          <fixtext>[source,bash]
----
IFS=$'\n'
for apps in $( /usr/bin/find /Applications -iname "*\.app" -type d -perm -2 ); do
  /bin/chmod -R o-w "$apps"
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:303"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_certificate_authority_trust_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Issue or Obtain Public Key Certificates from an Approved Service Provider</title>
          <description>The organization _MUST_ issue or obtain public key certificates from an organization-approved service provider and ensure only approved trust anchors are in the System Keychain.
            
            /usr/bin/security dump-keychain /Library/Keychains/System.keychain | /usr/bin/awk -F'"' '/labl/ {print $4}'
            
            
Result: {'string': 'a list containing approved root certificates'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-17</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-17</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003001</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95174-9</ident>
          <fixtext>Obtain the approved certificates from the appropriate authority and install them to the System Keychain.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_software_update_deferral_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
          <description>Software updates _MUST_ be deferred for 30 days or less.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95303-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;enforcedSoftwareUpdateDelay&lt;/key&gt;
&lt;string&gt;30&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:305"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_software_update_deferral_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
          <description>Software updates _MUST_ be deferred for 30 days or less.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95303-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;enforcedSoftwareUpdateDelay&lt;/key&gt;
&lt;string&gt;30&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:306"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_software_update_deferral_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
          <description>Software updates _MUST_ be deferred for 30 days or less.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 1.6 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 7.3, 7.4</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95303-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;enforcedSoftwareUpdateDelay&lt;/key&gt;
&lt;string&gt;30&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:307"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_newsyslog_files_permissions_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure System Log Files to Mode 640 or Less Permissive</title>
          <description>The system logs _MUST_ be configured to be writable by root and readable only by the root user and group wheel. To achieve this, system log files _MUST_ be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.
            
            /usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2&gt; /dev/null | /usr/bin/awk '!/640/{print $1}' | /usr/bin/wc -l | /usr/bin/tr -d ' '
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SI-11</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SI-11</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004040</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95234-1</ident>
          <fixtext>[source,bash]
----
/bin/chmod 640 $(/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf | /usr/bin/awk '{ print $1 }') 2&gt; /dev/null | /usr/bin/awk '!/640/{print $1}' | awk -F":" '!/640/{print $2}')
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:308"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_home_folders_secure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Secure User's Home Folders</title>
          <description>The system _MUST_ be configured to prevent access to other user's home folders.

The default behavior of macOS is to allow all valid users access to the top level of every other user's home folder while restricting access only to the Apple default folders within.
            
            /usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm 700 -o -perm 711 \) | /usr/bin/grep -v "Shared" | /usr/bin/grep -v "Guest" | /usr/bin/wc -l | /usr/bin/xargs
            
            
Result: {'integer': 0}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-6</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.05</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002068</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.1.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 3.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95203-6</ident>
          <fixtext>[source,bash]
----
IFS=$'\n'
for userDirs in $( /usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm 700 -o -perm 711 \) | /usr/bin/grep -v "Shared" | /usr/bin/grep -v "Guest" ); do
  /bin/chmod og-rwx "$userDirs"
done
unset IFS
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:309"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_bluray_read_only_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce Blu Ray Read Only</title>
          <description>Blu Ray media _MUST_ be set to read only.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["bd"]
EOS
            
            
Result: {'string': 'read-only'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95168-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;read-only&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:310"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_facetime_app_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable FaceTime.app</title>
          <description>The macOS built-in FaceTime.app _MUST_ be disabled.

The FaceTime.app establishes a connection to Apple's iCloud service, even when security controls have been put in place to disable iCloud access.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/FaceTime.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002010</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95189-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;pathBlackList&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;/Applications/FaceTime.app&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:311"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_camera_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Camera</title>
          <description>It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Failing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants carry out the disconnect activity without having to go through complex and tedious procedures.

This requirement is not applicable to mobile devices (smartphones and tablets), where the use of the camera is a local AO decision.

This requirement is not applicable to dedicated VTC suites located in approved VTC locations that are centrally managed.

For an external camera, if there is not a method for the operator to manually disconnect camera at the end of collaborative computing sessions, this is a finding.

For a built-in camera, the camera must be protected by a camera cover (e.g., laptop camera cover slide) when not in use. If the built-in camera is not protected with a camera cover, or is not physically disabled, this is a finding.

If the camera is not disconnected, covered, or physically disabled, the following configuration is required.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCamera').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002017</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95172-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCamera&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:312"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_on_device_dictation_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce On Device Dictation</title>
          <description>Dictation _MUST_ be restricted to on device only to prevent potential data exfiltration.

The information system _MUST_ be configured to provide only essential capabilities.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('forceOnDeviceOnlyDictation').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002220</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.18.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95247-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;forceOnDeviceOnlyDictation&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:313"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_external_storage_access_defined_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Access to External Storage Must Be Defined</title>
          <description>Access to external storage _MUST_ be managed. 

NOTE: Apple's built in method using declative device management method only allows you to set external storage manament to Allowed, ReadOnly, and Disallowed.
            
            /usr/bin/plutil -convert json /var/db/ManagedConfigurationFiles/DiskManagement/DiskManagement_Settings.plist -o - | /usr/bin/jq --raw-output '.Restrictions.ExternalStorage'
            
            
Result: {'string': 'Allowed'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95188-9</ident>
          <fixtext>This is implemented by Declarative Device Management (DDM).

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:314"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Install.log Retention to 365</title>
          <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.
            
            /usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'
            
            
Result: {'string': 'Yes'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95211-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i '' "s/\* file \/var\/log\/install.log.*/\* file \/var\/log\/install.log format='\$\(\(Time\)\(JZ\)\) \$Host \$\(Sender\)\[\$\(PID\\)\]: \$Message' rotate=utc compress file_max=50M size_only ttl=365/g" /etc/asl/com.apple.install
----

NOTE: If there are multiple configuration files in /etc/asl that are set to process the file /var/log/install.log, these files will have to be manually removed.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:315"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Install.log Retention to 365</title>
          <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.
            
            /usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'
            
            
Result: {'string': 'Yes'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95211-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i '' "s/\* file \/var\/log\/install.log.*/\* file \/var\/log\/install.log format='\$\(\(Time\)\(JZ\)\) \$Host \$\(Sender\)\[\$\(PID\\)\]: \$Message' rotate=utc compress file_max=50M size_only ttl=365/g" /etc/asl/com.apple.install
----

NOTE: If there are multiple configuration files in /etc/asl that are set to process the file /var/log/install.log, these files will have to be manually removed.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:316"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Install.log Retention to 365</title>
          <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.
            
            /usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'
            
            
Result: {'string': 'Yes'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95211-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i '' "s/\* file \/var\/log\/install.log.*/\* file \/var\/log\/install.log format='\$\(\(Time\)\(JZ\)\) \$Host \$\(Sender\)\[\$\(PID\\)\]: \$Message' rotate=utc compress file_max=50M size_only ttl=365/g" /etc/asl/com.apple.install
----

NOTE: If there are multiple configuration files in /etc/asl that are set to process the file /var/log/install.log, these files will have to be manually removed.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:317"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_install_log_retention_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure Install.log Retention to 365</title>
          <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.
            
            /usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'
            
            
Result: {'string': 'Yes'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AU-11, AU-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.03.03</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-004050</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 3.3 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 8.1, 8.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95211-9</ident>
          <fixtext>[source,bash]
----
/usr/bin/sed -i '' "s/\* file \/var\/log\/install.log.*/\* file \/var\/log\/install.log format='\$\(\(Time\)\(JZ\)\) \$Host \$\(Sender\)\[\$\(PID\\)\]: \$Message' rotate=utc compress file_max=50M size_only ttl=365/g" /etc/asl/com.apple.install
----

NOTE: If there are multiple configuration files in /etc/asl that are set to process the file /var/log/install.log, these files will have to be manually removed.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:318"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_icloud_storage_prompt_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Storage Setup during Setup Assistant</title>
          <description>The prompt to set up iCloud storage services during Setup Assistant _MUST_ be disabled.

The default behavior of macOS is to prompt new users to set up storage in iCloud. Disabling the iCloud storage setup prompt provides organizations more control over the storage of their data.
            
            /usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("iCloudStorage")
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002037</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95205-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.SetupAssistant.managed) payload type:

[source,xml]
----
&lt;key&gt;SkipSetupItems&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;iCloudStorage&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:319"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_erase_content_and_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Erase Content and Settings</title>
          <description>Erase Content and Settings _MUST_ be disabled.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowEraseContentAndSettings').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-005061</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95185-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowEraseContentAndSettings&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:320"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_ir_support_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Infrared (IR) support</title>
          <description>Infrared (IR) support _MUST_ be disabled to prevent users from controlling the system with IR devices.

By default, if IR is enabled, the system will accept IR control from any remote device.

NOTE: This is applicable only to models of Mac Mini systems earlier than Mac Mini8,1.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.driver.AppleIRController')\
.objectForKey('DeviceEnabled').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-18, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-18</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.16, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 12.6</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95213-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

NOTE: The following settings are in the (com.apple.ManagedClient.preferences) payload. This payload requires the additional settings to be sub-payloads within, containing their defined payload types.

Create a configuration profile containing the following keys in the (com.apple.driver.AppleIRController) payload type:

[source,xml]
----
&lt;key&gt;DeviceEnabled&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:321"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_cd_read_only_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Enforce CD Read Only</title>
          <description>CD media _MUST_ be set to read only.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["cd"]
EOS
            
            
Result: {'string': 'read-only'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: MP-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: MP-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.08.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95173-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systemuiserver) payload type:

[source,xml]
----
&lt;key&gt;mount-controls&lt;/key&gt;
&lt;dict&gt;
    &lt;array&gt;
        &lt;string&gt;read-only&lt;/string&gt;
    &lt;/array&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:322"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD Channel Timeout to session:*=900</title>
          <description>If SSHD is enabled it _MUST_ be configured with session ChannelTime out set to session:*=900.

This will set the time out when the session is inactive.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/channeltimeout/{print $2}'
            
            
Result: {'string': 'session:*=900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000120</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95307-5</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'channeltimeout session:*=900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "channeltimeout session:*=900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:323"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_sshd_channel_timeout_configure_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure SSHD Channel Timeout to session:*=900</title>
          <description>If SSHD is enabled it _MUST_ be configured with session ChannelTime out set to session:*=900.

This will set the time out when the session is inactive.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.
            
            /usr/sbin/sshd -G | /usr/bin/awk '/channeltimeout/{print $2}'
            
            
Result: {'string': 'session:*=900'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: SC-10, AC-12</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: SC-10</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.11, 03.13.09</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000120</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95307-5</ident>
          <fixtext>[source,bash]
----
include_dir=$(/usr/bin/awk '/^Include/ {print $2}' /etc/ssh/sshd_config | /usr/bin/tr -d '*')

if [[ -z $include_dir ]]; then
  /usr/bin/sed -i.bk "1s/.*/Include \/etc\/ssh\/sshd_config.d\/\*/" /etc/ssh/sshd_config
fi

/usr/bin/grep -qxF 'channeltimeout session:*=900' "${include_dir}01-mscp-sshd.conf" 2&gt;/dev/null || echo "channeltimeout session:*=900" &gt;&gt; "${include_dir}01-mscp-sshd.conf"

for file in $(ls ${include_dir}); do
  if [[ "$file" == "100-macos.conf" ]]; then
      continue
  fi
  if [[ "$file" == "01-mscp-sshd.conf" ]]; then
      break
  fi
  /bin/mv ${include_dir}${file} ${include_dir}20-${file}
done
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:324"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_safari_prevent_cross-site_tracking_enable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Ensure Prevent Cross-site Tracking in Safari Is Enabled</title>
          <description>Prevent cross-site tracking _MUST_ be enabled in Safari.
            
            /usr/bin/profiles -P -o stdout | /usr/bin/grep -cE '"WebKitPreferences.storageBlockingPolicy" = 1|"WebKitStorageBlockingPolicy" = 1|"BlockStoragePolicy" =2' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'
            
            
Result: {'integer': 1}</description>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 6.3.4 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 9.1, 9.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95285-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.Safari) payload type:

[source,xml]
----
&lt;key&gt;WebKitPreferences.storageBlockingPolicy&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
&lt;key&gt;WebKitStorageBlockingPolicy&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
&lt;key&gt;BlockStoragePolicy&lt;/key&gt;
&lt;integer&gt;2&lt;/integer&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:325"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_mail_app_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Mail App</title>
          <description>The macOS built-in Mail.app _MUST_ be disabled.

The Mail.app contains functionality that can establish connections to Apple's iCloud, even when security controls to disable iCloud access have been put in place.

[IMPORTANT]
====
Some organizations allow the use of the built-in Mail.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Mail.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Mail.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95221-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;pathBlackList&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;/Applications/Mail.app&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:326"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_non_repudiation_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Non-Repudiation</title>
          <description>Provide irrefutable evidence that an individual (or process acting on behalf of an individual) has performed organization-defined actions to be covered by non-repudiation.

Types of individual actions covered by non-repudiation include creating information, sending and receiving messages, and approving information. Non-repudiation protects against claims by authors of not having authored certain documents, senders of not having transmitted messages, receivers of not having received messages, and signatories of not having signed documents. Non-repudiation services can be used to determine if information originated from an individual or if an individual took specific actions (e.g., sending an email, signing a contract, approving a procurement request, or receiving specific information). Organizations obtain non-repudiation services by employing various techniques or mechanisms, including digital signatures and digital message receipts.
            
            This requirement is NA for this technology.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AU-10</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95236-6</ident>
          <fixtext>The requirement is NA. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_notify_unauthorized_baseline_change_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Configure the System to Notify upon Baseline Configuration Changes</title>
          <description>The macOS should be configured to automatically notify system administrators, Information System Security Officers (ISSOs), and (IMOs) when baseline configurations are modified.

Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may  present security threats. Detecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the state of the operating system.

To enable notifications and audit logging of changes made to baseline configurations, many operating systems can be integrated with enterprise-level auditing mechanisms that meet or exceed this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-3(5)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-3(5)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95245-7</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_bonjour_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Bonjour Multicast</title>
          <description>Bonjour multicast advertising _MUST_ be disabled to prevent the system from broadcasting its presence and available services over network interfaces.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.mDNSResponder')\
.objectForKey('NoMulticastAdvertisements').js
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002005</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 4.1 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95169-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mDNSResponder) payload type:

[source,xml]
----
&lt;key&gt;NoMulticastAdvertisements&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:329"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_os_calendar_app_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Calendar.app</title>
          <description>The macOS built-in Calendar.app _MUST_ be disabled as this application can establish a connection to non-approved services. This rule is in place to prevent inadvertent data transfers.

[IMPORTANT]
====
Some organizations allow the use of the built-in Calendar.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Calendar.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Calendar.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95171-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess.new) payload type:

[source,xml]
----
&lt;key&gt;familyControlsEnabled&lt;/key&gt;
&lt;true/&gt;
&lt;key&gt;pathBlackList&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;/Applications/Calendar.app&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:330"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Accounts after 35 Days of Inactivity</title>
          <description>The macOS _MUST_ be configured to disable accounts after 35 days of inactivity.

This rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeInactiveDays"]/following-sibling::integer[1]/text()' -
            
            
Result: {'integer': '35'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003080</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95336-4</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to disable an inactive user after 35 days, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryAuthentication":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributeLastAuthenticationTime &amp;gt; policyAttributeCurrentTime - (policyAttributeInactiveDays * 24 * 60 * 60)&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Inactive Account&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;policyAttributeInactiveDays&lt;/key&gt;
&lt;integer&gt;35&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:331"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_inactivity_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable Accounts after 35 Days of Inactivity</title>
          <description>The macOS _MUST_ be configured to disable accounts after 35 days of inactivity.

This rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeInactiveDays"]/following-sibling::integer[1]/text()' -
            
            
Result: {'integer': '35'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(3)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-4</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.01</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003080</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95336-4</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to disable an inactive user after 35 days, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryAuthentication":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributeLastAuthenticationTime &amp;gt; policyAttributeCurrentTime - (policyAttributeInactiveDays * 24 * 60 * 60)&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Inactive Account&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;policyAttributeInactiveDays&lt;/key&gt;
&lt;integer&gt;35&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:332"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords to Match the Defined Custom Regular Expression</title>
          <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.6 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95340-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;customRegex&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;passwordContentRegex&lt;/key&gt;
    &lt;string&gt;^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$&lt;/string&gt;
    &lt;key&gt;passwordContentDescription&lt;/key&gt;
    &lt;dict&gt;
      &lt;key&gt;default&lt;/key&gt;
      &lt;string&gt;Password must match custom regex.&lt;/string&gt;
    &lt;/dict&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:333"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords to Match the Defined Custom Regular Expression</title>
          <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.6 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95340-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;customRegex&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;passwordContentRegex&lt;/key&gt;
    &lt;string&gt;^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$&lt;/string&gt;
    &lt;key&gt;passwordContentDescription&lt;/key&gt;
    &lt;dict&gt;
      &lt;key&gt;default&lt;/key&gt;
      &lt;string&gt;Password must match custom regex.&lt;/string&gt;
    &lt;/dict&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:334"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_custom_regex_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords to Match the Defined Custom Regular Expression</title>
          <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -
            
            
Result: {'string': 'true'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.6 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95340-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;customRegex&lt;/key&gt;
&lt;dict&gt;
    &lt;key&gt;passwordContentRegex&lt;/key&gt;
    &lt;string&gt;^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$&lt;/string&gt;
    &lt;key&gt;passwordContentDescription&lt;/key&gt;
    &lt;dict&gt;
      &lt;key&gt;default&lt;/key&gt;
      &lt;string&gt;Password must match custom regex.&lt;/string&gt;
    &lt;/dict&gt;
&lt;/dict&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:335"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_50_percent_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require a Minimum of Fifty Percent Character Change in New Passwords</title>
          <description>The macOS should be configured to require users to change at least 50% of the characters when setting a new password.

If the operating system allows users to consecutively reuse extensive portions of passwords, this increases the window of opportunity for a malicious user to guess the password. The number of changed characters refers to the number of changes required with respect to the total number of positions in the current password. In other words, characters may be the same within the two passwords; however, the positions of the like characters must be different.

To enforce a 50% character change when new passwords are created, many operating systems can be integrated with an enterprise-level directory service that meets or exceeds this requirement.
            
            The technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)(b), IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95335-6</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Restrict Maximum Password Lifetime to 60 Days</title>
          <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 60 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 60 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003008</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95345-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxPINAgeInDays&lt;/key&gt;
&lt;string&gt;60&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:337"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Restrict Maximum Password Lifetime to 365 Days</title>
          <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 365 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 365 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003008</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95345-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxPINAgeInDays&lt;/key&gt;
&lt;string&gt;365&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:338"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Restrict Maximum Password Lifetime to 365 Days</title>
          <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 365 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 365 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003008</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95345-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxPINAgeInDays&lt;/key&gt;
&lt;string&gt;365&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:339"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_max_lifetime_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Restrict Maximum Password Lifetime to 60 Days</title>
          <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 60 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 60 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003008</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.7 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95345-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxPINAgeInDays&lt;/key&gt;
&lt;string&gt;60&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:340"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Password Reuse for a Minimum of 5 Generations</title>
          <description>The macOS _MUST_ be configured to enforce a password history of at least 5 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 5 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 5 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.8 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95343-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;pinHistory&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:341"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Password Reuse for a Minimum of 15 Generations</title>
          <description>The macOS _MUST_ be configured to enforce a password history of at least 15 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 15 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.8 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95343-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;pinHistory&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:342"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Password Reuse for a Minimum of 15 Generations</title>
          <description>The macOS _MUST_ be configured to enforce a password history of at least 15 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 15 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.8 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95343-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;pinHistory&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:343"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_history_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Password Reuse for a Minimum of 5 Generations</title>
          <description>The macOS _MUST_ be configured to enforce a password history of at least 5 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 5 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 5 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.8 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95343-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;pinHistory&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:344"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_accounts_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Automatically Remove or Disable Temporary User Accounts within 72 Hours</title>
          <description>The macOS is able to be configured to set an automated termination for 72 hours or less for all temporary accounts upon account creation.

If temporary user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary accounts _MUST_ be set to 72 hours (or less) when the temporary account is created.

If no policy is enforced by a directory service, a password policy can be set with the "pwpolicy" utility. The variable names may vary depending on how the policy was set.

If there are no temporary accounts defined on the system, this is Not Applicable.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95351-3</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_temporary_or_emergency_accounts_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Automatically Remove or Disable Temporary or Emergency User Accounts within 72 Hours</title>
          <description>The macOS is able to be configured to set an automated termination for 72 hours or less for all temporary or emergency accounts upon account creation.

Emergency administrator accounts are privileged accounts established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.

Although the ability to create and use emergency administrator accounts is necessary for performing system maintenance during emergencies, these accounts present vulnerabilities to the system if they are not disabled and removed when they are no longer needed. Configuring the macOS to automatically remove or disable emergency accounts within 72 hours of creation mitigates the risks posed if one were to be created and accidentally left active once the crisis is resolved.

Emergency administrator accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account created for use by vendors or system maintainers.

To address access requirements, many operating systems can be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.

If temporary or emergency user accounts remain active when no longer needed or for an excessive period, these accounts may be targeted by attackers to gain unauthorized access. To mitigate this risk, automated termination of all temporary or emergency accounts _MUST_ be set to 72 hours (or less) when the temporary or emergency account is created.

If no policy is enforced by a directory service, a password policy can be set with the "pwpolicy" utility. The variable names may vary depending on how the policy was set.

If there are no temporary or emergency accounts defined on the system, this is Not Applicable.
            
            Verify if a password policy is enforced by a directory service by asking the System Administrator (SA) or Information System Security Officer (ISSO).

If no policy is enforced by a directory service, a password policy can be set with the "pwpolicy" utility. The variable names may vary depending on how the policy was set.

If there are no temporary or emergency accounts defined on the system, this is Not Applicable.

To check if the password policy is configured to disable a temporary or emergency account after 72 hours, run the following command to output the password policy to the screen, substituting the correct user name in place of username:

/usr/bin/pwpolicy -u username getaccountpolicies | tail -n +2

If there is no output, and password policy is not controlled by a directory service, this is a finding.

Otherwise, look for the line "&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;".

In the array that follows, there should be a &lt;dict&gt; section that contains a check &lt;string&gt; that allows users to log in if "policyAttributeCurrentTime" is less than the result of adding "policyAttributeCreationTime" to 72 hours (259299 seconds). The check might use a variable defined in its "policyParameters" section.

If the check does not exist or if the check adds too great an amount of time to "policyAttributeCreationTime", this is a finding.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(2)</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000012</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95352-1</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to disable a temporary or emergency user, create a plain text file containing the following:

&lt;dict&gt;
&lt;key&gt;policyCategoryAuthentication&lt;/key&gt;
&lt;array&gt;
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributeCurrentTime &amp;lt; policyAttributeCreationTime+259299&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Disable Tmp Accounts &lt;/string&gt;
&lt;/dict&gt;
&lt;/array&gt;
&lt;/dict&gt;

After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the correct user name in place of "username" and the path to the file in place of "/path/to/file".

/usr/bin/pwpolicy -u username setaccountpolicies /path/to/file

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Consecutive Failed Login Attempts to 3</title>
          <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 3. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 3) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95337-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxFailedAttempts&lt;/key&gt;
&lt;string&gt;3&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:347"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Consecutive Failed Login Attempts to 5</title>
          <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 5. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 5) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95337-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxFailedAttempts&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:348"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Consecutive Failed Login Attempts to 5</title>
          <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 5. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 5) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95337-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxFailedAttempts&lt;/key&gt;
&lt;string&gt;5&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:349"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Limit Consecutive Failed Login Attempts to 3</title>
          <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 3. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 3) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000022</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95337-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;maxFailedAttempts&lt;/key&gt;
&lt;string&gt;3&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:350"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_simple_sequence_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prohibit Repeating, Ascending, and Descending Character Sequences</title>
          <description>The macOS _MUST_ be configured to prohibit the use of repeating, ascending, and descending character sequences when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: pwpolicy_simple_sequence_disable prevents use of passwords which are regularly found in compromised password lists.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyIdentifier"]/following-sibling::*[1]/text()' - | /usr/bin/grep "allowSimple" -c
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95349-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;allowSimple&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:351"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_force_password_change_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Force Password Change at Next Logon</title>
          <description>The macOS is able to be configured to force users to change their password at next logon.

Temporary passwords are often used for new users when accounts are created. However, once logged in to the system, users must be immediately prompted to change to a permanent password of their creation.

For a user to change their password at next logon, run the following command:
[source,bash]
----
/usr/bin/pwpolicy -u [USER] -setpolicy "newPasswordRequired=1"
----
NOTE: Replace [USER] with the username that must change the password at next logon
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95342-2</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_lower_case_character_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Lowercase Character</title>
          <description>The macOS _MUST_ be configured to require at least one lower-case character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: macOS 14 supports password policy complexity with custom regex deployed with a mobileconfig file. To use a mobileconfig file use *pwpolicy_custom_regex_enforce*.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="minimumAlphaCharactersLowerCase"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 1 ) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95344-8</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to require at least 1 lowercase letter, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryPasswordContent":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributePassword matches &amp;apos;(.*[a-z].*){1,}+&amp;apos;&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Must have at least 1 lowercase letter&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;minimumAlphaCharactersLowerCase&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:353"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_emergency_accounts_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Automatically Remove or Disable Emergency Accounts within 72 Hours</title>
          <description>The macOS is able to be configured to automatically remove or disable emergency accounts within 72 hours or less.

Emergency administrator accounts are privileged accounts established in response to crisis situations where the need for rapid account activation is required. Therefore, emergency account activation may bypass normal account authorization processes. If these accounts are disabled, system maintenance during emergencies may not be possible, thus adversely affecting system availability.

Although the ability to create and use emergency administrator accounts is necessary for performing system maintenance during emergencies, these accounts present vulnerabilities to the system if they are not disabled and removed when they are no longer needed. Configuring the macOS to automatically remove or disable emergency accounts within 72 hours of creation mitigates the risks posed if one were to be created and accidentally left active once the crisis is resolved.

Emergency administrator accounts are different from infrequently used accounts (i.e., local logon accounts used by system administrators when network or normal logon is not available). Infrequently used accounts also remain available and are not subject to automatic termination dates. However, an emergency administrator account is normally a different account created for use by vendors or system maintainers.

To address access requirements, many operating systems can be integrated with enterprise-level authentication/access mechanisms that meet or exceed access control policy requirements.
            
            The technology supports this requirement and cannot be configured to be out of compliance. The technology inherently meets this requirement.
            
            </description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-2(2)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-2(2)</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95341-4</ident>
          <fixtext>The technology inherently meets this requirement. No fix is required.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Account Lockout Time to 15 Minutes</title>
          <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95338-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minutesUntilFailedLoginReset&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:355"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Account Lockout Time to 15 Minutes</title>
          <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95338-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minutesUntilFailedLoginReset&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:356"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Account Lockout Time to 15 Minutes</title>
          <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95338-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minutesUntilFailedLoginReset&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:357"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_account_lockout_timeout_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Account Lockout Time to 15 Minutes</title>
          <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: AC-7</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.08</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-000060</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.1 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 6.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95338-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minutesUntilFailedLoginReset&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:358"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Special Character</title>
          <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003011</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.5 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95350-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minComplexChars&lt;/key&gt;
&lt;string&gt;1&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:359"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Special Character</title>
          <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003011</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.5 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95350-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minComplexChars&lt;/key&gt;
&lt;string&gt;1&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:360"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_special_character_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Special Character</title>
          <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003011</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.5 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95350-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minComplexChars&lt;/key&gt;
&lt;string&gt;1&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:361"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_alpha_numeric_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Numeric Character</title>
          <description>The macOS _MUST_ be configured to require at least one numeric character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyIdentifier"]/following-sibling::*[1]/text()' - | /usr/bin/grep "requireAlphanumeric" -c
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003007</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.3 (level 2), 5.2.4 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95339-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;requireAlphanumeric&lt;/key&gt;
&lt;true/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:362"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require a Minimum Password Length of 15 Characters</title>
          <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003010</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95346-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minLength&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:363"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_cis_lvl1" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require a Minimum Password Length of 15 Characters</title>
          <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003010</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95346-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minLength&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:364"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_cis_lvl2" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require a Minimum Password Length of 15 Characters</title>
          <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003010</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95346-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minLength&lt;/key&gt;
&lt;string&gt;15&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:365"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_length_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require a Minimum Password Length of 14 Characters</title>
          <description>The macOS _MUST_ be configured to require a minimum of 14 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=14 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003010</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 5.2.2 (level 1)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95346-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.mobiledevice.passwordpolicy) payload type:

[source,xml]
----
&lt;key&gt;minLength&lt;/key&gt;
&lt;string&gt;14&lt;/string&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:366"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_upper_case_character_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Require Passwords Contain a Minimum of One Uppercase Character</title>
          <description>The macOS _MUST_ be configured to require at least one uppercase character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: macOS 14 supports password policy complexity with custom regex deployed with a mobileconfig file. To use a mobileconfig file use *pwpolicy_custom_regex_enforce*.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="minimumAlphaCharactersUpperCase"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 1 ) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5, IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.07</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 5.2</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95353-9</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to require at least 1 lowercase letter, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryPasswordContent":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributePassword matches &amp;apos;(.*[A-Z].*){1,}+&amp;apos;&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Must have at least 1 uppercase letter&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;minimumAlphaCharactersUpperCase&lt;/key&gt;
&lt;integer&gt;1&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:367"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_prevent_dictionary_words_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Prevent the Use of Dictionary Words for Passwords</title>
          <description>The macOS should be configured to forbid users to use dictionary words for passwords.

If the operating system allows users to select passwords based on dictionary words, this increases the window of opportunity for a malicious user to guess the password.

To prevent users from using dictionary words for passwords, many operating systems can be integrated with an enterprise-level directory service that meets or exceeds this requirement.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            For systems not requiring mandatory smart card authentication or those that are not bound to a directory, the technology does not support this requirement. This is an applicable-does not meet finding.
            
            </description>
          <ident system="https://ncp.nist.gov/cce">CCE-95348-9</ident>
          <fixtext>This requirement is a permanent finding and cannot be fixed. An appropriate mitigation for the system must be implemented, but this finding cannot be considered fixed.

</fixtext>
          <check system="http://scap.nist.gov/schema/ocil/2">
            <check-content-ref href="ocil.xml"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Minimum Password Lifetime to 24 Hours</title>
          <description>The macOS _MUST_ be configured to enforce a minimum password lifetime limit of 24 hours.

This rule discourages users from cycling through their previous passwords to get back to a preferred one.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMinimumLifetimeHours"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 24 ) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003070</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95347-1</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to require a minimum password lifetime, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryPasswordContent":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributeLastPasswordChangeTime &amp;lt; policyAttributeCurrentTime - (policyAttributeMinimumLifetimeHours * 60 * 60)&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Minimum Password Lifetime&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;policyAttributeMinimumLifetimeHours&lt;/key&gt;
&lt;integer&gt;24&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:369"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_pwpolicy_minimum_lifetime_enforce_stig" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Set Minimum Password Lifetime to 24 Hours</title>
          <description>The macOS _MUST_ be configured to enforce a minimum password lifetime limit of 24 hours.

This rule discourages users from cycling through their previous passwords to get back to a preferred one.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.
            
            /usr/bin/pwpolicy -getaccountpolicies 2&gt; /dev/null | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMinimumLifetimeHours"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 24 ) {print "pass"} else {print "fail"}}'
            
            
Result: {'string': 'pass'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: IA-5</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: IA-5(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.05.12</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-003070</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.7</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95347-1</ident>
          <fixtext>This setting may be enforced using local policy or by a directory service.

To set local policy to require a minimum password lifetime, edit the current password policy to contain the following &lt;dict&gt; within the "policyCategoryPasswordContent":

[source,xml]
----
&lt;dict&gt;
&lt;key&gt;policyContent&lt;/key&gt;
&lt;string&gt;policyAttributeLastPasswordChangeTime &amp;lt; policyAttributeCurrentTime - (policyAttributeMinimumLifetimeHours * 60 * 60)&lt;/string&gt;
&lt;key&gt;policyIdentifier&lt;/key&gt;
&lt;string&gt;Minimum Password Lifetime&lt;/string&gt;
&lt;key&gt;policyParameters&lt;/key&gt;
&lt;dict&gt;
&lt;key&gt;policyAttributeMinimumLifetimeHours&lt;/key&gt;
&lt;integer&gt;24&lt;/integer&gt;
&lt;/dict&gt;
&lt;/dict&gt;
----
After saving the file and exiting to the command prompt, run the following command to load the new policy file, substituting the path to the file in place of "$pwpolicy_file".

[source,bash]
----
/usr/bin/pwpolicy setaccountpolicies $pwpolicy_file
----
NOTE: See the password policy supplemental on more information on how to implement password policies on macOS.

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:370"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_photos_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Photo Library</title>
          <description>The macOS built-in Photos.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated photo synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudPhotoLibrary').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002043</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95150-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudPhotoLibrary&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:371"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_appleid_system_settings_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the System Setting for Apple ID</title>
          <description>The system setting for Apple ID _MUST_ be disabled.

Disabling the system setting prevents login to Apple ID and iCloud.
            
            /usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep -c "com.apple.systempreferences.AppleIDSettings"
            
            
Result: {'integer': 1}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95141-8</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.systempreferences) payload type:

[source,xml]
----
&lt;key&gt;DisabledSystemSettings&lt;/key&gt;
&lt;array&gt;
    &lt;string&gt;com.apple.systempreferences.AppleIDSettings&lt;/string&gt;
&lt;/array&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:372"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_reminders_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Reminders</title>
          <description>The macOS built-in Reminders.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated reminders synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudReminders').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002013</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95152-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudReminders&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:373"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_freeform_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the iCloud Freeform Services</title>
          <description>The macOS built-in Freeform.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudFreeform').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002270</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95145-9</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudFreeform&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:374"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_sync_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Desktop and Document Folder Sync</title>
          <description>The macOS system's ability to automatically synchronize a user's desktop and documents folder to their iCloud Drive _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated file synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudDesktopAndDocuments').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002150</reference>
          <reference href="https://www.cisecurity.org/cis-benchmarks/">CIS Benchmark: 2.1.1.3 (level 2)</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95153-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudDesktopAndDocuments&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:375"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_game_center_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Game Center</title>
          <description>This works only with supervised devices (MDM) and allows to disable Apple Game Center. The rationale is Game Center is using Apple ID and will shared data on AppleID based services, therefore, Game Center _MUST_ be disabled.
This setting also prohibits functionality of adding friends to Game Center.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowGameCenter').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002160</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95146-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowGameCenter&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:376"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_keychain_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Keychain Sync</title>
          <description>The macOS system's ability to automatically synchronize a user's passwords to their iCloud account _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, password management and synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudKeychainSync').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002040</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95147-5</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudKeychainSync&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:377"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_notes_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Notes</title>
          <description>The macOS built-in Notes.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated Notes synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudNotes').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002016</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95149-1</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudNotes&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:378"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_private_relay_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Private Relay</title>
          <description>Enterprise networks may be required to audit all network traffic by policy, therefore, iCloud Private Relay _MUST_ be disabled.

Network administrators can also prevent the use of this feature by blocking DNS resolution of mask.icloud.com and mask-h2.icloud.com.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudPrivateRelay').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002170</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95151-7</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudPrivateRelay&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:379"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_drive_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Document Sync</title>
          <description>The macOS built-in iCloud document synchronization service _MUST_ be disabled to prevent organizational data from being synchronized to personal or non-approved storage.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated document synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudDocumentSync').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002041</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95144-2</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudDocumentSync&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:380"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_bookmarks_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Bookmarks</title>
          <description>The macOS built-in Safari.app bookmark synchronization via the iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated bookmark synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudBookmarks').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002042</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95142-6</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudBookmarks&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:381"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_mail_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Mail</title>
          <description>The macOS built-in Mail.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated mail synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudMail').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002015</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95148-3</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudMail&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:382"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_calendar_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable the iCloud Calendar Services</title>
          <description>The macOS built-in Calendar.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudCalendar').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002012</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95143-4</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudCalendar&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:383"/>
          </check>
        </Rule>
        <Rule id="xccdf_gov.nist.mscp.content_rule_icloud_addressbook_disable_recommended" selected="false" role="full" severity="unknown" weight="1.0">
          <title>Disable iCloud Address Book</title>
          <description>The macOS built-in Contacts.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data, and, therefore, automated contact synchronization _MUST_ be controlled by an organization approved service.
            
            /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudAddressBook').js
EOS
            
            
Result: {'string': 'false'}</description>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-5/final">NIST SP 800-53r5: AC-20, AC-20(1), CM-7, CM-7(1), SC-7(10)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-53/rev-4/final">NIST SP 800-53r4: CM-7, CM-7(1), AC-20, AC-20(1)</reference>
          <reference href="https://csrc.nist.gov/publications/detail/sp/800-171/rev-2/final">NIST SP 800-171r3: 03.01.20, 03.04.06</reference>
          <reference href="https://public.cyber.mil/stigs/downloads/">DISA STIG(s): APPL-26-002014</reference>
          <reference href="https://www.cisecurity.org/controls">CIS Controls V8: 4.1, 4.8, 15.3</reference>
          <ident system="https://ncp.nist.gov/cce">CCE-95140-0</ident>
          <fixtext>This is implemented by a Configuration Profile.

Create a configuration profile containing the following keys in the (com.apple.applicationaccess) payload type:

[source,xml]
----
&lt;key&gt;allowCloudAddressBook&lt;/key&gt;
&lt;false/&gt;
----

</fixtext>
          <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
            <check-content-ref href="oval.xml" name="oval:mscp:def:384"/>
          </check>
        </Rule>
      </Group>
    </Benchmark>
  </component>
  <component id="scap_gov.nist.mscp.content_comp_macOS_26.0_check_1" timestamp="2025-09-11T15:25:32">
    <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#macos https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/macos-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/unix-definitions-schema.xsd">
      <generator>
        <oval:schema_version>5.12.1</oval:schema_version>
        <oval:timestamp xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5">2025-09-11T15:25:32</oval:timestamp>
        <terms_of_use>Copyright (c) 2025, NIST.</terms_of_use>
        <oval:product_name xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5">macOS Security Compliance Project</oval:product_name>
      </generator>
      <definitions>
        <definition id="oval:mscp:def:1" version="1" class="compliance">
          <metadata>
            <title>Disable the Internet Accounts System Preference Pane</title>
            <reference source="CCE" ref_id="CCE-95381-0"/>
            <reference source="macos_security" ref_id="system_settings_internet_accounts_disable_recommended"/>
            <description>The Internet Accounts System Setting _MUST_ be disabled to prevent the addition of unauthorized internet accounts.

[IMPORTANT]
====
Some organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_internet_accounts_disable_recommended" test_ref="oval:mscp:tst:1"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:2" version="1" class="compliance">
          <metadata>
            <title>Ensure Time Machine Volumes are Encrypted</title>
            <reference source="CCE" ref_id="CCE-95410-7"/>
            <reference source="macos_security" ref_id="system_settings_time_machine_encrypted_configure_recommended"/>
            <description>Time Machine volumes _MUST_ be encrypted.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_machine_encrypted_configure_recommended" test_ref="oval:mscp:tst:2"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:3" version="1" class="compliance">
          <metadata>
            <title>Enforce macOS Updates are Automatically Installed</title>
            <reference source="CCE" ref_id="CCE-95380-2"/>
            <reference source="macos_security" ref_id="system_settings_install_macos_updates_enforce_recommended"/>
            <description>Software Update _MUST_ be configured to enforce automatic installation of macOS updates is enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_install_macos_updates_enforce_recommended" test_ref="oval:mscp:tst:3"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:4" version="1" class="compliance">
          <metadata>
            <title>Enforce Session Lock After Screen Saver is Started</title>
            <reference source="CCE" ref_id="CCE-95395-0"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_ask_for_password_delay_enforce_recommended"/>
            <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_ask_for_password_delay_enforce_recommended" test_ref="oval:mscp:tst:4"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:5" version="1" class="compliance">
          <metadata>
            <title>Enforce Session Lock After Screen Saver is Started</title>
            <reference source="CCE" ref_id="CCE-95395-0"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_ask_for_password_delay_enforce_stig"/>
            <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_ask_for_password_delay_enforce_stig" test_ref="oval:mscp:tst:5"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:6" version="1" class="compliance">
          <metadata>
            <title>Enforce Session Lock After Screen Saver is Started</title>
            <reference source="CCE" ref_id="CCE-95395-0"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1"/>
            <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1" test_ref="oval:mscp:tst:6"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:7" version="1" class="compliance">
          <metadata>
            <title>Enforce Session Lock After Screen Saver is Started</title>
            <reference source="CCE" ref_id="CCE-95395-0"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2"/>
            <description>A screen saver _MUST_ be enabled and the system _MUST_ be configured to require a password to unlock once the screensaver has been on for a maximum of 5 seconds.

An unattended system with an excessive grace period is vulnerable to a malicious user.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2" test_ref="oval:mscp:tst:7"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:8" version="1" class="compliance">
          <metadata>
            <title>Disable the System Settings Pane for Wallet and Apple Pay</title>
            <reference source="CCE" ref_id="CCE-95418-0"/>
            <reference source="macos_security" ref_id="system_settings_wallet_applepay_settings_disable_recommended"/>
            <description>The System Settings pane for Wallet and Apple Pay _MUST_ be disabled.

Disabling the System Settings pane prevents the users from configuring Wallet and Apple Pay.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_wallet_applepay_settings_disable_recommended" test_ref="oval:mscp:tst:8"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:9" version="1" class="compliance">
          <metadata>
            <title>Ensure Location Services Is In the Menu Bar</title>
            <reference source="CCE" ref_id="CCE-95385-1"/>
            <reference source="macos_security" ref_id="system_settings_location_services_menu_enforce_recommended"/>
            <description>Location Services menu item _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_location_services_menu_enforce_recommended" test_ref="oval:mscp:tst:9"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:10" version="1" class="compliance">
          <metadata>
            <title>Disable Guest Access to Shared SMB Folders</title>
            <reference source="CCE" ref_id="CCE-95373-7"/>
            <reference source="macos_security" ref_id="system_settings_guest_access_smb_disable_recommended"/>
            <description>Guest access to shared Server Message Block (SMB) folders _MUST_ be disabled.

Turning off guest access prevents anonymous users from accessing files shared via SMB.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_guest_access_smb_disable_recommended" test_ref="oval:mscp:tst:10"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:11" version="1" class="compliance">
          <metadata>
            <title>Disable Printer Sharing</title>
            <reference source="CCE" ref_id="CCE-95391-9"/>
            <reference source="macos_security" ref_id="system_settings_printer_sharing_disable_recommended"/>
            <description>Printer Sharing _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_printer_sharing_disable_recommended" test_ref="oval:mscp:tst:11"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:12" version="1" class="compliance">
          <metadata>
            <title>Enable Bluetooth Menu</title>
            <reference source="CCE" ref_id="CCE-95359-6"/>
            <reference source="macos_security" ref_id="system_settings_bluetooth_menu_enable_recommended"/>
            <description>The bluetooth menu _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_bluetooth_menu_enable_recommended" test_ref="oval:mscp:tst:12"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:13" version="1" class="compliance">
          <metadata>
            <title>Require Administrator Password to Modify System-Wide Preferences</title>
            <reference source="CCE" ref_id="CCE-95408-1"/>
            <reference source="macos_security" ref_id="system_settings_system_wide_preferences_configure_recommended"/>
            <description>The system _MUST_ be configured to require an administrator password in order to modify the system-wide preferences in System Settings.

Some Preference Panes in System Settings contain settings that affect the entire system. Requiring a password to unlock these system-wide settings reduces the risk of a non-authorized user modifying system configurations.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_system_wide_preferences_configure_recommended" test_ref="oval:mscp:tst:13"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:14" version="1" class="compliance">
          <metadata>
            <title>Enable Location Services</title>
            <reference source="CCE" ref_id="CCE-95384-4"/>
            <reference source="macos_security" ref_id="system_settings_location_services_enable_recommended"/>
            <description>Location Services _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_location_services_enable_recommended" test_ref="oval:mscp:tst:14"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:15" version="1" class="compliance">
          <metadata>
            <title>Disable Improve Search Information to Apple</title>
            <reference source="CCE" ref_id="CCE-95378-6"/>
            <reference source="macos_security" ref_id="system_settings_improve_search_disable_recommended"/>
            <description>Sending data to Apple to help improve search _MUST_ be disabled. This will disable "Improve Search" within Spotlight in System Settings.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of search data will mitigate the risk of unwanted data being sent to Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_improve_search_disable_recommended" test_ref="oval:mscp:tst:15"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:16" version="1" class="compliance">
          <metadata>
            <title>Disable the Guest Account</title>
            <reference source="CCE" ref_id="CCE-95374-5"/>
            <reference source="macos_security" ref_id="system_settings_guest_account_disable_recommended"/>
            <description>Guest access _MUST_ be disabled.

Turning off guest access prevents anonymous users from accessing files.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_guest_account_disable_recommended" test_ref="oval:mscp:tst:16"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:17" version="1" class="compliance">
          <metadata>
            <title>Enforce Software Update Downloads Updates Automatically</title>
            <reference source="CCE" ref_id="CCE-95403-2"/>
            <reference source="macos_security" ref_id="system_settings_software_update_download_enforce_recommended"/>
            <description>Software Update _MUST_ be configured to enforce automatic downloads of updates is enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_software_update_download_enforce_recommended" test_ref="oval:mscp:tst:17"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:18" version="1" class="compliance">
          <metadata>
            <title>Disable Personalized Advertising</title>
            <reference source="CCE" ref_id="CCE-95390-1"/>
            <reference source="macos_security" ref_id="system_settings_personalized_advertising_disable_recommended"/>
            <description>Ad tracking and targeted ads _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling ad tracking ensures that applications and advertisers are unable to track users' interests and deliver targeted advertisements.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_personalized_advertising_disable_recommended" test_ref="oval:mscp:tst:18"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:19" version="1" class="compliance">
          <metadata>
            <title>Disable Bluetooth When no Approved Device is Connected</title>
            <reference source="CCE" ref_id="CCE-95358-8"/>
            <reference source="macos_security" ref_id="system_settings_bluetooth_disable_recommended"/>
            <description>The macOS system _MUST_ be configured to disable Bluetooth unless there is an approved device connected.

[IMPORTANT]
====
Information System Security Officers (ISSOs) may make the risk-based decision not to disable Bluetooth, so as to maintain necessary functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_bluetooth_disable_recommended" test_ref="oval:mscp:tst:19"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:20" version="1" class="compliance">
          <metadata>
            <title>Disable Remote Management</title>
            <reference source="CCE" ref_id="CCE-95393-5"/>
            <reference source="macos_security" ref_id="system_settings_remote_management_disable_recommended"/>
            <description>Remote Management _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_remote_management_disable_recommended" test_ref="oval:mscp:tst:20"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:21" version="1" class="compliance">
          <metadata>
            <title>Configure Login Window to Prompt for Username and Password</title>
            <reference source="CCE" ref_id="CCE-95387-7"/>
            <reference source="macos_security" ref_id="system_settings_loginwindow_prompt_username_password_enforce_recommended"/>
            <description>The login window _MUST_ be configured to prompt all users for both a username and a password.

By default, the system displays a list of known users on the login window, which can make it easier for a malicious user to gain access to someone else's account. Requiring users to type in both their username and password mitigates the risk of unauthorized users gaining access to the information system.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_loginwindow_prompt_username_password_enforce_recommended" test_ref="oval:mscp:tst:21"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:22" version="1" class="compliance">
          <metadata>
            <title>Prevent Apple Watch from Terminating a Session Lock</title>
            <reference source="CCE" ref_id="CCE-95355-4"/>
            <reference source="macos_security" ref_id="system_settings_apple_watch_unlock_disable_recommended"/>
            <description>Apple Watches are not an approved authenticator and their use _MUST_ be disabled.

Disabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using an authorized identification and authentication procedures.

NOTE: Unlocking the system with an Apple Watch is not an approved authenticator for US Federal Government usage as it has not been verified to meet the strength requirements outlined in NIST SP 800-63.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_apple_watch_unlock_disable_recommended" test_ref="oval:mscp:tst:22"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:23" version="1" class="compliance">
          <metadata>
            <title>Disable Server Message Block Sharing</title>
            <reference source="CCE" ref_id="CCE-95401-6"/>
            <reference source="macos_security" ref_id="system_settings_smbd_disable_recommended"/>
            <description>Support for Server Message Block (SMB) file sharing is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_smbd_disable_recommended" test_ref="oval:mscp:tst:23"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:24" version="1" class="compliance">
          <metadata>
            <title>Secure Hot Corners</title>
            <reference source="CCE" ref_id="CCE-95376-0"/>
            <reference source="macos_security" ref_id="system_settings_hot_corners_secure_recommended"/>
            <description>Hot corners _MUST_ be secured.

The information system conceals, via the session lock, information previously visible on the display with a publicly viewable image. Although hot comers can be used to initiate a session lock or to launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.

[NOTE]
====
The check and fix are for the last logged in user. To get the last logged in user, run the following.
[source,bash]
----
CURRENT_USER=$( /usr/bin/defaults read /Library/Preferences/com.apple.loginwindow lastUserName )
----
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_hot_corners_secure_recommended" test_ref="oval:mscp:tst:24"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:25" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Timeout</title>
            <reference source="CCE" ref_id="CCE-95397-6"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_timeout_enforce_recommended"/>
            <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_timeout_enforce_recommended" test_ref="oval:mscp:tst:25"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:26" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Timeout</title>
            <reference source="CCE" ref_id="CCE-95397-6"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_timeout_enforce_cis_lvl1"/>
            <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_timeout_enforce_cis_lvl1" test_ref="oval:mscp:tst:26"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:27" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Timeout</title>
            <reference source="CCE" ref_id="CCE-95397-6"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_timeout_enforce_cis_lvl2"/>
            <description>The screen saver timeout _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_timeout_enforce_cis_lvl2" test_ref="oval:mscp:tst:27"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:28" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Timeout</title>
            <reference source="CCE" ref_id="CCE-95397-6"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_timeout_enforce_stig"/>
            <description>The screen saver timeout _MUST_ be set to 900 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 900 seconds of inactivity.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_timeout_enforce_stig" test_ref="oval:mscp:tst:28"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:29" version="1" class="compliance">
          <metadata>
            <title>Enforce Auto Logout After 86400 Seconds of Inactivity</title>
            <reference source="CCE" ref_id="CCE-95357-0"/>
            <reference source="macos_security" ref_id="system_settings_automatic_logout_enforce_recommended"/>
            <description>Auto logout _MUST_ be configured to automatically terminate a user session and log out the after 86400 seconds of inactivity.

NOTE:The maximum that macOS can be configured for autologoff is 86400 seconds.

[IMPORTANT]
====
The automatic logout may cause disruptions to an organization's workflow and/or loss of data. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting to disable the automatic logout setting.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_automatic_logout_enforce_recommended" test_ref="oval:mscp:tst:29"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:30" version="1" class="compliance">
          <metadata>
            <title>Enforce Auto Logout After 86400 Seconds of Inactivity</title>
            <reference source="CCE" ref_id="CCE-95357-0"/>
            <reference source="macos_security" ref_id="system_settings_automatic_logout_enforce_stig"/>
            <description>Auto logout _MUST_ be configured to automatically terminate a user session and log out the after 86400 seconds of inactivity.

NOTE:The maximum that macOS can be configured for autologoff is 86400 seconds.

[IMPORTANT]
====
The automatic logout may cause disruptions to an organization's workflow and/or loss of data. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting to disable the automatic logout setting.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_automatic_logout_enforce_stig" test_ref="oval:mscp:tst:30"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:31" version="1" class="compliance">
          <metadata>
            <title>Disable Password Hints</title>
            <reference source="CCE" ref_id="CCE-95389-3"/>
            <reference source="macos_security" ref_id="system_settings_password_hints_disable_recommended"/>
            <description>Password hints _MUST_ be disabled.

Password hints leak information about passwords that are currently in use and can lead to loss of confidentiality.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_password_hints_disable_recommended" test_ref="oval:mscp:tst:31"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:32" version="1" class="compliance">
          <metadata>
            <title>Disable Screen Sharing and Apple Remote Desktop</title>
            <reference source="CCE" ref_id="CCE-95394-3"/>
            <reference source="macos_security" ref_id="system_settings_screen_sharing_disable_recommended"/>
            <description>Support for both Screen Sharing and Apple Remote Desktop (ARD) is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling screen sharing and ARD helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screen_sharing_disable_recommended" test_ref="oval:mscp:tst:32"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:33" version="1" class="compliance">
          <metadata>
            <title>Configure Time Machine for Automatic Backups</title>
            <reference source="CCE" ref_id="CCE-95409-9"/>
            <reference source="macos_security" ref_id="system_settings_time_machine_auto_backup_enable_recommended"/>
            <description>Automatic backups _MUST_ be enabled when using Time Machine.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_machine_auto_backup_enable_recommended" test_ref="oval:mscp:tst:33"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:34" version="1" class="compliance">
          <metadata>
            <title>Disable TouchID for Unlocking the Device</title>
            <reference source="CCE" ref_id="CCE-95415-6"/>
            <reference source="macos_security" ref_id="system_settings_touchid_unlock_disable_recommended"/>
            <description>TouchID enables the ability to unlock a Mac system with a user's fingerprint.

TouchID _MUST_ be disabled for "Unlocking your Mac" on all macOS devices that are capable of using Touch ID.

The system _MUST_ remain locked until the user establishes access using an authorized identification and authentication method.

NOTE: TouchID is not an approved biometric authenticator for US Federal Government usage as it has not been verified to meet the strength requirements outlined in NIST SP 800-63.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_touchid_unlock_disable_recommended" test_ref="oval:mscp:tst:34"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:36" version="1" class="compliance">
          <metadata>
            <title>Ensure Software Update is Updated and Current</title>
            <reference source="CCE" ref_id="CCE-95405-7"/>
            <reference source="macos_security" ref_id="system_settings_softwareupdate_current_recommended"/>
            <description>Make sure Software Update is updated and current.

NOTE: Automatic fix can cause unplanned restarts and may lose work.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_softwareupdate_current_recommended" test_ref="oval:mscp:tst:36"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:37" version="1" class="compliance">
          <metadata>
            <title>Disable External Intelligence Integrations</title>
            <reference source="CCE" ref_id="CCE-95365-3"/>
            <reference source="macos_security" ref_id="system_settings_external_intelligence_disable_recommended"/>
            <description>Integration with external intelligence systems _MUST_ be disabled unless approved by the organization. Disabling external intelligence integration will mitigate the risk of data being sent to unapproved third party.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_external_intelligence_disable_recommended" test_ref="oval:mscp:tst:37"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:38" version="1" class="compliance">
          <metadata>
            <title>Ensure Siri Listen For is Disabled</title>
            <reference source="CCE" ref_id="CCE-95399-2"/>
            <reference source="macos_security" ref_id="system_settings_siri_listen_disable_recommended"/>
            <description>Siri has the ability to listen for "Hey Siri" or "Siri". Listen for _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_siri_listen_disable_recommended" test_ref="oval:mscp:tst:38"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:39" version="1" class="compliance">
          <metadata>
            <title>Disable Internet Sharing</title>
            <reference source="CCE" ref_id="CCE-95382-8"/>
            <reference source="macos_security" ref_id="system_settings_internet_sharing_disable_recommended"/>
            <description>If the system does not require Internet sharing, support for it is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Internet sharing helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_internet_sharing_disable_recommended" test_ref="oval:mscp:tst:39"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:40" version="1" class="compliance">
          <metadata>
            <title>Enforce FileVault</title>
            <reference source="CCE" ref_id="CCE-95367-9"/>
            <reference source="macos_security" ref_id="system_settings_filevault_enforce_recommended"/>
            <description>FileVault _MUST_ be enforced.

The information system implements cryptographic mechanisms to protect the confidentiality and integrity of information stored on digital media during transport outside of controlled areas.

NOTE: See the FileVault supplemental to implement this rule.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_filevault_enforce_recommended" test_ref="oval:mscp:tst:40"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:41" version="1" class="compliance">
          <metadata>
            <title>Configure Gatekeeper to Disallow End User Override</title>
            <reference source="CCE" ref_id="CCE-95372-9"/>
            <reference source="macos_security" ref_id="system_settings_gatekeeper_override_disallow_recommended"/>
            <description>Gatekeeper _MUST_ be configured with a configuration profile to prevent normal users from overriding its settings.

If users are allowed to disable Gatekeeper or set it to a less restrictive setting, malware could be introduced into the system.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_gatekeeper_override_disallow_recommended" test_ref="oval:mscp:tst:41"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:42" version="1" class="compliance">
          <metadata>
            <title>Disable SSH Server for Remote Access Sessions</title>
            <reference source="CCE" ref_id="CCE-95406-5"/>
            <reference source="macos_security" ref_id="system_settings_ssh_disable_recommended"/>
            <description>SSH service _MUST_ be disabled for remote access.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_ssh_disable_recommended" test_ref="oval:mscp:tst:42"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:43" version="1" class="compliance">
          <metadata>
            <title>Disable Siri</title>
            <reference source="CCE" ref_id="CCE-95398-4"/>
            <reference source="macos_security" ref_id="system_settings_siri_disable_recommended"/>
            <description>Support for Siri is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_siri_disable_recommended" test_ref="oval:mscp:tst:43"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:44" version="1" class="compliance">
          <metadata>
            <title>Disable Content Caching Service</title>
            <reference source="CCE" ref_id="CCE-95362-0"/>
            <reference source="macos_security" ref_id="system_settings_content_caching_disable_recommended"/>
            <description>Content caching _MUST_ be disabled.

Content caching is a macOS service that helps reduce Internet data usage and speed up software installation on Mac computers. It is not recommended for devices furnished to employees to act as a caching server.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_content_caching_disable_recommended" test_ref="oval:mscp:tst:44"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:45" version="1" class="compliance">
          <metadata>
            <title>Enable SSH Server for Remote Access Sessions</title>
            <reference source="CCE" ref_id="CCE-95407-3"/>
            <reference source="macos_security" ref_id="system_settings_ssh_enable_recommended"/>
            <description>Remote access sessions _MUST_ use encrypted methods to protect unauthorized individuals from gaining access.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_ssh_enable_recommended" test_ref="oval:mscp:tst:45"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:46" version="1" class="compliance">
          <metadata>
            <title>Apply Gatekeeper Settings to Block Applications from Unidentified Developers</title>
            <reference source="CCE" ref_id="CCE-95371-1"/>
            <reference source="macos_security" ref_id="system_settings_gatekeeper_identified_developers_allowed_recommended"/>
            <description>The information system implements cryptographic mechanisms to authenticate software prior to installation.

Gatekeeper settings must be configured correctly to only allow the system to run applications downloaded from the Mac App Store or applications signed with a valid Apple Developer ID code. Administrator users will still have the option to override these settings on a per-app basis. Gatekeeper is a security feature that ensures that applications must be digitally signed by an Apple-issued certificate in order to run. Digital signatures allow the macOS to verify that the application has not been modified by a malicious third party.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_gatekeeper_identified_developers_allowed_recommended" test_ref="oval:mscp:tst:46"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:47" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Password</title>
            <reference source="CCE" ref_id="CCE-95396-8"/>
            <reference source="macos_security" ref_id="system_settings_screensaver_password_enforce_recommended"/>
            <description>Users _MUST_ authenticate when unlocking the screen saver.

The screen saver acts as a session lock and prevents unauthorized users from accessing the current user's account.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_screensaver_password_enforce_recommended" test_ref="oval:mscp:tst:47"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:48" version="1" class="compliance">
          <metadata>
            <title>Enable macOS Application Firewall</title>
            <reference source="CCE" ref_id="CCE-95369-5"/>
            <reference source="macos_security" ref_id="system_settings_firewall_enable_recommended"/>
            <description>The macOS Application Firewall is the built-in firewall that comes with macOS, and it _MUST_ be enabled.

When the macOS Application Firewall is enabled, the flow of information within the information system and between interconnected systems will be controlled by approved authorizations.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_firewall_enable_recommended" test_ref="oval:mscp:tst:48"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:49" version="1" class="compliance">
          <metadata>
            <title>Disable Find My Service</title>
            <reference source="CCE" ref_id="CCE-95368-7"/>
            <reference source="macos_security" ref_id="system_settings_find_my_disable_recommended"/>
            <description>The Find My service _MUST_ be disabled.

A Mobile Device Management (MDM) solution _MUST_ be used to carry out remote locking and wiping instead of Apple's Find My service.

Apple's Find My service uses a personal AppleID for authentication. Organizations should rely on MDM solutions, which have much more secure authentication requirements, to perform remote lock and remote wipe.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_find_my_disable_recommended" test_ref="oval:mscp:tst:49"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:50" version="1" class="compliance">
          <metadata>
            <title>Disable Hot Corners</title>
            <reference source="CCE" ref_id="CCE-95375-2"/>
            <reference source="macos_security" ref_id="system_settings_hot_corners_disable_recommended"/>
            <description>Hot corners _MUST_ be disabled.

The information system conceals, via the session lock, information previously visible on the display with a publicly viewable image. Although hot comers can be used to initiate a session lock or to launch useful applications, they can also be configured to disable an automatic session lock from initiating. Such a configuration introduces the risk that a user might forget to manually lock the screen before stepping away from the computer.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_hot_corners_disable_recommended" test_ref="oval:mscp:tst:50"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:51" version="1" class="compliance">
          <metadata>
            <title>Disable Sending Diagnostic and Usage Data to Apple</title>
            <reference source="CCE" ref_id="CCE-95364-6"/>
            <reference source="macos_security" ref_id="system_settings_diagnostics_reports_disable_recommended"/>
            <description>The ability to submit diagnostic data to Apple _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of diagnostic and usage information will mitigate the risk of unwanted data being sent to Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_diagnostics_reports_disable_recommended" test_ref="oval:mscp:tst:51"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:52" version="1" class="compliance">
          <metadata>
            <title>Enforce Critical Security Updates to be Installed</title>
            <reference source="CCE" ref_id="CCE-95363-8"/>
            <reference source="macos_security" ref_id="system_settings_critical_update_install_enforce_recommended"/>
            <description>Ensure that security updates are installed as soon as they are available from Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_critical_update_install_enforce_recommended" test_ref="oval:mscp:tst:52"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:53" version="1" class="compliance">
          <metadata>
            <title>Ensure Wake for Network Access Is Disabled</title>
            <reference source="CCE" ref_id="CCE-95417-2"/>
            <reference source="macos_security" ref_id="system_settings_wake_network_access_disable_recommended"/>
            <description>Wake for network access _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_wake_network_access_disable_recommended" test_ref="oval:mscp:tst:53"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:54" version="1" class="compliance">
          <metadata>
            <title>Disable Bluetooth Sharing</title>
            <reference source="CCE" ref_id="CCE-95361-2"/>
            <reference source="macos_security" ref_id="system_settings_bluetooth_sharing_disable_recommended"/>
            <description>Bluetooth Sharing _MUST_ be disabled.

Bluetooth Sharing allows users to wirelessly transmit files between the macOS and Bluetooth-enabled devices, including personally owned cellphones and tablets. A malicious user might introduce viruses or malware onto the system or extract sensitive files via Bluetooth Sharing. When Bluetooth Sharing is disabled, this risk is mitigated.

[NOTE]
====
The check and fix are for the last logged in user. To get the last logged in user, run the following.
[source,bash]
----
CURRENT_USER=$( /usr/bin/defaults read /Library/Preferences/com.apple.loginwindow lastUserName )
----
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_bluetooth_sharing_disable_recommended" test_ref="oval:mscp:tst:54"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:55" version="1" class="compliance">
          <metadata>
            <title>Disable Unattended or Automatic Logon to the System</title>
            <reference source="CCE" ref_id="CCE-95356-2"/>
            <reference source="macos_security" ref_id="system_settings_automatic_login_disable_recommended"/>
            <description>Automatic logon _MUST_ be disabled.

When automatic logons are enabled, the default user account is automatically logged on at boot time without prompting the user for a password. Even if the screen is later locked, a malicious user would be able to reboot the computer and find it already logged in. Disabling automatic logons mitigates this risk.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_automatic_login_disable_recommended" test_ref="oval:mscp:tst:55"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:56" version="1" class="compliance">
          <metadata>
            <title>Configure Login Window to Show A Custom Message</title>
            <reference source="CCE" ref_id="CCE-95386-9"/>
            <reference source="macos_security" ref_id="system_settings_loginwindow_loginwindowtext_enable_recommended"/>
            <description>The login window _MUST_ be configured to show a custom access warning message.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_loginwindow_loginwindowtext_enable_recommended" test_ref="oval:mscp:tst:56"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:57" version="1" class="compliance">
          <metadata>
            <title>Configure Login Window to Show A Custom Message</title>
            <reference source="CCE" ref_id="CCE-95386-9"/>
            <reference source="macos_security" ref_id="system_settings_loginwindow_loginwindowtext_enable_cis_lvl1"/>
            <description>The login window _MUST_ be configured to show a custom access warning message.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl1" test_ref="oval:mscp:tst:57"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:58" version="1" class="compliance">
          <metadata>
            <title>Configure Login Window to Show A Custom Message</title>
            <reference source="CCE" ref_id="CCE-95386-9"/>
            <reference source="macos_security" ref_id="system_settings_loginwindow_loginwindowtext_enable_cis_lvl2"/>
            <description>The login window _MUST_ be configured to show a custom access warning message.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl2" test_ref="oval:mscp:tst:58"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:59" version="1" class="compliance">
          <metadata>
            <title>Disable Improve Siri and Dictation Information to Apple</title>
            <reference source="CCE" ref_id="CCE-95379-4"/>
            <reference source="macos_security" ref_id="system_settings_improve_siri_dictation_disable_recommended"/>
            <description>The ability for Apple to store and review audio of your Siri and Dictation interactions _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of Siri and Dictation information will mitigate the risk of unwanted data being sent to Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_improve_siri_dictation_disable_recommended" test_ref="oval:mscp:tst:59"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:60" version="1" class="compliance">
          <metadata>
            <title>Enforce Software Update Downloads Updates Automatically using DDM.</title>
            <reference source="CCE" ref_id="CCE-95403-2"/>
            <reference source="macos_security" ref_id="system_settings_download_software_update_enforce_recommended"/>
            <description>Software Update _MUST_ be configured to enforce automatic downloads of updates from Apple and that the user cannot modify the setting within System Settings.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_download_software_update_enforce_recommended" test_ref="oval:mscp:tst:60"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:61" version="1" class="compliance">
          <metadata>
            <title>Disable the Touch ID System Settings Pane</title>
            <reference source="CCE" ref_id="CCE-95414-9"/>
            <reference source="macos_security" ref_id="system_settings_touch_id_settings_disable_recommended"/>
            <description>The System Settings pane for Touch ID _MUST_ be disabled.

Disabling the System Settings pane prevents the users from configuring Touch ID.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_touch_id_settings_disable_recommended" test_ref="oval:mscp:tst:61"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:62" version="1" class="compliance">
          <metadata>
            <title>Disable External Intelligence Integration Sign In</title>
            <reference source="CCE" ref_id="CCE-95366-1"/>
            <reference source="macos_security" ref_id="system_settings_external_intelligence_sign_in_disable_recommended"/>
            <description>The ability to sign into an external intelligence systems _MUST_ be disabled unless approved by the organiztion. Disabling external intelligence integration will mitigate the risk of data being sent to unapproved third party.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_external_intelligence_sign_in_disable_recommended" test_ref="oval:mscp:tst:62"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:63" version="1" class="compliance">
          <metadata>
            <title>Disable the Bluetooth System Settings Pane</title>
            <reference source="CCE" ref_id="CCE-95360-4"/>
            <reference source="macos_security" ref_id="system_settings_bluetooth_settings_disable_recommended"/>
            <description>The Bluetooth System Setting pane _MUST_ be disabled to prevent access to the bluetooth configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_bluetooth_settings_disable_recommended" test_ref="oval:mscp:tst:63"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:64" version="1" class="compliance">
          <metadata>
            <title>Disable Location Services</title>
            <reference source="CCE" ref_id="CCE-95383-6"/>
            <reference source="macos_security" ref_id="system_settings_location_services_disable_recommended"/>
            <description>Location Services _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.  Disabling Location Services helps prevent the unauthorized connection of devices, unauthorized transfer of information, and unauthorized tunneling.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_location_services_disable_recommended" test_ref="oval:mscp:tst:64"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:65" version="1" class="compliance">
          <metadata>
            <title>USB Devices Must be Authorized Before Allowing</title>
            <reference source="CCE" ref_id="CCE-95416-4"/>
            <reference source="macos_security" ref_id="system_settings_usb_restricted_mode_recommended"/>
            <description>USB devices connected to a Mac _MUST_ be authorized.

[IMPORTANT]
====
This feature is removed if a smartcard is paired or smartcard attribute mapping is configured.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_usb_restricted_mode_recommended" test_ref="oval:mscp:tst:65"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:66" version="1" class="compliance">
          <metadata>
            <title>Configure macOS to Use an Authorized Time Server</title>
            <reference source="CCE" ref_id="CCE-95411-5"/>
            <reference source="macos_security" ref_id="system_settings_time_server_configure_recommended"/>
            <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_server_configure_recommended" test_ref="oval:mscp:tst:66"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:67" version="1" class="compliance">
          <metadata>
            <title>Configure macOS to Use an Authorized Time Server</title>
            <reference source="CCE" ref_id="CCE-95411-5"/>
            <reference source="macos_security" ref_id="system_settings_time_server_configure_cis_lvl1"/>
            <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_server_configure_cis_lvl1" test_ref="oval:mscp:tst:67"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:68" version="1" class="compliance">
          <metadata>
            <title>Configure macOS to Use an Authorized Time Server</title>
            <reference source="CCE" ref_id="CCE-95411-5"/>
            <reference source="macos_security" ref_id="system_settings_time_server_configure_cis_lvl2"/>
            <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_server_configure_cis_lvl2" test_ref="oval:mscp:tst:68"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:69" version="1" class="compliance">
          <metadata>
            <title>Configure macOS to Use an Authorized Time Server</title>
            <reference source="CCE" ref_id="CCE-95411-5"/>
            <reference source="macos_security" ref_id="system_settings_time_server_configure_stig"/>
            <description>Approved time server _MUST_ be the only server configured for use. As of macOS 10.13 only one time server is supported.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_server_configure_stig" test_ref="oval:mscp:tst:69"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:70" version="1" class="compliance">
          <metadata>
            <title>Enforce macOS Time Synchronization</title>
            <reference source="CCE" ref_id="CCE-95412-3"/>
            <reference source="macos_security" ref_id="system_settings_time_server_enforce_recommended"/>
            <description>Time synchronization _MUST_ be enforced on all networked systems.

This rule ensures the uniformity of time stamps for information systems with multiple system clocks and systems connected over a network.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_time_server_enforce_recommended" test_ref="oval:mscp:tst:70"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:71" version="1" class="compliance">
          <metadata>
            <title>Disable the System Settings Pane for Siri</title>
            <reference source="CCE" ref_id="CCE-95400-8"/>
            <reference source="macos_security" ref_id="system_settings_siri_settings_disable_recommended"/>
            <description>The System Settings pane for Siri _MUST_ be hidden.

Hiding the System Settings pane prevents the users from configuring Siri.

NOTE: Disabling the Siri System Settings pane blocks the user from opting into Apple Intelligence.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_siri_settings_disable_recommended" test_ref="oval:mscp:tst:71"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:72" version="1" class="compliance">
          <metadata>
            <title>Disable Sending Audio Recordings and Transcripts to Apple</title>
            <reference source="CCE" ref_id="CCE-95377-8"/>
            <reference source="macos_security" ref_id="system_settings_improve_assistive_voice_disable_recommended"/>
            <description>The ability for Apple to store and review audio of your audio recordings and transcripts of your vocal shortcuts and voice control interactions _MUST_ be disabled. This will disable "Improve Assistive Voice Features" in Privacy &amp; Security within System Settings.

The information system _MUST_ be configured to provide only essential capabilities. Disabling the submission of this information will mitigate the risk of unwanted data being sent to Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_improve_assistive_voice_disable_recommended" test_ref="oval:mscp:tst:72"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:73" version="1" class="compliance">
          <metadata>
            <title>Disable Airplay Receiver</title>
            <reference source="CCE" ref_id="CCE-95354-7"/>
            <reference source="macos_security" ref_id="system_settings_airplay_receiver_disable_recommended"/>
            <description>Airplay Receiver allows you to send content from another Apple device to be displayed on the screen as it's being played from your other device.

Support for Airplay Receiver is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_airplay_receiver_disable_recommended" test_ref="oval:mscp:tst:73"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:74" version="1" class="compliance">
          <metadata>
            <title>Enforce Automatic Installs of Available Security Updates using DDM.</title>
            <reference source="CCE" ref_id="CCE-95602-9"/>
            <reference source="macos_security" ref_id="system_settings_security_update_install_recommended"/>
            <description>Ensure that available security updates are installed as soon as they are available from Apple and that the user cannot modify the setting within System Settings.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_security_update_install_recommended" test_ref="oval:mscp:tst:74"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:75" version="1" class="compliance">
          <metadata>
            <title>Configure User Session Lock When a Smart Token is Removed</title>
            <reference source="CCE" ref_id="CCE-95413-1"/>
            <reference source="macos_security" ref_id="system_settings_token_removal_enforce_recommended"/>
            <description>The screen lock _MUST_ be configured to initiate automatically when the smart token is removed from the system.

Session locks are temporary actions taken when users stop work and move away from the immediate vicinity of the information system but do not want to log out because of the temporary nature of their absences. While a session lock is not an acceptable substitute for logging out of an information system for longer periods of time, they prevent a malicious user from accessing the information system when a user has removed their smart token.

[IMPORTANT]
====
Information System Security Officers (ISSOs) may make the risk-based decision not to enforce a session lock when a smart token is removed, so as to maintain necessary workflow capabilities, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_token_removal_enforce_recommended" test_ref="oval:mscp:tst:75"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:76" version="1" class="compliance">
          <metadata>
            <title>Disable Media Sharing</title>
            <reference source="CCE" ref_id="CCE-95388-5"/>
            <reference source="macos_security" ref_id="system_settings_media_sharing_disabled_recommended"/>
            <description>Media sharing _MUST_ be disabled.

When Media Sharing is enabled, the computer starts a network listening service that shares the contents of the user's music collection with other users in the same subnet.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Media Sharing helps prevent the unauthorized connection of devices and the unauthorized transfer of information. Disabling Media Sharing mitigates this risk.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_media_sharing_disabled_recommended" test_ref="oval:mscp:tst:76"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:77" version="1" class="compliance">
          <metadata>
            <title>Enable Wifi Menu</title>
            <reference source="CCE" ref_id="CCE-95421-4"/>
            <reference source="macos_security" ref_id="system_settings_wifi_menu_enable_recommended"/>
            <description>The WiFi menu _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_wifi_menu_enable_recommended" test_ref="oval:mscp:tst:77"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:78" version="1" class="compliance">
          <metadata>
            <title>Enable Firewall Stealth Mode</title>
            <reference source="CCE" ref_id="CCE-95370-3"/>
            <reference source="macos_security" ref_id="system_settings_firewall_stealth_mode_enable_recommended"/>
            <description>Firewall Stealth Mode _MUST_ be enabled.

When stealth mode is enabled, the Mac will not respond to any probing requests, and only requests from authorized applications will still be authorized.

[IMPORTANT]
====
Enabling firewall stealth mode may prevent certain remote mechanisms used for maintenance and compliance scanning from properly functioning. Information System Security Officers (ISSOs) are advised to first fully weigh the potential risks posed to their organization before opting not to enable stealth mode.
====</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_firewall_stealth_mode_enable_recommended" test_ref="oval:mscp:tst:78"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:79" version="1" class="compliance">
          <metadata>
            <title>Disable Remote Apple Events</title>
            <reference source="CCE" ref_id="CCE-95392-7"/>
            <reference source="macos_security" ref_id="system_settings_rae_disable_recommended"/>
            <description>If the system does not require Remote Apple Events, support for Apple Remote Events is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Remote Apple Events helps prevent the unauthorized connection of devices, the unauthorized transfer of information, and unauthorized tunneling.</description>
          </metadata>
          <criteria>
            <criterion comment="system_settings_rae_disable_recommended" test_ref="oval:mscp:tst:79"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:81" version="1" class="compliance">
          <metadata>
            <title>Enforce Multifactor Authentication for Login</title>
            <reference source="CCE" ref_id="CCE-95132-7"/>
            <reference source="macos_security" ref_id="auth_pam_login_smartcard_enforce_recommended"/>
            <description>The system _MUST_ be configured to enforce multifactor authentication.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/login will be automatically modified to its original state following any update or major upgrade to the operating system.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_pam_login_smartcard_enforce_recommended" test_ref="oval:mscp:tst:81"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:82" version="1" class="compliance">
          <metadata>
            <title>Allow Smartcard Authentication</title>
            <reference source="CCE" ref_id="CCE-95135-0"/>
            <reference source="macos_security" ref_id="auth_smartcard_allow_recommended"/>
            <description>Smartcard authentication _MUST_ be allowed.

The use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.

When enabled, the smartcard can be used for login, authorization, and screen saver unlocking.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_smartcard_allow_recommended" test_ref="oval:mscp:tst:82"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:83" version="1" class="compliance">
          <metadata>
            <title>Enforce Multifactor Authentication for Privilege Escalation Through the sudo Command</title>
            <reference source="CCE" ref_id="CCE-95134-3"/>
            <reference source="macos_security" ref_id="auth_pam_sudo_smartcard_enforce_recommended"/>
            <description>The system _MUST_ be configured to enforce multifactor authentication when the sudo command is used to elevate privilege.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/sudo will be automatically modified to its original state following any update or major upgrade to the operating system.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_pam_sudo_smartcard_enforce_recommended" test_ref="oval:mscp:tst:83"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:84" version="1" class="compliance">
          <metadata>
            <title>Set Smartcard Certificate Trust to High</title>
            <reference source="CCE" ref_id="CCE-95136-8"/>
            <reference source="macos_security" ref_id="auth_smartcard_certificate_trust_enforce_high_recommended"/>
            <description>The macOS system _MUST_ be configured to block access to users who are no longer authorized (i.e., users with revoked certificates).

To prevent the use of untrusted certificates, the certificates on a smartcard card _MUST_ meet the following criteria: its issuer has a system-trusted certificate, the certificate is not expired, its "valid-after" date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) checking.

By setting the smartcard certificate trust level to high, the system will execute a hard revocation, i.e., a network connection is required. A verified positive response from the OSCP/CRL server is required for authentication to succeed.

NOTE: Before applying this setting, please see the smartcard supplemental guidance.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_smartcard_certificate_trust_enforce_high_recommended" test_ref="oval:mscp:tst:84"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:85" version="1" class="compliance">
          <metadata>
            <title>Set Smartcard Certificate Trust to Moderate</title>
            <reference source="CCE" ref_id="CCE-95137-6"/>
            <reference source="macos_security" ref_id="auth_smartcard_certificate_trust_enforce_moderate_recommended"/>
            <description>The macOS system _MUST_ be configured to block access to users who are no longer authorized (i.e., users with revoked certificates).

To prevent the use of untrusted certificates, the certificates on a smartcard card _MUST_ meet the following criteria: its issuer has a system-trusted certificate, the certificate is not expired, its "valid-after" date is in the past, and it passes Certificate Revocation List (CRL) and Online Certificate Status Protocol (OCSP) checking.

By setting the smartcard certificate trust level to moderate, the system will execute a soft revocation, i.e., if the OCSP/CRL server is unreachable, authentication will still succeed.

NOTE: Before applying this setting, please see the smartcard supplemental guidance.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_smartcard_certificate_trust_enforce_moderate_recommended" test_ref="oval:mscp:tst:85"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:86" version="1" class="compliance">
          <metadata>
            <title>Enforce Smartcard Authentication</title>
            <reference source="CCE" ref_id="CCE-95138-4"/>
            <reference source="macos_security" ref_id="auth_smartcard_enforce_recommended"/>
            <description>Smartcard authentication _MUST_ be enforced.

The use of smartcard credentials facilitates standardization and reduces the risk of unauthorized access.

When enforceSmartCard is set to "true", the smartcard must be used for login, authorization, and unlocking the screensaver.

CAUTION: enforceSmartCard will apply to the whole system. No users will be able to login with their password unless the profile is removed or a user is exempt from smartcard enforcement.

NOTE: enforceSmartcard requires allowSmartcard to be set to true in order to work.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_smartcard_enforce_recommended" test_ref="oval:mscp:tst:86"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:87" version="1" class="compliance">
          <metadata>
            <title>Enforce Multifactor Authentication for the su Command</title>
            <reference source="CCE" ref_id="CCE-95133-5"/>
            <reference source="macos_security" ref_id="auth_pam_su_smartcard_enforce_recommended"/>
            <description>The system _MUST_ be configured such that, when the su command is used, multifactor authentication is enforced.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

IMPORTANT: Modification of Pluggable Authentication Modules (PAM) now require user authorization, or use of a Privacy Preferences Policy Control (PPPC) profile from MDM that authorizes modifying system administrator files or full disk access.

NOTE: /etc/pam.d/su will be automatically modified to its original state following any update or major upgrade to the operating system.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_pam_su_smartcard_enforce_recommended" test_ref="oval:mscp:tst:87"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:88" version="1" class="compliance">
          <metadata>
            <title>Disable Password Authentication for SSH</title>
            <reference source="CCE" ref_id="CCE-95139-2"/>
            <reference source="macos_security" ref_id="auth_ssh_password_authentication_disable_recommended"/>
            <description>If remote login through SSH is enabled, password based authentication _MUST_ be disabled for user login.

All users _MUST_ go through multifactor authentication to prevent unauthenticated access and potential compromise to the system.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.</description>
          </metadata>
          <criteria>
            <criterion comment="auth_ssh_password_authentication_disable_recommended" test_ref="oval:mscp:tst:88"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:89" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Deletions of Object Attributes</title>
            <reference source="CCE" ref_id="CCE-95118-6"/>
            <reference source="macos_security" ref_id="audit_flags_fd_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of attempts to delete file attributes (fd).

***Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to delete a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_fd_configure_recommended" test_ref="oval:mscp:tst:89"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:91" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Folders Group to Wheel</title>
            <reference source="CCE" ref_id="CCE-95124-4"/>
            <reference source="macos_security" ref_id="audit_folder_group_configure_recommended"/>
            <description>Audit log files _MUST_ have the group set to wheel.

The audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_folder_group_configure_recommended" test_ref="oval:mscp:tst:91"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:92" version="1" class="compliance">
          <metadata>
            <title>Configure System to Shut Down Upon Audit Failure</title>
            <reference source="CCE" ref_id="CCE-95111-1"/>
            <reference source="macos_security" ref_id="audit_failure_halt_recommended"/>
            <description>The audit service _MUST_ be configured to shut down the computer if it is unable to audit system events.

Once audit failure occurs, user and system activity are no longer recorded, and malicious activity could go undetected. Audit processing failures can occur due to software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_failure_halt_recommended" test_ref="oval:mscp:tst:92"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:93" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Failed Change of Object Attributes</title>
            <reference source="CCE" ref_id="CCE-95120-2"/>
            <reference source="macos_security" ref_id="audit_flags_fm_failed_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of failed attempts to modify file attributes (-fm).

Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., denying modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to modify a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_fm_failed_configure_recommended" test_ref="oval:mscp:tst:93"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:96" version="1" class="compliance">
          <metadata>
            <title>Configure Audit_Control Owner to Mode 440 or Less Permissive</title>
            <reference source="CCE" ref_id="CCE-95108-7"/>
            <reference source="macos_security" ref_id="audit_control_mode_configure_recommended"/>
            <description>/etc/security/audit_control _MUST_ be configured so that it is readable only by the root user and group wheel.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_control_mode_configure_recommended" test_ref="oval:mscp:tst:96"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:97" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Folder to Not Contain Access Control Lists</title>
            <reference source="CCE" ref_id="CCE-95102-0"/>
            <reference source="macos_security" ref_id="audit_acls_folders_configure_recommended"/>
            <description>The audit log folder _MUST_ not contain access control lists (ACLs).

Audit logs contain sensitive data about the system and users. This rule ensures that the audit service is configured to create log folders that are readable and writable only by system administrators in order to prevent normal users from reading audit logs.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_acls_folders_configure_recommended" test_ref="oval:mscp:tst:97"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:98" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Changes of Object Attributes</title>
            <reference source="CCE" ref_id="CCE-95119-4"/>
            <reference source="macos_security" ref_id="audit_flags_fm_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of attempts to modify file attributes (fm).

Enforcement actions are the methods or mechanisms used to prevent unauthorized changes to configuration settings. One common and effective enforcement action method is using access restrictions (i.e., modifications to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions attempts to modify a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_fm_configure_recommended" test_ref="oval:mscp:tst:98"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:99" version="1" class="compliance">
          <metadata>
            <title>Enable Security Auditing</title>
            <reference source="CCE" ref_id="CCE-95104-6"/>
            <reference source="macos_security" ref_id="audit_auditd_enabled_recommended"/>
            <description>The information system _MUST_ be configured to generate audit records.

Audit records establish what types of events have occurred, when they occurred, and which users were involved. These records aid an organization in their efforts to establish, correlate, and investigate the events leading up to an outage or attack.

The content required to be captured in an audit record varies based on the impact level of an organization's system. Content that may be necessary to satisfy this requirement includes, for example, time stamps, source addresses, destination addresses, user identifiers, event descriptions, success/fail indications, filenames involved, and access or flow control rules invoked.

The information system initiates session audits at system start-up.

NOTE: Security auditing is NOT enabled by default on macOS Tahoe.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_auditd_enabled_recommended" test_ref="oval:mscp:tst:99"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:100" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Administrative Action Events</title>
            <reference source="CCE" ref_id="CCE-95116-0"/>
            <reference source="macos_security" ref_id="audit_flags_ad_configure_recommended"/>
            <description>The auditing system _MUST_ be configured to flag administrative action (ad) events.

Administrative action events include changes made to the system (e.g. modifying authentication policies). If audit records do not include ad events, it is difficult to identify incidents and to correlate incidents to subsequent events.

Audit records can be generated from various components within the information system (e.g., via a module or policy filter).

The information system audits the execution of privileged functions.

NOTE: We recommend changing the line "43127:AUE_MAC_SYSCALL:mac_syscall(2):ad" to "43127:AUE_MAC_SYSCALL:mac_syscall(2):zz" in the file /etc/security/audit_event. This will prevent sandbox violations from being audited by the ad flag.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_ad_configure_recommended" test_ref="oval:mscp:tst:100"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:101" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Failed Program Execution on the System</title>
            <reference source="CCE" ref_id="CCE-95117-8"/>
            <reference source="macos_security" ref_id="audit_flags_ex_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed program execute (-ex) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using program execution restrictions (e.g., denying users access to execute certain processes).

This configuration ensures that audit lists include events in which program execution has failed.
Without auditing the enforcement of program execution, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_ex_configure_recommended" test_ref="oval:mscp:tst:101"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:102" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Files to Mode 440 or Less Permissive</title>
            <reference source="CCE" ref_id="CCE-95113-7"/>
            <reference source="macos_security" ref_id="audit_files_mode_configure_recommended"/>
            <description>The audit service _MUST_ be configured to create log files that are readable only by the root user and group wheel. To achieve this, audit log files _MUST_ be configured to mode 440 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_files_mode_configure_recommended" test_ref="oval:mscp:tst:102"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:103" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Authorization and Authentication Events</title>
            <reference source="CCE" ref_id="CCE-95115-2"/>
            <reference source="macos_security" ref_id="audit_flags_aa_configure_recommended"/>
            <description>The auditing system _MUST_ be configured to flag authorization and authentication (aa) events.

Authentication events contain information about the identity of a user, server, or client. Authorization events contain information about permissions, rights, and rules. If audit records do not include aa events, it is difficult to identify incidents and to correlate incidents to subsequent events.

Audit records can be generated from various components within the information system (e.g., via a module or policy filter).</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_aa_configure_recommended" test_ref="oval:mscp:tst:103"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:104" version="1" class="compliance">
          <metadata>
            <title>Configure Audit_Control Owner to Root</title>
            <reference source="CCE" ref_id="CCE-95109-5"/>
            <reference source="macos_security" ref_id="audit_control_owner_configure_recommended"/>
            <description>/etc/security/audit_control _MUST_ have the owner set to root.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_control_owner_configure_recommended" test_ref="oval:mscp:tst:104"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:105" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Files to be Owned by Root</title>
            <reference source="CCE" ref_id="CCE-95114-5"/>
            <reference source="macos_security" ref_id="audit_files_owner_configure_recommended"/>
            <description>Audit log files _MUST_ be owned by root.

The audit service _MUST_ be configured to create log files with the correct ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_files_owner_configure_recommended" test_ref="oval:mscp:tst:105"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:106" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Retention to 7d</title>
            <reference source="CCE" ref_id="CCE-95130-1"/>
            <reference source="macos_security" ref_id="audit_retention_configure_recommended"/>
            <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "7d", the audit service will not delete audit logs until the log data criteria is met.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_retention_configure_recommended" test_ref="oval:mscp:tst:106"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:107" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Retention to 60d OR 5G</title>
            <reference source="CCE" ref_id="CCE-95130-1"/>
            <reference source="macos_security" ref_id="audit_retention_configure_cis_lvl1"/>
            <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "60d OR 5G", the audit service will not delete audit logs until the log data criteria is met.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_retention_configure_cis_lvl1" test_ref="oval:mscp:tst:107"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:108" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Retention to 60d OR 5G</title>
            <reference source="CCE" ref_id="CCE-95130-1"/>
            <reference source="macos_security" ref_id="audit_retention_configure_cis_lvl2"/>
            <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "60d OR 5G", the audit service will not delete audit logs until the log data criteria is met.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_retention_configure_cis_lvl2" test_ref="oval:mscp:tst:108"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:109" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Retention to 7d</title>
            <reference source="CCE" ref_id="CCE-95130-1"/>
            <reference source="macos_security" ref_id="audit_retention_configure_stig"/>
            <description>The audit service _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.

When "expire-after" is set to "7d", the audit service will not delete audit logs until the log data criteria is met.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_retention_configure_stig" test_ref="oval:mscp:tst:109"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:110" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Failed Read Actions on the System</title>
            <reference source="CCE" ref_id="CCE-95121-0"/>
            <reference source="macos_security" ref_id="audit_flags_fr_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file read (-fr) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying access to a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to read a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_fr_configure_recommended" test_ref="oval:mscp:tst:110"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:111" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Failure Notification</title>
            <reference source="CCE" ref_id="CCE-95131-9"/>
            <reference source="macos_security" ref_id="audit_settings_failure_notify_recommended"/>
            <description>The audit service _MUST_ be configured to immediately print messages to the console or email administrator users when an auditing failure occurs.

It is critical for the appropriate personnel to be made aware immediately if a system is at risk of failing to process audit logs as required. Without a real-time alert, security personnel may be unaware of a potentially harmful failure in the auditing system's capability, and system operation may be adversely affected.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_settings_failure_notify_recommended" test_ref="oval:mscp:tst:111"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:112" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Folders to be Owned by Root</title>
            <reference source="CCE" ref_id="CCE-95125-1"/>
            <reference source="macos_security" ref_id="audit_folder_owner_configure_recommended"/>
            <description>Audit log folders _MUST_ be owned by root.

The audit service _MUST_ be configured to create log folders with the correct ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log folders are set to only be readable and writable by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_folder_owner_configure_recommended" test_ref="oval:mscp:tst:112"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:114" version="1" class="compliance">
          <metadata>
            <title>Configure Audit_Control to Not Contain Access Control Lists</title>
            <reference source="CCE" ref_id="CCE-95106-1"/>
            <reference source="macos_security" ref_id="audit_control_acls_configure_recommended"/>
            <description>/etc/security/audit_control _MUST_ not contain Access Control Lists (ACLs).</description>
          </metadata>
          <criteria>
            <criterion comment="audit_control_acls_configure_recommended" test_ref="oval:mscp:tst:114"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:115" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Log In and Log Out Events</title>
            <reference source="CCE" ref_id="CCE-95123-6"/>
            <reference source="macos_security" ref_id="audit_flags_lo_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record all attempts to log in and out of the system (lo).

Frequently, an attacker that successfully gains access to a system has only gained access to an account with limited privileges, such as a guest account or a service account. The attacker must attempt to change to another user account with normal or elevated privileges in order to proceed. Auditing both successful and unsuccessful attempts to switch to another user account (by way of monitoring login and logout events) mitigates this risk.

The information system monitors login and logout events.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_lo_configure_recommended" test_ref="oval:mscp:tst:115"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:117" version="1" class="compliance">
          <metadata>
            <title>Configure System to Audit All Failed Write Actions on the System</title>
            <reference source="CCE" ref_id="CCE-95122-8"/>
            <reference source="macos_security" ref_id="audit_flags_fw_configure_recommended"/>
            <description>The audit system _MUST_ be configured to record enforcement actions of access restrictions, including failed file write (-fw) attempts.

Enforcement actions are the methods or mechanisms used to prevent unauthorized access and/or changes to configuration settings. One common and effective enforcement action method is using access restrictions (e.g., denying users access to edit a file by applying file permissions).

This configuration ensures that audit lists include events in which enforcement actions prevent attempts to change a file.

Without auditing the enforcement of access restrictions, it is difficult to identify attempted attacks, as there is no audit trail available for forensic investigation.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_flags_fw_configure_recommended" test_ref="oval:mscp:tst:117"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:118" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Folders to Mode 700 or Less Permissive</title>
            <reference source="CCE" ref_id="CCE-95126-9"/>
            <reference source="macos_security" ref_id="audit_folders_mode_configure_recommended"/>
            <description>The audit log folder _MUST_ be configured to mode 700 or less permissive so that only the root user is able to read, write, and execute changes to folders.

Because audit logs contain sensitive data about the system and users, the audit service _MUST_ be configured to mode 700 or less permissive; thereby preventing normal users from reading, modifying or deleting audit logs.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_folders_mode_configure_recommended" test_ref="oval:mscp:tst:118"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:119" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Capacity Warning</title>
            <reference source="CCE" ref_id="CCE-95105-3"/>
            <reference source="macos_security" ref_id="audit_configure_capacity_notify_recommended"/>
            <description>The audit service _MUST_ be configured to notify the system administrator when the amount of free disk space remaining reaches an organization defined value.

This rule ensures that the system administrator is notified in advance that action is required to free up more disk space for audit logs.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_configure_capacity_notify_recommended" test_ref="oval:mscp:tst:119"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:120" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Capacity Warning</title>
            <reference source="CCE" ref_id="CCE-95105-3"/>
            <reference source="macos_security" ref_id="audit_configure_capacity_notify_stig"/>
            <description>The audit service _MUST_ be configured to notify the system administrator when the amount of free disk space remaining reaches an organization defined value.

This rule ensures that the system administrator is notified in advance that action is required to free up more disk space for audit logs.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_configure_capacity_notify_stig" test_ref="oval:mscp:tst:120"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:121" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Files Group to Wheel</title>
            <reference source="CCE" ref_id="CCE-95112-9"/>
            <reference source="macos_security" ref_id="audit_files_group_configure_recommended"/>
            <description>Audit log files _MUST_ have the group set to wheel.

The audit service _MUST_ be configured to create log files with the correct group ownership to prevent normal users from reading audit logs.

Audit logs contain sensitive data about the system and users. If log files are set to be readable and writable only by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_files_group_configure_recommended" test_ref="oval:mscp:tst:121"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:122" version="1" class="compliance">
          <metadata>
            <title>Configure Audit_Control Group to Wheel</title>
            <reference source="CCE" ref_id="CCE-95107-9"/>
            <reference source="macos_security" ref_id="audit_control_group_configure_recommended"/>
            <description>/etc/security/audit_control _MUST_ have the group set to wheel.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_control_group_configure_recommended" test_ref="oval:mscp:tst:122"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:123" version="1" class="compliance">
          <metadata>
            <title>Configure Audit Log Files to Not Contain Access Control Lists</title>
            <reference source="CCE" ref_id="CCE-95101-2"/>
            <reference source="macos_security" ref_id="audit_acls_files_configure_recommended"/>
            <description>The audit log files _MUST_ not contain access control lists (ACLs).

This rule ensures that audit information and audit files are configured to be readable and writable only by system administrators, thereby preventing unauthorized access, modification, and deletion of files.</description>
          </metadata>
          <criteria>
            <criterion comment="audit_acls_files_configure_recommended" test_ref="oval:mscp:tst:123"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:126" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD Unused Connection Timeout to 900</title>
            <reference source="CCE" ref_id="CCE-95314-1"/>
            <reference source="macos_security" ref_id="os_sshd_unused_connection_timeout_configure_recommended"/>
            <description>If SSHD is enabled it _MUST_ be configured with unused connection timeout set to 900.

This will set the time out when there are no open channels within an session.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_unused_connection_timeout_configure_recommended" test_ref="oval:mscp:tst:126"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:127" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD Unused Connection Timeout to 900</title>
            <reference source="CCE" ref_id="CCE-95314-1"/>
            <reference source="macos_security" ref_id="os_sshd_unused_connection_timeout_configure_stig"/>
            <description>If SSHD is enabled it _MUST_ be configured with unused connection timeout set to 900.

This will set the time out when there are no open channels within an session.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_unused_connection_timeout_configure_stig" test_ref="oval:mscp:tst:127"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:129" version="1" class="compliance">
          <metadata>
            <title>Set Login Grace Time to 30</title>
            <reference source="CCE" ref_id="CCE-95311-7"/>
            <reference source="macos_security" ref_id="os_sshd_login_grace_time_configure_recommended"/>
            <description>If SSHD is enabled then it _MUST_ be configured to wait only 30 seconds before timing out logon attempts.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_login_grace_time_configure_recommended" test_ref="oval:mscp:tst:129"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:130" version="1" class="compliance">
          <metadata>
            <title>Set Login Grace Time to 30</title>
            <reference source="CCE" ref_id="CCE-95311-7"/>
            <reference source="macos_security" ref_id="os_sshd_login_grace_time_configure_stig"/>
            <description>If SSHD is enabled then it _MUST_ be configured to wait only 30 seconds before timing out logon attempts.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_login_grace_time_configure_stig" test_ref="oval:mscp:tst:130"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:132" version="1" class="compliance">
          <metadata>
            <title>Configure System Log Files Owned by Root and Group to Wheel</title>
            <reference source="CCE" ref_id="CCE-95233-3"/>
            <reference source="macos_security" ref_id="os_newsyslog_files_owner_group_configure_recommended"/>
            <description>The system log files _MUST_ be owned by root.

System logs contain sensitive data about the system and users. If log files are set to only be readable and writable by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="os_newsyslog_files_owner_group_configure_recommended" test_ref="oval:mscp:tst:132"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:133" version="1" class="compliance">
          <metadata>
            <title>Control Connections to Other Systems via a Deny-All and Allow-by-Exception Firewall Policy</title>
            <reference source="CCE" ref_id="CCE-95193-9"/>
            <reference source="macos_security" ref_id="os_firewall_default_deny_require_recommended"/>
            <description>A deny-all and allow-by-exception firewall policy _MUST_ be employed for managing connections to other systems.

Organizations _MUST_ ensure the built-in packet filter firewall is configured correctly to employ the default deny rule.

Failure to restrict network connectivity to authorized systems permits inbound connections from malicious systems. It also permits outbound connections that may facilitate the exfiltration of data.

If you are using a third-party firewall solution, this setting does not apply.

[IMPORTANT]
====
Configuring the built-in packet filter firewall to employ the default deny rule has the potential to interfere with applications on the system in an unpredictable manner. Information System Security Officers (ISSOs) may make the risk-based decision not to configure the built-in packet filter firewall to employ the default deny rule to avoid losing functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_firewall_default_deny_require_recommended" test_ref="oval:mscp:tst:133"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:136" version="1" class="compliance">
          <metadata>
            <title>Disable DVD-RAM</title>
            <reference source="CCE" ref_id="CCE-95183-0"/>
            <reference source="macos_security" ref_id="os_dvdram_disable_recommended"/>
            <description>DVD-RAM media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_dvdram_disable_recommended" test_ref="oval:mscp:tst:136"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:138" version="1" class="compliance">
          <metadata>
            <title>Limit SSHD to FIPS Compliant Connections</title>
            <reference source="CCE" ref_id="CCE-95310-9"/>
            <reference source="macos_security" ref_id="os_sshd_fips_compliant_recommended"/>
            <description>If SSHD is enabled then it _MUST_ be configured to limit the Ciphers, HostbasedAcceptedAlgorithms, HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms, CASignatureAlgorithms to algorithms that are FIPS 140 validated.

FIPS 140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meet federal requirements.

Operating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.

NOTE: For more information on FIPS compliance with the version of SSHD included in the macOS, the manual page apple_ssh_and_fips has additional information.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_fips_compliant_recommended" test_ref="oval:mscp:tst:138"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:139" version="1" class="compliance">
          <metadata>
            <title>Enable Firmware Password</title>
            <reference source="CCE" ref_id="CCE-95194-7"/>
            <reference source="macos_security" ref_id="os_firmware_password_require_recommended"/>
            <description>A firmware password _MUST_ be enabled and set.

Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding the "Option" key down during startup. Setting a firmware password restricts access to these tools.

To set a firmware passcode use the following command:

[source,bash]
----
/usr/sbin/firmwarepasswd -setpasswd
----

NOTE: If firmware password or passcode is forgotten, the only way to reset the forgotten password is through the use of a machine specific binary generated and provided by Apple. Schedule a support call, and provide proof of purchase before the firmware binary will be generated.

NOTE: Firmware passwords are not supported on Apple Silicon devices. This rule is only applicable to Intel devices.</description>
          </metadata>
          <criteria>
            <criterion comment="os_firmware_password_require_recommended" test_ref="oval:mscp:tst:139"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:140" version="1" class="compliance">
          <metadata>
            <title>Disable Photos Enhanced Visual Search</title>
            <reference source="CCE" ref_id="CCE-95254-9"/>
            <reference source="macos_security" ref_id="os_photos_enhanced_search_disable_recommended"/>
            <description>Enhanced Visualed Search _MUST_ be disabled in the Photos app.

The information system _MUST_ be configured to provide only essential capabilities. Disabling Enhanced Visual Search will mitigate the risk of unwanted data being sent to Apple.</description>
          </metadata>
          <criteria>
            <criterion comment="os_photos_enhanced_search_disable_recommended" test_ref="oval:mscp:tst:140"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:141" version="1" class="compliance">
          <metadata>
            <title>Disable Power Nap</title>
            <reference source="CCE" ref_id="CCE-95260-6"/>
            <reference source="macos_security" ref_id="os_power_nap_disable_recommended"/>
            <description>Power Nap _MUST_ be disabled.

NOTE: Power Nap allows your Mac to perform actions while a Mac is asleep. This can interfere with USB power and may cause devices such as smartcards to stop functioning until a reboot and must therefore be disabled on all applicable systems.

The following Macs support Power Nap:

* MacBook (Early 2015 and later)
* MacBook Air (Late 2010 and later)
* MacBook Pro (all models with Retina display)
* Mac mini (Late 2012 and later)
* iMac (Late 2012 and later)
* Mac Pro (Late 2013 and later)</description>
          </metadata>
          <criteria>
            <criterion comment="os_power_nap_disable_recommended" test_ref="oval:mscp:tst:141"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:142" version="1" class="compliance">
          <metadata>
            <title>Ensure Warn When Visiting A Fraudulent Website in Safari Is Enabled</title>
            <reference source="CCE" ref_id="CCE-95289-5"/>
            <reference source="macos_security" ref_id="os_safari_warn_fraudulent_website_enable_recommended"/>
            <description>Warn when visiting a fraudulent website _MUST_ be enabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_warn_fraudulent_website_enable_recommended" test_ref="oval:mscp:tst:142"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:143" version="1" class="compliance">
          <metadata>
            <title>Enable Power Nap</title>
            <reference source="CCE" ref_id="CCE-95261-4"/>
            <reference source="macos_security" ref_id="os_power_nap_enable_recommended"/>
            <description>Power Nap _MUST_ be enabled.

NOTE: Power nap can interfere with USB power and may cause devices such as smartcards to stop functioning until a reboot.

The following Macs support Power Nap:

* MacBook (Early 2015 and later)
* MacBook Air (Late 2010 and later)
* MacBook Pro (all models with Retina display)
* Mac mini (Late 2012 and later)
* iMac (Late 2012 and later)
* Mac Pro (Late 2013 and later)</description>
          </metadata>
          <criteria>
            <criterion comment="os_power_nap_enable_recommended" test_ref="oval:mscp:tst:143"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:144" version="1" class="compliance">
          <metadata>
            <title>Disable Root Login</title>
            <reference source="CCE" ref_id="CCE-95282-0"/>
            <reference source="macos_security" ref_id="os_root_disable_recommended"/>
            <description>To assure individual accountability and prevent unauthorized access, logging in as root at the login window _MUST_ be disabled.

The macOS system _MUST_ require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users _MUST_ never log in directly as root.</description>
          </metadata>
          <criteria>
            <criterion comment="os_root_disable_recommended" test_ref="oval:mscp:tst:144"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:146" version="1" class="compliance">
          <metadata>
            <title>Enforce SSH to Display Policy Banner</title>
            <reference source="CCE" ref_id="CCE-95259-8"/>
            <reference source="macos_security" ref_id="os_policy_banner_ssh_enforce_recommended"/>
            <description>SSH _MUST_ be configured to display a policy banner.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_ssh_enforce_recommended" test_ref="oval:mscp:tst:146"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:148" version="1" class="compliance">
          <metadata>
            <title>Ensure Clearning of Browsing History in Safari Is Disabled</title>
            <reference source="CCE" ref_id="CCE-95601-1"/>
            <reference source="macos_security" ref_id="os_safari_clear_history_disable_recommended"/>
            <description>Clearing of browser history _MUST_ be disabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_clear_history_disable_recommended" test_ref="oval:mscp:tst:148"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:150" version="1" class="compliance">
          <metadata>
            <title>Disable Proximity Based Password Sharing Requests</title>
            <reference source="CCE" ref_id="CCE-95251-5"/>
            <reference source="macos_security" ref_id="os_password_proximity_disable_recommended"/>
            <description>Proximity based password sharing requests _MUST_ be disabled.

The default behavior of macOS is to allow users to request passwords from other known devices (macOS and iOS). This feature _MUST_ be disabled to prevent passwords from being shared.</description>
          </metadata>
          <criteria>
            <criterion comment="os_password_proximity_disable_recommended" test_ref="oval:mscp:tst:150"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:151" version="1" class="compliance">
          <metadata>
            <title>Enable Library Validation</title>
            <reference source="CCE" ref_id="CCE-95215-0"/>
            <reference source="macos_security" ref_id="os_library_validation_enabled_recommended"/>
            <description>Library validation  _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_library_validation_enabled_recommended" test_ref="oval:mscp:tst:151"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:152" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Notes Transcription</title>
            <reference source="CCE" ref_id="CCE-95238-2"/>
            <reference source="macos_security" ref_id="os_notes_transcription_disable_recommended"/>
            <description>Apple Intelligence features such as Notes Transcription that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_notes_transcription_disable_recommended" test_ref="oval:mscp:tst:152"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:153" version="1" class="compliance">
          <metadata>
            <title>Enforce Enrollment in Mobile Device Management</title>
            <reference source="CCE" ref_id="CCE-95227-5"/>
            <reference source="macos_security" ref_id="os_mdm_require_recommended"/>
            <description>You _MUST_ enroll your Mac in a Mobile Device Management (MDM) software.

User Approved MDM (UAMDM) enrollment or enrollment via Apple Business Manager (ABM)/Apple School Manager (ASM) is required to manage certain security settings. Currently these include:

* Allowed Kernel Extensions
* Allowed Approved System Extensions
* Privacy Preferences Policy Control Payload
* ExtensibleSingleSignOn
* FDEFileVault

In macOS 11, UAMDM grants Supervised status on a Mac, unlocking the following MDM features, which were previously locked behind ABM:

* Activation Lock Bypass
* Access to Bootstrap Tokens
* Scheduling Software Updates
* Query list and delete local users</description>
          </metadata>
          <criteria>
            <criterion comment="os_mdm_require_recommended" test_ref="oval:mscp:tst:153"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:154" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence During Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95603-7"/>
            <reference source="macos_security" ref_id="os_skip_apple_intelligence_enable_recommended"/>
            <description>The prompt for setting up Apple Intelligence during Setup Assistant _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_skip_apple_intelligence_enable_recommended" test_ref="oval:mscp:tst:154"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:159" version="1" class="compliance">
          <metadata>
            <title>Must Use an Approved Antivirus Program</title>
            <reference source="CCE" ref_id="CCE-95158-2"/>
            <reference source="macos_security" ref_id="os_anti_virus_installed_recommended"/>
            <description>An approved antivirus product _MUST_ be installed and configured to run.

Malicious software can establish a base on individual desktops and servers. Employing an automated mechanism to detect this type of software will aid in elimination of the software from the operating system.'</description>
          </metadata>
          <criteria>
            <criterion comment="os_anti_virus_installed_recommended" test_ref="oval:mscp:tst:159"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:161" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver at Login Window</title>
            <reference source="CCE" ref_id="CCE-95290-3"/>
            <reference source="macos_security" ref_id="os_screensaver_loginwindow_enforce_recommended"/>
            <description>A default screen saver _MUST_ be configured to display at the login window and _MUST_ not display any sensitive information.</description>
          </metadata>
          <criteria>
            <criterion comment="os_screensaver_loginwindow_enforce_recommended" test_ref="oval:mscp:tst:161"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:162" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Mail Smart Replies</title>
            <reference source="CCE" ref_id="CCE-95222-6"/>
            <reference source="macos_security" ref_id="os_mail_smart_reply_disable_recommended"/>
            <description>Apple Intelligence features such as Mail Smart Replies that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_mail_smart_reply_disable_recommended" test_ref="oval:mscp:tst:162"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:163" version="1" class="compliance">
          <metadata>
            <title>Ensure No World Writable Files Exist in the System Folder</title>
            <reference source="CCE" ref_id="CCE-95333-1"/>
            <reference source="macos_security" ref_id="os_world_writable_system_folder_configure_recommended"/>
            <description>Folders in /System/Volumes/Data/System _MUST_ not be world-writable.</description>
          </metadata>
          <criteria>
            <criterion comment="os_world_writable_system_folder_configure_recommended" test_ref="oval:mscp:tst:163"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:164" version="1" class="compliance">
          <metadata>
            <title>Disable Handoff</title>
            <reference source="CCE" ref_id="CCE-95199-6"/>
            <reference source="macos_security" ref_id="os_handoff_disable_recommended"/>
            <description>Handoff _MUST_ be disabled.

Handoff allows you to continue working on a document or project when the user switches from one Apple device to another. Disabling Handoff prevents data transfers to unauthorized devices.</description>
          </metadata>
          <criteria>
            <criterion comment="os_handoff_disable_recommended" test_ref="oval:mscp:tst:164"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:166" version="1" class="compliance">
          <metadata>
            <title>Disable iPhone Mirroring</title>
            <reference source="CCE" ref_id="CCE-95212-7"/>
            <reference source="macos_security" ref_id="os_iphone_mirroring_disable_recommended"/>
            <description>iPhone Mirroing _MUST_ be disabled to prevent file transfers to or from unauthorized devices. Disabling iPhone Mirroring also prevents potentially unauthorized applications from appearing as if they are installed on the Mac.</description>
          </metadata>
          <criteria>
            <criterion comment="os_iphone_mirroring_disable_recommended" test_ref="oval:mscp:tst:166"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:170" version="1" class="compliance">
          <metadata>
            <title>Disable Automatic Opening of Safe Files in Safari</title>
            <reference source="CCE" ref_id="CCE-95284-6"/>
            <reference source="macos_security" ref_id="os_safari_open_safe_downloads_disable_recommended"/>
            <description>Open "safe" files after downloading _MUST_ be disabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_open_safe_downloads_disable_recommended" test_ref="oval:mscp:tst:170"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:171" version="1" class="compliance">
          <metadata>
            <title>Configure SSH ServerAliveInterval option set to 900</title>
            <reference source="CCE" ref_id="CCE-95306-7"/>
            <reference source="macos_security" ref_id="os_ssh_server_alive_interval_configure_recommended"/>
            <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 900.

Setting the Active Server Alive Maximum Count to 900 will log users out after a 900 seconds interval of inactivity.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ssh_server_alive_interval_configure_recommended" test_ref="oval:mscp:tst:171"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:172" version="1" class="compliance">
          <metadata>
            <title>Configure SSH ServerAliveInterval option set to 900</title>
            <reference source="CCE" ref_id="CCE-95306-7"/>
            <reference source="macos_security" ref_id="os_ssh_server_alive_interval_configure_stig"/>
            <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 900.

Setting the Active Server Alive Maximum Count to 900 will log users out after a 900 seconds interval of inactivity.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ssh_server_alive_interval_configure_stig" test_ref="oval:mscp:tst:172"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:173" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Mail Summary</title>
            <reference source="CCE" ref_id="CCE-95223-4"/>
            <reference source="macos_security" ref_id="os_mail_summary_disable_recommended"/>
            <description>Apple Intelligence features such as Apple Mail Summary that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_mail_summary_disable_recommended" test_ref="oval:mscp:tst:173"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:174" version="1" class="compliance">
          <metadata>
            <title>Limit SSH to FIPS Compliant Connections</title>
            <reference source="CCE" ref_id="CCE-95304-2"/>
            <reference source="macos_security" ref_id="os_ssh_fips_compliant_recommended"/>
            <description>SSH _MUST_ be configured to limit the Ciphers, HostbasedAcceptedAlgorithms, HostKeyAlgorithms, KexAlgorithms, MACs, PubkeyAcceptedAlgorithms, CASignatureAlgorithms to algorithms that are FIPS 140 validated.

FIPS 140-3 is the current standard for validating that mechanisms used to access cryptographic modules utilize authentication that meet federal requirements.

Operating systems utilizing encryption _MUST_ use FIPS validated mechanisms for authenticating to cryptographic modules.

NOTE: For more information on FIPS compliance with the version of SSH included in the macOS, the manual page apple_ssh_and_fips has additional information.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ssh_fips_compliant_recommended" test_ref="oval:mscp:tst:174"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:178" version="1" class="compliance">
          <metadata>
            <title>Enforce Rapid Security Response Mechanism</title>
            <reference source="CCE" ref_id="CCE-95272-1"/>
            <reference source="macos_security" ref_id="os_rapid_security_response_allow_recommended"/>
            <description>Rapid security response mechanism _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_rapid_security_response_allow_recommended" test_ref="oval:mscp:tst:178"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:181" version="1" class="compliance">
          <metadata>
            <title>Network Storage Must Be Restricted</title>
            <reference source="CCE" ref_id="CCE-95232-5"/>
            <reference source="macos_security" ref_id="os_network_storage_restriction_recommended"/>
            <description>Network Storage _MUST_ be restricted. 

NOTE: Apple's built in method using declative device management method only allows you to set network storage manament to Allowed, ReadOnly, and Disallowed.</description>
          </metadata>
          <criteria>
            <criterion comment="os_network_storage_restriction_recommended" test_ref="oval:mscp:tst:181"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:182" version="1" class="compliance">
          <metadata>
            <title>Ensure Time Offset Within Limits</title>
            <reference source="CCE" ref_id="CCE-95324-0"/>
            <reference source="macos_security" ref_id="os_time_offset_limit_configure_recommended"/>
            <description>The macOS system time  _MUST_ be monitored to not drift more than four minutes and thirty seconds.</description>
          </metadata>
          <criteria>
            <criterion comment="os_time_offset_limit_configure_recommended" test_ref="oval:mscp:tst:182"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:183" version="1" class="compliance">
          <metadata>
            <title>Disable Trivial File Transfer Protocol Service</title>
            <reference source="CCE" ref_id="CCE-95323-2"/>
            <reference source="macos_security" ref_id="os_tftpd_disable_recommended"/>
            <description>If the system does not require Trivial File Transfer Protocol (TFTP), support it is non-essential and _MUST_ be disabled.

The information system _MUST_ be configured to provide only essential capabilities. Disabling TFTP helps prevent the unauthorized connection of devices and the unauthorized transfer of information.

NOTE: TFTP service is disabled at startup by default macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_tftpd_disable_recommended" test_ref="oval:mscp:tst:183"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:184" version="1" class="compliance">
          <metadata>
            <title>Disable Password Autofill</title>
            <reference source="CCE" ref_id="CCE-95249-9"/>
            <reference source="macos_security" ref_id="os_password_autofill_disable_recommended"/>
            <description>Password Autofill _MUST_ be disabled.

macOS allows users to save passwords and use the Password Autofill feature in Safari and compatible apps. To protect against malicious users gaining access to the system, this feature _MUST_ be disabled to prevent users from being prompted to save passwords in applications.</description>
          </metadata>
          <criteria>
            <criterion comment="os_password_autofill_disable_recommended" test_ref="oval:mscp:tst:184"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:185" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD ClientAliveInterval to 900</title>
            <reference source="CCE" ref_id="CCE-95309-1"/>
            <reference source="macos_security" ref_id="os_sshd_client_alive_interval_configure_recommended"/>
            <description>If SSHD is enabled then it _MUST_ be configured with the Client Alive Interval set to 900.

Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client.

This setting works in conjunction with ClientAliveCountMax to determine the termination of the connection after the threshold has been reached.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_client_alive_interval_configure_recommended" test_ref="oval:mscp:tst:185"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:186" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD ClientAliveInterval to 900</title>
            <reference source="CCE" ref_id="CCE-95309-1"/>
            <reference source="macos_security" ref_id="os_sshd_client_alive_interval_configure_stig"/>
            <description>If SSHD is enabled then it _MUST_ be configured with the Client Alive Interval set to 900.

Sets a timeout interval in seconds after which if no data has been received from the client, sshd(8) will send a message through the encrypted channel to request a response from the client.

This setting works in conjunction with ClientAliveCountMax to determine the termination of the connection after the threshold has been reached.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_client_alive_interval_configure_stig" test_ref="oval:mscp:tst:186"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:188" version="1" class="compliance">
          <metadata>
            <title>Configure Apple System Log Files To Mode 640 or Less Permissive</title>
            <reference source="CCE" ref_id="CCE-95162-4"/>
            <reference source="macos_security" ref_id="os_asl_log_files_permissions_configure_recommended"/>
            <description>The Apple System Logs (ASL) _MUST_ be configured to be writable by root and readable only by the root user and group wheel. To achieve this, ASL log files _MUST_ be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.</description>
          </metadata>
          <criteria>
            <criterion comment="os_asl_log_files_permissions_configure_recommended" test_ref="oval:mscp:tst:188"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:191" version="1" class="compliance">
          <metadata>
            <title>Ensure Private Browsing in Safari Is Disabled</title>
            <reference source="CCE" ref_id="CCE-95599-7"/>
            <reference source="macos_security" ref_id="os_safari_private_browsing_disable_recommended"/>
            <description>Private browsing _MUST_ be disabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_private_browsing_disable_recommended" test_ref="oval:mscp:tst:191"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:192" version="1" class="compliance">
          <metadata>
            <title>Disable Password Sharing</title>
            <reference source="CCE" ref_id="CCE-95252-3"/>
            <reference source="macos_security" ref_id="os_password_sharing_disable_recommended"/>
            <description>Password Sharing _MUST_ be disabled.

The default behavior of macOS is to allow users to share a password over Airdrop between other macOS and iOS devices. This feature _MUST_ be disabled to prevent passwords from being shared.</description>
          </metadata>
          <criteria>
            <criterion comment="os_password_sharing_disable_recommended" test_ref="oval:mscp:tst:192"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:193" version="1" class="compliance">
          <metadata>
            <title>Disable Blank Blu Ray</title>
            <reference source="CCE" ref_id="CCE-95165-7"/>
            <reference source="macos_security" ref_id="os_blank_bluray_disable_recommended"/>
            <description>Blank Blu Ray media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_blank_bluray_disable_recommended" test_ref="oval:mscp:tst:193"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:195" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Notes Transcription Summary</title>
            <reference source="CCE" ref_id="CCE-95239-0"/>
            <reference source="macos_security" ref_id="os_notes_transcription_summary_disable_recommended"/>
            <description>Apple Intelligence features such as Notes Transcription Summary that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_notes_transcription_summary_disable_recommended" test_ref="oval:mscp:tst:195"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:197" version="1" class="compliance">
          <metadata>
            <title>Enable Authenticated Root</title>
            <reference source="CCE" ref_id="CCE-95164-0"/>
            <reference source="macos_security" ref_id="os_authenticated_root_enable_recommended"/>
            <description>Authenticated Root _MUST_ be enabled.

When Authenticated Root is enabled the macOS is booted from a signed volume that is cryptographically protected to prevent tampering with the system volume.

NOTE: Authenticated Root is enabled by default on macOS systems.

WARNING: If more than one partition with macOS is detected, the csrutil command will hang awaiting input.</description>
          </metadata>
          <criteria>
            <criterion comment="os_authenticated_root_enable_recommended" test_ref="oval:mscp:tst:197"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:198" version="1" class="compliance">
          <metadata>
            <title>Enforce Screen Saver Timeout at LoginWindow</title>
            <reference source="CCE" ref_id="CCE-95291-1"/>
            <reference source="macos_security" ref_id="os_screensaver_timeout_loginwindow_enforce_recommended"/>
            <description>The screen saver timeout at LoginWindow _MUST_ be set to 1200 seconds or a shorter length of time.

This rule ensures that a full session lock is triggered within no more than 1200 seconds of inactivity.</description>
          </metadata>
          <criteria>
            <criterion comment="os_screensaver_timeout_loginwindow_enforce_recommended" test_ref="oval:mscp:tst:198"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:200" version="1" class="compliance">
          <metadata>
            <title>Ensure Advertising Privacy Protection in Safari Is Enabled</title>
            <reference source="CCE" ref_id="CCE-95283-8"/>
            <reference source="macos_security" ref_id="os_safari_advertising_privacy_protection_enable_recommended"/>
            <description>Allow privacy-preserving measurement of ad effectiveness _MUST_ be enabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_advertising_privacy_protection_enable_recommended" test_ref="oval:mscp:tst:200"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:202" version="1" class="compliance">
          <metadata>
            <title>Enforce Installation of XProtect Remediator and Gatekeeper Updates Automatically</title>
            <reference source="CCE" ref_id="CCE-95176-4"/>
            <reference source="macos_security" ref_id="os_config_data_install_enforce_recommended"/>
            <description>Software Update _MUST_ be configured to update XProtect Remediator and Gatekeeper automatically.

This setting enforces definition updates for XProtect Remediator and Gatekeeper; with this setting in place, new malware and adware that Apple has added to the list of malware or untrusted software will not execute. These updates do not require the computer to be restarted.

link:https://support.apple.com/en-us/HT207005[]

NOTE: Software update will automatically update XProtect Remediator and Gatekeeper by default in the macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_config_data_install_enforce_recommended" test_ref="oval:mscp:tst:202"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:203" version="1" class="compliance">
          <metadata>
            <title>Enforce FileVault in Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95296-0"/>
            <reference source="macos_security" ref_id="os_setup_assistant_filevault_enforce_recommended"/>
            <description>FileVault _MUST_ be enforced in Setup Assistant.

The information system implements cryptographic mechanisms to protect the confidentiality and integrity of information stored on digital media during transport outside of controlled areas.</description>
          </metadata>
          <criteria>
            <criterion comment="os_setup_assistant_filevault_enforce_recommended" test_ref="oval:mscp:tst:203"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:207" version="1" class="compliance">
          <metadata>
            <title>Ensure Sleep and Display Sleep Is Enabled on Apple Silicon Devices</title>
            <reference source="CCE" ref_id="CCE-95302-6"/>
            <reference source="macos_security" ref_id="os_sleep_and_display_sleep_apple_silicon_enable_recommended"/>
            <description>Apple Silicon MacBooks should set sleep timeout to 15 minutes (900 seconds) or less and the display sleep timeout should be 10 minutes (600 seconds) or less but less than the sleep setting.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sleep_and_display_sleep_apple_silicon_enable_recommended" test_ref="oval:mscp:tst:207"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:208" version="1" class="compliance">
          <metadata>
            <title>Remove Guest Folder if Present</title>
            <reference source="CCE" ref_id="CCE-95198-8"/>
            <reference source="macos_security" ref_id="os_guest_folder_removed_recommended"/>
            <description>The guest folder _MUST_ be deleted if present.</description>
          </metadata>
          <criteria>
            <criterion comment="os_guest_folder_removed_recommended" test_ref="oval:mscp:tst:208"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:210" version="1" class="compliance">
          <metadata>
            <title>Remove Password Hint From User Accounts</title>
            <reference source="CCE" ref_id="CCE-95250-7"/>
            <reference source="macos_security" ref_id="os_password_hint_remove_recommended"/>
            <description>User accounts _MUST_ not contain password hints.</description>
          </metadata>
          <criteria>
            <criterion comment="os_password_hint_remove_recommended" test_ref="oval:mscp:tst:210"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:211" version="1" class="compliance">
          <metadata>
            <title>Disable Disk Images</title>
            <reference source="CCE" ref_id="CCE-95182-2"/>
            <reference source="macos_security" ref_id="os_disk_image_disable_recommended"/>
            <description>Disk images _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_disk_image_disable_recommended" test_ref="oval:mscp:tst:211"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:212" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD ClientAliveCountMax to 0</title>
            <reference source="CCE" ref_id="CCE-95308-3"/>
            <reference source="macos_security" ref_id="os_sshd_client_alive_count_max_configure_recommended"/>
            <description>If SSHD is enabled it _MUST_ be configured with the Client Alive Maximum Count set to 0.

This will set the number of client alive messages which may be sent without the SSH server receiving any messages back from the client.  If this threshold is reached while client alive messages are being sent, the SSH server will disconnect the client, terminating the session.  The client alive messages are sent through the encrypted channel and therefore will not be spoofable.  The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_client_alive_count_max_configure_recommended" test_ref="oval:mscp:tst:212"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:213" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD ClientAliveCountMax to 1</title>
            <reference source="CCE" ref_id="CCE-95308-3"/>
            <reference source="macos_security" ref_id="os_sshd_client_alive_count_max_configure_stig"/>
            <description>If SSHD is enabled it _MUST_ be configured with the Client Alive Maximum Count set to 1.

This will set the number of client alive messages which may be sent without the SSH server receiving any messages back from the client.  If this threshold is reached while client alive messages are being sent, the SSH server will disconnect the client, terminating the session.  The client alive messages are sent through the encrypted channel and therefore will not be spoofable.  The client alive mechanism is valuable when the client or server depend on knowing when a connection has become unresponsive.

NOTE: This setting is not intended to manage idle user sessions where there is no input from the client. Its purpose is to monitor for interruptions in network connectivity and force the session to terminate after the connection appears to be broken.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_client_alive_count_max_configure_stig" test_ref="oval:mscp:tst:213"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:215" version="1" class="compliance">
          <metadata>
            <title>Disable Privacy Setup Services During Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95267-1"/>
            <reference source="macos_security" ref_id="os_privacy_setup_prompt_disable_recommended"/>
            <description>The prompt for Privacy Setup services during Setup Assistant _MUST_ be disabled.

Organizations _MUST_ apply organization-wide configuration settings. The macOS Privacy Setup services prompt guides new users through enabling their own specific privacy settings; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing privacy settings with the potential to override organization-wide settings.</description>
          </metadata>
          <criteria>
            <criterion comment="os_privacy_setup_prompt_disable_recommended" test_ref="oval:mscp:tst:215"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:217" version="1" class="compliance">
          <metadata>
            <title>Enforce Software Update App Update Updates Automatically</title>
            <reference source="CCE" ref_id="CCE-95402-4"/>
            <reference source="macos_security" ref_id="os_software_update_app_update_enforce_recommended"/>
            <description>Software Update _MUST_ be configured to enforce automatic updates of App Updates is enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_software_update_app_update_enforce_recommended" test_ref="oval:mscp:tst:217"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:219" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Image Playground</title>
            <reference source="CCE" ref_id="CCE-95207-7"/>
            <reference source="macos_security" ref_id="os_image_playground_disable_recommended"/>
            <description>Apple Intelligence features such as Image Playground _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_image_playground_disable_recommended" test_ref="oval:mscp:tst:219"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:220" version="1" class="compliance">
          <metadata>
            <title>Ensure Secure Boot Level Set to Full</title>
            <reference source="CCE" ref_id="CCE-95292-9"/>
            <reference source="macos_security" ref_id="os_secure_boot_verify_recommended"/>
            <description>The Secure Boot security setting _MUST_ be set to full.

Full security is the default Secure Boot setting in macOS. During startup, when Secure Boot is set to full security, the Mac will verify the integrity of the operating system before allowing the operating system to boot.

NOTE: This will only return a proper result on a T2 or Apple Silicon Macs.</description>
          </metadata>
          <criteria>
            <criterion comment="os_secure_boot_verify_recommended" test_ref="oval:mscp:tst:220"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:221" version="1" class="compliance">
          <metadata>
            <title>Configure Sudo To Log Events</title>
            <reference source="CCE" ref_id="CCE-95316-6"/>
            <reference source="macos_security" ref_id="os_sudo_log_enforce_recommended"/>
            <description>Sudo _MUST_ be configured to log privilege escalation.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudo_log_enforce_recommended" test_ref="oval:mscp:tst:221"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:223" version="1" class="compliance">
          <metadata>
            <title>Disable Unix-to-Unix Copy Protocol Service</title>
            <reference source="CCE" ref_id="CCE-95330-7"/>
            <reference source="macos_security" ref_id="os_uucp_disable_recommended"/>
            <description>The system _MUST_ not have the Unix-to-Unix Copy Protocol (UUCP) service active.

UUCP, a set of programs that enable the sending of files between different UNIX systems as well as sending commands to be executed on another system, is not essential and _MUST_ be disabled in order to prevent the unauthorized connection of devices, transfer of information, and tunneling.

NOTE: UUCP service is disabled at startup by default macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_uucp_disable_recommended" test_ref="oval:mscp:tst:223"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:224" version="1" class="compliance">
          <metadata>
            <title>Disable Burn Support</title>
            <reference source="CCE" ref_id="CCE-95170-7"/>
            <reference source="macos_security" ref_id="os_burn_support_disable_recommended"/>
            <description>Burn support _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_burn_support_disable_recommended" test_ref="oval:mscp:tst:224"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:225" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Login Window</title>
            <reference source="CCE" ref_id="CCE-95257-2"/>
            <reference source="macos_security" ref_id="os_policy_banner_loginwindow_enforce_recommended"/>
            <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
You are accessing a U.S. Government information system, which includes: 1) this computer, 2) this computer network, 3) all Government-furnished computers connected to this network, and 4) all Government-furnished devices and storage media attached to this network or to a computer on this network. You understand and consent to the following: you may access this information system for authorized use only; unauthorized use of the system is prohibited and subject to criminal and civil penalties; you have no reasonable expectation of privacy regarding any communication or data transiting or stored on this information system at any time and for any lawful Government purpose, the Government may monitor, intercept, audit, and search and seize any communication or data transiting or stored on this information system; and any communications or data transiting or stored on this information system may be disclosed or used for any lawful Government purpose. This information system may contain Controlled Unclassified Information (CUI) that is subject to safeguarding or dissemination controls in accordance with law, regulation, or Government-wide policy. Accessing and using this system indicates your understanding of this warning.
----</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_loginwindow_enforce_recommended" test_ref="oval:mscp:tst:225"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:226" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Login Window</title>
            <reference source="CCE" ref_id="CCE-95257-2"/>
            <reference source="macos_security" ref_id="os_policy_banner_loginwindow_enforce_cis_lvl1"/>
            <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
Center for Internet Security Test Message
----</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_loginwindow_enforce_cis_lvl1" test_ref="oval:mscp:tst:226"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:227" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Login Window</title>
            <reference source="CCE" ref_id="CCE-95257-2"/>
            <reference source="macos_security" ref_id="os_policy_banner_loginwindow_enforce_cis_lvl2"/>
            <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
Center for Internet Security Test Message
----</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_loginwindow_enforce_cis_lvl2" test_ref="oval:mscp:tst:227"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:228" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Login Window</title>
            <reference source="CCE" ref_id="CCE-95257-2"/>
            <reference source="macos_security" ref_id="os_policy_banner_loginwindow_enforce_stig"/>
            <description>Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.

The policy banner will show if a "PolicyBanner.rtf" or "PolicyBanner.rtfd" exists in the "/Library/Security" folder.

The banner text of the document _MUST_ read:

[source,text]
----
You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.
----</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_loginwindow_enforce_stig" test_ref="oval:mscp:tst:228"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:229" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Writing Tools</title>
            <reference source="CCE" ref_id="CCE-95334-9"/>
            <reference source="macos_security" ref_id="os_writing_tools_disable_recommended"/>
            <description>Apple Intelligence features such as writing tools that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_writing_tools_disable_recommended" test_ref="oval:mscp:tst:229"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:230" version="1" class="compliance">
          <metadata>
            <title>Prohibit User Installation of Software into /Users/</title>
            <reference source="CCE" ref_id="CCE-95329-9"/>
            <reference source="macos_security" ref_id="os_user_app_installation_prohibit_recommended"/>
            <description>Users _MUST_ not be allowed to install software into /Users/.

Allowing regular users to install software, without explicit privileges, presents the risk of untested and potentially malicious software being installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceeds the rights of a regular user.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_user_app_installation_prohibit_recommended" test_ref="oval:mscp:tst:230"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:234" version="1" class="compliance">
          <metadata>
            <title>Disable User Ability from Being Able to Undo Rapid Security Responses</title>
            <reference source="CCE" ref_id="CCE-95273-9"/>
            <reference source="macos_security" ref_id="os_rapid_security_response_removal_disable_recommended"/>
            <description>Rapid security response (RSR) mechanism _MUST_ be enabled and the ability for the user to disable RSR _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_rapid_security_response_removal_disable_recommended" test_ref="oval:mscp:tst:234"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:235" version="1" class="compliance">
          <metadata>
            <title>Disable TouchID Prompt during Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95326-5"/>
            <reference source="macos_security" ref_id="os_touchid_prompt_disable_recommended"/>
            <description>The prompt for TouchID during Setup Assistant _MUST_ be disabled.

macOS prompts new users through enabling TouchID during Setup Assistant; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing to enable TouchID to override organization-wide settings.</description>
          </metadata>
          <criteria>
            <criterion comment="os_touchid_prompt_disable_recommended" test_ref="oval:mscp:tst:235"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:236" version="1" class="compliance">
          <metadata>
            <title>Disable FileVault Automatic Login</title>
            <reference source="CCE" ref_id="CCE-95192-1"/>
            <reference source="macos_security" ref_id="os_filevault_autologin_disable_recommended"/>
            <description>If FileVault is enabled, automatic login _MUST_ be disabled, so that both FileVault and login window authentication are required.

The default behavior of macOS when FileVault is enabled is to automatically log in to the computer once successfully passing your FileVault credentials.

NOTE: DisableFDEAutoLogin does not have to be set on Apple Silicon based macOS systems that are smartcard enforced as smartcards are available at pre-boot.</description>
          </metadata>
          <criteria>
            <criterion comment="os_filevault_autologin_disable_recommended" test_ref="oval:mscp:tst:236"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:237" version="1" class="compliance">
          <metadata>
            <title>Disable Screen Time Prompt During Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95300-0"/>
            <reference source="macos_security" ref_id="os_skip_screen_time_prompt_enable_recommended"/>
            <description>The prompt for Screen Time setup during Setup Assistant _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_skip_screen_time_prompt_enable_recommended" test_ref="oval:mscp:tst:237"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:239" version="1" class="compliance">
          <metadata>
            <title>Disable Blank CD</title>
            <reference source="CCE" ref_id="CCE-95166-5"/>
            <reference source="macos_security" ref_id="os_blank_cd_disable_recommended"/>
            <description>Blank CD media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_blank_cd_disable_recommended" test_ref="oval:mscp:tst:239"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:241" version="1" class="compliance">
          <metadata>
            <title>Disable Messages App</title>
            <reference source="CCE" ref_id="CCE-95228-3"/>
            <reference source="macos_security" ref_id="os_messages_app_disable_recommended"/>
            <description>The macOS built-in Messages.app _MUST_ be disabled.

The Messages.app establishes a connection to Apple's iCloud service, even when security controls to disable iCloud access have been put in place.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_messages_app_disable_recommended" test_ref="oval:mscp:tst:241"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:242" version="1" class="compliance">
          <metadata>
            <title>Disable Installation of Configuration Profiles through the User Interface</title>
            <reference source="CCE" ref_id="CCE-95177-2"/>
            <reference source="macos_security" ref_id="os_config_profile_ui_install_disable_recommended"/>
            <description>Installation of configuration profiles through the user interface _MUST_ be disabled and only be permitted through an authorized MDM server.</description>
          </metadata>
          <criteria>
            <criterion comment="os_config_profile_ui_install_disable_recommended" test_ref="oval:mscp:tst:242"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:244" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD PerSourcePenalties</title>
            <reference source="CCE" ref_id="CCE-95312-5"/>
            <reference source="macos_security" ref_id="os_sshd_per_source_penalties_configure_recommended"/>
            <description>If SSHD is enabled then it _MUST_ be configured with the Per Source Penalties configured.

Per Source Penalities controls penalties for various conditions that may represent attacks on sshd.

Penalties are enabled by default.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_per_source_penalties_configure_recommended" test_ref="oval:mscp:tst:244"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:246" version="1" class="compliance">
          <metadata>
            <title>Disable Genmoji AI Creation</title>
            <reference source="CCE" ref_id="CCE-95196-2"/>
            <reference source="macos_security" ref_id="os_genmoji_disable_recommended"/>
            <description>Apple Intelligence features such as Genmoji _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_genmoji_disable_recommended" test_ref="oval:mscp:tst:246"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:247" version="1" class="compliance">
          <metadata>
            <title>Disable AirDrop</title>
            <reference source="CCE" ref_id="CCE-95156-6"/>
            <reference source="macos_security" ref_id="os_airdrop_disable_recommended"/>
            <description>AirDrop _MUST_ be disabled to prevent file transfers to or from unauthorized devices.
AirDrop allows users to share and receive files from other nearby Apple devices.</description>
          </metadata>
          <criteria>
            <criterion comment="os_airdrop_disable_recommended" test_ref="oval:mscp:tst:247"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:248" version="1" class="compliance">
          <metadata>
            <title>Configure Sudoers Timestamp Type</title>
            <reference source="CCE" ref_id="CCE-95318-2"/>
            <reference source="macos_security" ref_id="os_sudoers_timestamp_type_configure_recommended"/>
            <description>The file /etc/sudoers _MUST_ be configured to not include a timestamp_type of global or ppid and be configured for timestamp record types of tty.

This rule ensures that the "sudo" command will prompt for the administrator's password at least once in each newly opened terminal window. This prevents a malicious user from taking advantage of an unlocked computer or an abandoned logon session by bypassing the normal password prompt requirement.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudoers_timestamp_type_configure_recommended" test_ref="oval:mscp:tst:248"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:251" version="1" class="compliance">
          <metadata>
            <title>Enable Parental Controls</title>
            <reference source="CCE" ref_id="CCE-95248-1"/>
            <reference source="macos_security" ref_id="os_parental_controls_enable_recommended"/>
            <description>Parental Controls _MUST_ be enabled.

Control of program execution is a mechanism used to prevent program execution of unauthorized programs, which is critical to maintaining a secure system baseline.

Parental Controls on the macOS consist of many different payloads, which are set individually depending on the type of control required. Enabling parental controls allows for further configuration of these restrictions.</description>
          </metadata>
          <criteria>
            <criterion comment="os_parental_controls_enable_recommended" test_ref="oval:mscp:tst:251"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:254" version="1" class="compliance">
          <metadata>
            <title>Ensure System Volume is Read Only</title>
            <reference source="CCE" ref_id="CCE-95319-0"/>
            <reference source="macos_security" ref_id="os_system_read_only_recommended"/>
            <description>The System volume _MUST_ be mounted as read-only in order to ensure that configurations critical to the integrity of the macOS have not been compromised. System Integrity Protection (SIP) will prevent the system volume from being mounted as writable.

NOTE: The system volume is read only by default in macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_system_read_only_recommended" test_ref="oval:mscp:tst:254"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:255" version="1" class="compliance">
          <metadata>
            <title>Set SSH Active Server Alive Maximum to 0</title>
            <reference source="CCE" ref_id="CCE-95305-9"/>
            <reference source="macos_security" ref_id="os_ssh_server_alive_count_max_configure_recommended"/>
            <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 0. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ssh_server_alive_count_max_configure_recommended" test_ref="oval:mscp:tst:255"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:256" version="1" class="compliance">
          <metadata>
            <title>Set SSH Active Server Alive Maximum to 0</title>
            <reference source="CCE" ref_id="CCE-95305-9"/>
            <reference source="macos_security" ref_id="os_ssh_server_alive_count_max_configure_stig"/>
            <description>SSH _MUST_ be configured with an Active Server Alive Maximum Count set to 0. Terminating an idle session within a short time period reduces the window of opportunity for unauthorized personnel to take control of a management session enabled on the console or console port that has been left unattended. In addition, quickly terminating an idle session or an incomplete login attempt will also free up resources committed by the managed network element.

NOTE: /etc/ssh/ssh_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ssh_server_alive_count_max_configure_stig" test_ref="oval:mscp:tst:256"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:257" version="1" class="compliance">
          <metadata>
            <title>Enable DestroyFVKeyOnStandby on Hibernate</title>
            <reference source="CCE" ref_id="CCE-95200-2"/>
            <reference source="macos_security" ref_id="os_hibernate_mode_destroyfvkeyonstandby_enable_recommended"/>
            <description>DestroyFVKeyOnStandby on hibernate _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_hibernate_mode_destroyfvkeyonstandby_enable_recommended" test_ref="oval:mscp:tst:257"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:258" version="1" class="compliance">
          <metadata>
            <title>Disable Network File System Service</title>
            <reference source="CCE" ref_id="CCE-95235-8"/>
            <reference source="macos_security" ref_id="os_nfsd_disable_recommended"/>
            <description>Support for Network File Systems (NFS) services is non-essential and, therefore, _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_nfsd_disable_recommended" test_ref="oval:mscp:tst:258"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:260" version="1" class="compliance">
          <metadata>
            <title>Disable Root Login for SSH</title>
            <reference source="CCE" ref_id="CCE-95313-3"/>
            <reference source="macos_security" ref_id="os_sshd_permit_root_login_configure_recommended"/>
            <description>If SSH is enabled to assure individual accountability and prevent unauthorized access, logging in as root via SSH _MUST_ be disabled.

The macOS system MUST  require individuals to be authenticated with an individual authenticator prior to using a group authenticator, and administrator users _MUST_ never log in directly as root.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_permit_root_login_configure_recommended" test_ref="oval:mscp:tst:260"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:261" version="1" class="compliance">
          <metadata>
            <title>Disable AppleID and Internet Account Modifications</title>
            <reference source="CCE" ref_id="CCE-95155-8"/>
            <reference source="macos_security" ref_id="os_account_modification_disable_recommended"/>
            <description>The system _MUST_ disable account modification. 

Account modification includes adding additional or modifying internet accounts in Apple Mail, Calendar, Contacts, in the Internet Account System Setting Pane, or the AppleID System Setting Pane.

This prevents the addition of unauthorized accounts.

[IMPORTANT]
====
Some organizations may allow the use and configuration of the built-in Mail.app, Calendar.app, and Contacts.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the Internet Accounts System Preference pane to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_account_modification_disable_recommended" test_ref="oval:mscp:tst:261"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:262" version="1" class="compliance">
          <metadata>
            <title>Disable the Built-in Web Server</title>
            <reference source="CCE" ref_id="CCE-95204-4"/>
            <reference source="macos_security" ref_id="os_httpd_disable_recommended"/>
            <description>The built-in web server which is managed by launchd is a non-essential service built into macOS and _MUST_ be disabled and not running.

NOTE: The built in web server service is disabled at startup by default macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_httpd_disable_recommended" test_ref="oval:mscp:tst:262"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:264" version="1" class="compliance">
          <metadata>
            <title>Configure Apple System Log Files Owned by Root and Group to Wheel</title>
            <reference source="CCE" ref_id="CCE-95161-6"/>
            <reference source="macos_security" ref_id="os_asl_log_files_owner_group_configure_recommended"/>
            <description>The Apple System Logs (ASL) _MUST_ be owned by root.

ASL logs contain sensitive data about the system and users. If ASL log files are set to only be readable and writable by system administrators, the risk is mitigated.</description>
          </metadata>
          <criteria>
            <criterion comment="os_asl_log_files_owner_group_configure_recommended" test_ref="oval:mscp:tst:264"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:265" version="1" class="compliance">
          <metadata>
            <title>Enable Hibernate Mode (Intel)</title>
            <reference source="CCE" ref_id="CCE-95201-0"/>
            <reference source="macos_security" ref_id="os_hibernate_mode_intel_enable_recommended"/>
            <description>Hibernate mode _MUST_ be enabled.

This will store a copy of memory to persistent storage, and will remove power to memory. This setting will stop the potential for a cold-boot attack.</description>
          </metadata>
          <criteria>
            <criterion comment="os_hibernate_mode_intel_enable_recommended" test_ref="oval:mscp:tst:265"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:268" version="1" class="compliance">
          <metadata>
            <title>Enable Recovery Lock</title>
            <reference source="CCE" ref_id="CCE-95277-0"/>
            <reference source="macos_security" ref_id="os_recovery_lock_enable_recommended"/>
            <description>A recovery lock password _MUST_ be enabled and set.

Single user mode, recovery mode, the Startup Manager, and several other tools are available on macOS by holding down specific key combinations during startup. Setting a recovery lock restricts access to these tools.

IMPORTANT: Recovery lock passwords are not supported on Intel devices. This rule is only applicable to Apple Silicon devices.</description>
          </metadata>
          <criteria>
            <criterion comment="os_recovery_lock_enable_recommended" test_ref="oval:mscp:tst:268"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:269" version="1" class="compliance">
          <metadata>
            <title>Disable Blank DVD</title>
            <reference source="CCE" ref_id="CCE-95167-3"/>
            <reference source="macos_security" ref_id="os_blank_dvd_disable_recommended"/>
            <description>Blank DVD media _MUST_ be disabled.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_blank_dvd_disable_recommended" test_ref="oval:mscp:tst:269"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:270" version="1" class="compliance">
          <metadata>
            <title>Prevent AdminHostInfo from Being Available at Login Window</title>
            <reference source="CCE" ref_id="CCE-95600-3"/>
            <reference source="macos_security" ref_id="os_loginwindow_adminhostinfo_disabled_recommended"/>
            <description>The system _MUST_ be configured to not display sensitive information at the login window. If the key `AdminHostInfo` is configured with a string value, it will allow the HostName, IP Address, and operating system version and build to be displayed when clicking on the clock area of the login window.

Configuring this key to be an integer value, since it expects a string value, will effectively disable the behavior.

NOTE: This configuration requires it to be deployed via Managed Preferences rather than directly to com.apple.loginwindow.</description>
          </metadata>
          <criteria>
            <criterion comment="os_loginwindow_adminhostinfo_disabled_recommended" test_ref="oval:mscp:tst:270"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:271" version="1" class="compliance">
          <metadata>
            <title>Ensure Show Full Website Address in Safari Is Enabled</title>
            <reference source="CCE" ref_id="CCE-95287-9"/>
            <reference source="macos_security" ref_id="os_safari_show_full_website_address_enable_recommended"/>
            <description>Show full website address _MUST_ be enabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_show_full_website_address_enable_recommended" test_ref="oval:mscp:tst:271"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:273" version="1" class="compliance">
          <metadata>
            <title>Enable Apple Mobile File Integrity</title>
            <reference source="CCE" ref_id="CCE-95231-7"/>
            <reference source="macos_security" ref_id="os_mobile_file_integrity_enable_recommended"/>
            <description>Mobile file integrity _MUST_ be enabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_mobile_file_integrity_enable_recommended" test_ref="oval:mscp:tst:273"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:274" version="1" class="compliance">
          <metadata>
            <title>Enable Gatekeeper</title>
            <reference source="CCE" ref_id="CCE-95195-4"/>
            <reference source="macos_security" ref_id="os_gatekeeper_enable_recommended"/>
            <description>Gatekeeper _MUST_ be enabled.

Gatekeeper is a security feature that ensures that applications are digitally signed by an Apple-issued certificate before they are permitted to run. Digital signatures allow the macOS host to verify that the application has not been modified by a malicious third party.

Administrator users will still have the option to override these settings on a case-by-case basis.</description>
          </metadata>
          <criteria>
            <criterion comment="os_gatekeeper_enable_recommended" test_ref="oval:mscp:tst:274"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:275" version="1" class="compliance">
          <metadata>
            <title>Ensure System Integrity Protection is Enabled</title>
            <reference source="CCE" ref_id="CCE-95298-6"/>
            <reference source="macos_security" ref_id="os_sip_enable_recommended"/>
            <description>System Integrity Protection (SIP) _MUST_ be enabled.

SIP is vital to protecting the integrity of the system as it prevents malicious users and software from making unauthorized and/or unintended modifications to protected files and folders; ensures the presence of an audit record generation capability for defined auditable events for all operating system components; protects audit tools from unauthorized access, modification, and deletion; restricts the root user account and limits the actions that the root user can perform on protected parts of the macOS; and prevents non-privileged users from granting other users direct access to the contents of their home directories and folders.

NOTE: SIP is enabled by default in macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sip_enable_recommended" test_ref="oval:mscp:tst:275"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:276" version="1" class="compliance">
          <metadata>
            <title>Disable Removable Storage Devices</title>
            <reference source="CCE" ref_id="CCE-95279-6"/>
            <reference source="macos_security" ref_id="os_removable_media_disable_recommended"/>
            <description>Removable media, such as USB connected external hard drives, thumb drives, and optical media, _MUST_ be disabled for users.

Disabling removable storage devices reduces the risks and known vulnerabilities of such devices (e.g., malicious code insertion)

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_removable_media_disable_recommended" test_ref="oval:mscp:tst:276"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:277" version="1" class="compliance">
          <metadata>
            <title>Ensure No World Writable Files Exist in the Library Folder</title>
            <reference source="CCE" ref_id="CCE-95332-3"/>
            <reference source="macos_security" ref_id="os_world_writable_library_folder_configure_recommended"/>
            <description>Folders in /System/Volumes/Data/Library _MUST_ not be world-writable.

NOTE: Some vendors are known to create world-writable folders to the System Library folder. You may need to add more exclusions to this check and fix to match your environment.</description>
          </metadata>
          <criteria>
            <criterion comment="os_world_writable_library_folder_configure_recommended" test_ref="oval:mscp:tst:277"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:278" version="1" class="compliance">
          <metadata>
            <title>Disable Dictation</title>
            <reference source="CCE" ref_id="CCE-95180-6"/>
            <reference source="macos_security" ref_id="os_dictation_disable_recommended"/>
            <description>Dictation _MUST_ be disabled on Intel based Macs as the feature On Device Dictation is only available on Apple Silicon devices.</description>
          </metadata>
          <criteria>
            <criterion comment="os_dictation_disable_recommended" test_ref="oval:mscp:tst:278"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:279" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Remote Login</title>
            <reference source="CCE" ref_id="CCE-95258-0"/>
            <reference source="macos_security" ref_id="os_policy_banner_ssh_configure_recommended"/>
            <description>Remote login service _MUST_ be configured to display a policy banner at login.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_ssh_configure_recommended" test_ref="oval:mscp:tst:279"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:280" version="1" class="compliance">
          <metadata>
            <title>Display Policy Banner at Remote Login</title>
            <reference source="CCE" ref_id="CCE-95258-0"/>
            <reference source="macos_security" ref_id="os_policy_banner_ssh_configure_stig"/>
            <description>Remote login service _MUST_ be configured to display a policy banner at login.

Displaying a standardized and approved use notification before granting access to the operating system ensures that users are provided with privacy and security notification verbiage that is consistent with applicable federal laws, Executive Orders, directives, policies, regulations, standards, and guidance.

System use notifications are required only for access via login interfaces with human users and are not required when such human interfaces do not exist.</description>
          </metadata>
          <criteria>
            <criterion comment="os_policy_banner_ssh_configure_stig" test_ref="oval:mscp:tst:280"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:281" version="1" class="compliance">
          <metadata>
            <title>Ensure Secure Keyboard Entry Terminal.app is Enabled</title>
            <reference source="CCE" ref_id="CCE-95321-6"/>
            <reference source="macos_security" ref_id="os_terminal_secure_keyboard_enable_recommended"/>
            <description>Secure keyboard entry _MUST_ be enabled in Terminal.app.</description>
          </metadata>
          <criteria>
            <criterion comment="os_terminal_secure_keyboard_enable_recommended" test_ref="oval:mscp:tst:281"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:283" version="1" class="compliance">
          <metadata>
            <title>Enable Time Synchronization Daemon</title>
            <reference source="CCE" ref_id="CCE-95325-7"/>
            <reference source="macos_security" ref_id="os_time_server_enabled_recommended"/>
            <description>The macOS time synchronization daemon (timed) _MUST_ be enabled for proper time synchronization to an authorized time server.

NOTE: The time synchronization daemon is enabled by default on macOS.</description>
          </metadata>
          <criteria>
            <criterion comment="os_time_server_enabled_recommended" test_ref="oval:mscp:tst:283"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:284" version="1" class="compliance">
          <metadata>
            <title>Disable Login to Other User's Active and Locked Sessions</title>
            <reference source="CCE" ref_id="CCE-95328-1"/>
            <reference source="macos_security" ref_id="os_unlock_active_user_session_disable_recommended"/>
            <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.</description>
          </metadata>
          <criteria>
            <criterion comment="os_unlock_active_user_session_disable_recommended" test_ref="oval:mscp:tst:284"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:285" version="1" class="compliance">
          <metadata>
            <title>Disable Login to Other User's Active and Locked Sessions</title>
            <reference source="CCE" ref_id="CCE-95328-1"/>
            <reference source="macos_security" ref_id="os_unlock_active_user_session_disable_cis_lvl1"/>
            <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.</description>
          </metadata>
          <criteria>
            <criterion comment="os_unlock_active_user_session_disable_cis_lvl1" test_ref="oval:mscp:tst:285"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:286" version="1" class="compliance">
          <metadata>
            <title>Disable Login to Other User's Active and Locked Sessions</title>
            <reference source="CCE" ref_id="CCE-95328-1"/>
            <reference source="macos_security" ref_id="os_unlock_active_user_session_disable_cis_lvl2"/>
            <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.</description>
          </metadata>
          <criteria>
            <criterion comment="os_unlock_active_user_session_disable_cis_lvl2" test_ref="oval:mscp:tst:286"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:287" version="1" class="compliance">
          <metadata>
            <title>Disable Login to Other User's Active and Locked Sessions</title>
            <reference source="CCE" ref_id="CCE-95328-1"/>
            <reference source="macos_security" ref_id="os_unlock_active_user_session_disable_stig"/>
            <description>The ability to log in to another user's active or locked session _MUST_ be disabled.

macOS has a privilege that can be granted to any user that will allow that user to unlock active user's sessions. Disabling the admins and/or user's ability to log into another user's active and locked session prevents unauthorized persons from viewing potentially sensitive and/or personal information.

NOTE: Configuring this setting will change the user experience and disable TouchID from unlocking the screensaver. A configuration profile will be generated to include the setting that restores the expected behavior. You can also apply the settings using `/usr/bin/sudo /usr/bin/defaults write /Library/Preferences/com.apple.loginwindow screenUnlockMode -int 1`.

WARNING: This rule may cause issues when platformSSO is configured.</description>
          </metadata>
          <criteria>
            <criterion comment="os_unlock_active_user_session_disable_stig" test_ref="oval:mscp:tst:287"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:289" version="1" class="compliance">
          <metadata>
            <title>Configure Sudo Timeout Period to 0</title>
            <reference source="CCE" ref_id="CCE-95317-4"/>
            <reference source="macos_security" ref_id="os_sudo_timeout_configure_recommended"/>
            <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudo_timeout_configure_recommended" test_ref="oval:mscp:tst:289"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:290" version="1" class="compliance">
          <metadata>
            <title>Configure Sudo Timeout Period to 0</title>
            <reference source="CCE" ref_id="CCE-95317-4"/>
            <reference source="macos_security" ref_id="os_sudo_timeout_configure_cis_lvl1"/>
            <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudo_timeout_configure_cis_lvl1" test_ref="oval:mscp:tst:290"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:291" version="1" class="compliance">
          <metadata>
            <title>Configure Sudo Timeout Period to 0</title>
            <reference source="CCE" ref_id="CCE-95317-4"/>
            <reference source="macos_security" ref_id="os_sudo_timeout_configure_cis_lvl2"/>
            <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudo_timeout_configure_cis_lvl2" test_ref="oval:mscp:tst:291"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:292" version="1" class="compliance">
          <metadata>
            <title>Configure Sudo Timeout Period to 0</title>
            <reference source="CCE" ref_id="CCE-95317-4"/>
            <reference source="macos_security" ref_id="os_sudo_timeout_configure_stig"/>
            <description>The file /etc/sudoers _MUST_ include a timestamp_timeout of 0.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sudo_timeout_configure_stig" test_ref="oval:mscp:tst:292"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:293" version="1" class="compliance">
          <metadata>
            <title>Disable Siri Setup during Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95299-4"/>
            <reference source="macos_security" ref_id="os_siri_prompt_disable_recommended"/>
            <description>The prompt for Siri during Setup Assistant _MUST_ be disabled.

Organizations _MUST_ apply organization-wide configuration settings. The macOS Siri Assistant Setup prompt guides new users through enabling their own specific Siri settings; this is not essential and, therefore, _MUST_ be disabled to prevent against the risk of individuals electing Siri settings with the potential to override organization-wide settings.</description>
          </metadata>
          <criteria>
            <criterion comment="os_siri_prompt_disable_recommended" test_ref="oval:mscp:tst:293"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:294" version="1" class="compliance">
          <metadata>
            <title>Disable Apple ID Setup during Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95159-0"/>
            <reference source="macos_security" ref_id="os_appleid_prompt_disable_recommended"/>
            <description>The prompt for Apple ID setup during Setup Assistant _MUST_ be disabled.

macOS will automatically prompt new users to set up an Apple ID while they are going through Setup Assistant if this is not disabled, misleading new users to think they need to create Apple ID accounts upon their first login.</description>
          </metadata>
          <criteria>
            <criterion comment="os_appleid_prompt_disable_recommended" test_ref="oval:mscp:tst:294"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:297" version="1" class="compliance">
          <metadata>
            <title>Integrate System into a Directory Services Infrastructure</title>
            <reference source="CCE" ref_id="CCE-95181-4"/>
            <reference source="macos_security" ref_id="os_directory_services_configured_recommended"/>
            <description>The macOS system _MUST_ be integrated into a directory services infrastructure.

A directory service infrastructure enables centralized user and rights management, as well as centralized control over computer and user configurations. Integrating the macOS systems used throughout an organization into a directory services infrastructure ensures more administrator oversight and security than allowing distinct user account databases to exist on each separate system.</description>
          </metadata>
          <criteria>
            <criterion comment="os_directory_services_configured_recommended" test_ref="oval:mscp:tst:297"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:298" version="1" class="compliance">
          <metadata>
            <title>Ensure Show Safari shows the Status Bar is Enabled</title>
            <reference source="CCE" ref_id="CCE-95288-7"/>
            <reference source="macos_security" ref_id="os_safari_show_status_bar_enabled_recommended"/>
            <description>Safari _MUST_ be configured to show the status bar.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_show_status_bar_enabled_recommended" test_ref="oval:mscp:tst:298"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:300" version="1" class="compliance">
          <metadata>
            <title>Disable Unlock with Apple Watch During Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95301-8"/>
            <reference source="macos_security" ref_id="os_skip_unlock_with_watch_enable_recommended"/>
            <description>The prompt for Apple Watch unlock setup during Setup Assistant _MUST_ be disabled.

Disabling Apple watches is a necessary step to ensuring that the information system retains a session lock until the user reestablishes access using an authorized identification and authentication procedures.</description>
          </metadata>
          <criteria>
            <criterion comment="os_skip_unlock_with_watch_enable_recommended" test_ref="oval:mscp:tst:300"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:301" version="1" class="compliance">
          <metadata>
            <title>Disable Apple Intelligence Safari Reader Summary</title>
            <reference source="CCE" ref_id="CCE-95286-1"/>
            <reference source="macos_security" ref_id="os_safari_reader_summary_disable_recommended"/>
            <description>Apple Intelligence features such as Safari Reader Summary that use off device AI _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_reader_summary_disable_recommended" test_ref="oval:mscp:tst:301"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:303" version="1" class="compliance">
          <metadata>
            <title>Ensure Appropriate Permissions Are Enabled for System Wide Applications</title>
            <reference source="CCE" ref_id="CCE-95320-8"/>
            <reference source="macos_security" ref_id="os_system_wide_applications_configure_recommended"/>
            <description>Applications in the System Applications Directory (/Applications) _MUST_ not be world-writable.</description>
          </metadata>
          <criteria>
            <criterion comment="os_system_wide_applications_configure_recommended" test_ref="oval:mscp:tst:303"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:305" version="1" class="compliance">
          <metadata>
            <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
            <reference source="CCE" ref_id="CCE-95303-4"/>
            <reference source="macos_security" ref_id="os_software_update_deferral_recommended"/>
            <description>Software updates _MUST_ be deferred for 30 days or less.</description>
          </metadata>
          <criteria>
            <criterion comment="os_software_update_deferral_recommended" test_ref="oval:mscp:tst:305"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:306" version="1" class="compliance">
          <metadata>
            <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
            <reference source="CCE" ref_id="CCE-95303-4"/>
            <reference source="macos_security" ref_id="os_software_update_deferral_cis_lvl1"/>
            <description>Software updates _MUST_ be deferred for 30 days or less.</description>
          </metadata>
          <criteria>
            <criterion comment="os_software_update_deferral_cis_lvl1" test_ref="oval:mscp:tst:306"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:307" version="1" class="compliance">
          <metadata>
            <title>Ensure Software Update Deferment Is Less Than or Equal to 30 Days</title>
            <reference source="CCE" ref_id="CCE-95303-4"/>
            <reference source="macos_security" ref_id="os_software_update_deferral_cis_lvl2"/>
            <description>Software updates _MUST_ be deferred for 30 days or less.</description>
          </metadata>
          <criteria>
            <criterion comment="os_software_update_deferral_cis_lvl2" test_ref="oval:mscp:tst:307"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:308" version="1" class="compliance">
          <metadata>
            <title>Configure System Log Files to Mode 640 or Less Permissive</title>
            <reference source="CCE" ref_id="CCE-95234-1"/>
            <reference source="macos_security" ref_id="os_newsyslog_files_permissions_configure_recommended"/>
            <description>The system logs _MUST_ be configured to be writable by root and readable only by the root user and group wheel. To achieve this, system log files _MUST_ be configured to mode 640 permissive or less; thereby preventing normal users from reading, modifying or deleting audit logs. System logs frequently contain sensitive information that could be used by an attacker. Setting the correct permissions mitigates this risk.</description>
          </metadata>
          <criteria>
            <criterion comment="os_newsyslog_files_permissions_configure_recommended" test_ref="oval:mscp:tst:308"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:309" version="1" class="compliance">
          <metadata>
            <title>Secure User's Home Folders</title>
            <reference source="CCE" ref_id="CCE-95203-6"/>
            <reference source="macos_security" ref_id="os_home_folders_secure_recommended"/>
            <description>The system _MUST_ be configured to prevent access to other user's home folders.

The default behavior of macOS is to allow all valid users access to the top level of every other user's home folder while restricting access only to the Apple default folders within.</description>
          </metadata>
          <criteria>
            <criterion comment="os_home_folders_secure_recommended" test_ref="oval:mscp:tst:309"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:310" version="1" class="compliance">
          <metadata>
            <title>Enforce Blu Ray Read Only</title>
            <reference source="CCE" ref_id="CCE-95168-1"/>
            <reference source="macos_security" ref_id="os_bluray_read_only_enforce_recommended"/>
            <description>Blu Ray media _MUST_ be set to read only.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_bluray_read_only_enforce_recommended" test_ref="oval:mscp:tst:310"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:311" version="1" class="compliance">
          <metadata>
            <title>Disable FaceTime.app</title>
            <reference source="CCE" ref_id="CCE-95189-7"/>
            <reference source="macos_security" ref_id="os_facetime_app_disable_recommended"/>
            <description>The macOS built-in FaceTime.app _MUST_ be disabled.

The FaceTime.app establishes a connection to Apple's iCloud service, even when security controls have been put in place to disable iCloud access.

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_facetime_app_disable_recommended" test_ref="oval:mscp:tst:311"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:312" version="1" class="compliance">
          <metadata>
            <title>Disable Camera</title>
            <reference source="CCE" ref_id="CCE-95172-3"/>
            <reference source="macos_security" ref_id="os_camera_disable_recommended"/>
            <description>It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Failing to disconnect from collaborative computing devices (i.e., cameras) can result in subsequent compromises of organizational information. Providing easy methods to physically disconnect from such devices after a collaborative computing session helps to ensure that participants carry out the disconnect activity without having to go through complex and tedious procedures.

This requirement is not applicable to mobile devices (smartphones and tablets), where the use of the camera is a local AO decision.

This requirement is not applicable to dedicated VTC suites located in approved VTC locations that are centrally managed.

For an external camera, if there is not a method for the operator to manually disconnect camera at the end of collaborative computing sessions, this is a finding.

For a built-in camera, the camera must be protected by a camera cover (e.g., laptop camera cover slide) when not in use. If the built-in camera is not protected with a camera cover, or is not physically disabled, this is a finding.

If the camera is not disconnected, covered, or physically disabled, the following configuration is required.</description>
          </metadata>
          <criteria>
            <criterion comment="os_camera_disable_recommended" test_ref="oval:mscp:tst:312"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:313" version="1" class="compliance">
          <metadata>
            <title>Enforce On Device Dictation</title>
            <reference source="CCE" ref_id="CCE-95247-3"/>
            <reference source="macos_security" ref_id="os_on_device_dictation_enforce_recommended"/>
            <description>Dictation _MUST_ be restricted to on device only to prevent potential data exfiltration.

The information system _MUST_ be configured to provide only essential capabilities.</description>
          </metadata>
          <criteria>
            <criterion comment="os_on_device_dictation_enforce_recommended" test_ref="oval:mscp:tst:313"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:314" version="1" class="compliance">
          <metadata>
            <title>Access to External Storage Must Be Defined</title>
            <reference source="CCE" ref_id="CCE-95188-9"/>
            <reference source="macos_security" ref_id="os_external_storage_access_defined_recommended"/>
            <description>Access to external storage _MUST_ be managed. 

NOTE: Apple's built in method using declative device management method only allows you to set external storage manament to Allowed, ReadOnly, and Disallowed.</description>
          </metadata>
          <criteria>
            <criterion comment="os_external_storage_access_defined_recommended" test_ref="oval:mscp:tst:314"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:315" version="1" class="compliance">
          <metadata>
            <title>Configure Install.log Retention to 365</title>
            <reference source="CCE" ref_id="CCE-95211-9"/>
            <reference source="macos_security" ref_id="os_install_log_retention_configure_recommended"/>
            <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.</description>
          </metadata>
          <criteria>
            <criterion comment="os_install_log_retention_configure_recommended" test_ref="oval:mscp:tst:315"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:316" version="1" class="compliance">
          <metadata>
            <title>Configure Install.log Retention to 365</title>
            <reference source="CCE" ref_id="CCE-95211-9"/>
            <reference source="macos_security" ref_id="os_install_log_retention_configure_cis_lvl1"/>
            <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.</description>
          </metadata>
          <criteria>
            <criterion comment="os_install_log_retention_configure_cis_lvl1" test_ref="oval:mscp:tst:316"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:317" version="1" class="compliance">
          <metadata>
            <title>Configure Install.log Retention to 365</title>
            <reference source="CCE" ref_id="CCE-95211-9"/>
            <reference source="macos_security" ref_id="os_install_log_retention_configure_cis_lvl2"/>
            <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.</description>
          </metadata>
          <criteria>
            <criterion comment="os_install_log_retention_configure_cis_lvl2" test_ref="oval:mscp:tst:317"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:318" version="1" class="compliance">
          <metadata>
            <title>Configure Install.log Retention to 365</title>
            <reference source="CCE" ref_id="CCE-95211-9"/>
            <reference source="macos_security" ref_id="os_install_log_retention_configure_stig"/>
            <description>The install.log _MUST_ be configured to require records be kept for a organizational defined value before deletion, unless the system uses a central audit record storage facility.</description>
          </metadata>
          <criteria>
            <criterion comment="os_install_log_retention_configure_stig" test_ref="oval:mscp:tst:318"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:319" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Storage Setup during Setup Assistant</title>
            <reference source="CCE" ref_id="CCE-95205-1"/>
            <reference source="macos_security" ref_id="os_icloud_storage_prompt_disable_recommended"/>
            <description>The prompt to set up iCloud storage services during Setup Assistant _MUST_ be disabled.

The default behavior of macOS is to prompt new users to set up storage in iCloud. Disabling the iCloud storage setup prompt provides organizations more control over the storage of their data.</description>
          </metadata>
          <criteria>
            <criterion comment="os_icloud_storage_prompt_disable_recommended" test_ref="oval:mscp:tst:319"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:320" version="1" class="compliance">
          <metadata>
            <title>Disable Erase Content and Settings</title>
            <reference source="CCE" ref_id="CCE-95185-5"/>
            <reference source="macos_security" ref_id="os_erase_content_and_settings_disable_recommended"/>
            <description>Erase Content and Settings _MUST_ be disabled.</description>
          </metadata>
          <criteria>
            <criterion comment="os_erase_content_and_settings_disable_recommended" test_ref="oval:mscp:tst:320"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:321" version="1" class="compliance">
          <metadata>
            <title>Disable Infrared (IR) support</title>
            <reference source="CCE" ref_id="CCE-95213-5"/>
            <reference source="macos_security" ref_id="os_ir_support_disable_recommended"/>
            <description>Infrared (IR) support _MUST_ be disabled to prevent users from controlling the system with IR devices.

By default, if IR is enabled, the system will accept IR control from any remote device.

NOTE: This is applicable only to models of Mac Mini systems earlier than Mac Mini8,1.</description>
          </metadata>
          <criteria>
            <criterion comment="os_ir_support_disable_recommended" test_ref="oval:mscp:tst:321"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:322" version="1" class="compliance">
          <metadata>
            <title>Enforce CD Read Only</title>
            <reference source="CCE" ref_id="CCE-95173-1"/>
            <reference source="macos_security" ref_id="os_cd_read_only_enforce_recommended"/>
            <description>CD media _MUST_ be set to read only.

[IMPORTANT]
====
Some organizations rely on the use of removable media for storing and sharing data. Information System Security Officers (ISSOs) may make the risk-based decision not to disable external hard drives to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.systemuiserver.yaml#L4-L8[media mount controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_cd_read_only_enforce_recommended" test_ref="oval:mscp:tst:322"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:323" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD Channel Timeout to session:*=900</title>
            <reference source="CCE" ref_id="CCE-95307-5"/>
            <reference source="macos_security" ref_id="os_sshd_channel_timeout_configure_recommended"/>
            <description>If SSHD is enabled it _MUST_ be configured with session ChannelTime out set to session:*=900.

This will set the time out when the session is inactive.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_channel_timeout_configure_recommended" test_ref="oval:mscp:tst:323"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:324" version="1" class="compliance">
          <metadata>
            <title>Configure SSHD Channel Timeout to session:*=900</title>
            <reference source="CCE" ref_id="CCE-95307-5"/>
            <reference source="macos_security" ref_id="os_sshd_channel_timeout_configure_stig"/>
            <description>If SSHD is enabled it _MUST_ be configured with session ChannelTime out set to session:*=900.

This will set the time out when the session is inactive.

NOTE: /etc/ssh/sshd_config will be automatically modified to its original state following any update or major upgrade to the operating system.

NOTE: On macOS 15.2 and higher the SSH configuration can be reset to the macOS default by running /usr/libexec/reset-ssh-configuration.</description>
          </metadata>
          <criteria>
            <criterion comment="os_sshd_channel_timeout_configure_stig" test_ref="oval:mscp:tst:324"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:325" version="1" class="compliance">
          <metadata>
            <title>Ensure Prevent Cross-site Tracking in Safari Is Enabled</title>
            <reference source="CCE" ref_id="CCE-95285-3"/>
            <reference source="macos_security" ref_id="os_safari_prevent_cross-site_tracking_enable_recommended"/>
            <description>Prevent cross-site tracking _MUST_ be enabled in Safari.</description>
          </metadata>
          <criteria>
            <criterion comment="os_safari_prevent_cross-site_tracking_enable_recommended" test_ref="oval:mscp:tst:325"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:326" version="1" class="compliance">
          <metadata>
            <title>Disable Mail App</title>
            <reference source="CCE" ref_id="CCE-95221-8"/>
            <reference source="macos_security" ref_id="os_mail_app_disable_recommended"/>
            <description>The macOS built-in Mail.app _MUST_ be disabled.

The Mail.app contains functionality that can establish connections to Apple's iCloud, even when security controls to disable iCloud access have been put in place.

[IMPORTANT]
====
Some organizations allow the use of the built-in Mail.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Mail.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_mail_app_disable_recommended" test_ref="oval:mscp:tst:326"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:329" version="1" class="compliance">
          <metadata>
            <title>Disable Bonjour Multicast</title>
            <reference source="CCE" ref_id="CCE-95169-9"/>
            <reference source="macos_security" ref_id="os_bonjour_disable_recommended"/>
            <description>Bonjour multicast advertising _MUST_ be disabled to prevent the system from broadcasting its presence and available services over network interfaces.</description>
          </metadata>
          <criteria>
            <criterion comment="os_bonjour_disable_recommended" test_ref="oval:mscp:tst:329"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:330" version="1" class="compliance">
          <metadata>
            <title>Disable Calendar.app</title>
            <reference source="CCE" ref_id="CCE-95171-5"/>
            <reference source="macos_security" ref_id="os_calendar_app_disable_recommended"/>
            <description>The macOS built-in Calendar.app _MUST_ be disabled as this application can establish a connection to non-approved services. This rule is in place to prevent inadvertent data transfers.

[IMPORTANT]
====
Some organizations allow the use of the built-in Calendar.app for organizational communication. Information System Security Officers (ISSOs) may make the risk-based decision not to disable the macOS built-in Calendar.app to avoid losing this functionality, but they are advised to first fully weigh the potential risks posed to their organization.
====

[IMPORTANT]
====
Apple has deprecated the use of link:https://github.com/apple/device-management/blob/eb51fb0cb9626cac4717858556912c257a734ce0/mdm/profiles/com.apple.applicationaccess.new.yaml#L67-L70[application restriction controls], using these controls may not work as expected. Third party software may be required to fulfill the compliance requirements.
====</description>
          </metadata>
          <criteria>
            <criterion comment="os_calendar_app_disable_recommended" test_ref="oval:mscp:tst:330"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:331" version="1" class="compliance">
          <metadata>
            <title>Disable Accounts after 35 Days of Inactivity</title>
            <reference source="CCE" ref_id="CCE-95336-4"/>
            <reference source="macos_security" ref_id="pwpolicy_account_inactivity_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to disable accounts after 35 days of inactivity.

This rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_inactivity_enforce_recommended" test_ref="oval:mscp:tst:331"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:332" version="1" class="compliance">
          <metadata>
            <title>Disable Accounts after 35 Days of Inactivity</title>
            <reference source="CCE" ref_id="CCE-95336-4"/>
            <reference source="macos_security" ref_id="pwpolicy_account_inactivity_enforce_stig"/>
            <description>The macOS _MUST_ be configured to disable accounts after 35 days of inactivity.

This rule prevents malicious users from making use of unused accounts to gain access to the system while avoiding detection.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_inactivity_enforce_stig" test_ref="oval:mscp:tst:332"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:333" version="1" class="compliance">
          <metadata>
            <title>Require Passwords to Match the Defined Custom Regular Expression</title>
            <reference source="CCE" ref_id="CCE-95340-6"/>
            <reference source="macos_security" ref_id="pwpolicy_custom_regex_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_custom_regex_enforce_recommended" test_ref="oval:mscp:tst:333"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:334" version="1" class="compliance">
          <metadata>
            <title>Require Passwords to Match the Defined Custom Regular Expression</title>
            <reference source="CCE" ref_id="CCE-95340-6"/>
            <reference source="macos_security" ref_id="pwpolicy_custom_regex_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_custom_regex_enforce_cis_lvl2" test_ref="oval:mscp:tst:334"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:335" version="1" class="compliance">
          <metadata>
            <title>Require Passwords to Match the Defined Custom Regular Expression</title>
            <reference source="CCE" ref_id="CCE-95340-6"/>
            <reference source="macos_security" ref_id="pwpolicy_custom_regex_enforce_stig"/>
            <description>The macOS _MUST_ be configured to meet complexity requirements defined in ^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: The configuration profile generated must be installed from an MDM server.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_custom_regex_enforce_stig" test_ref="oval:mscp:tst:335"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:337" version="1" class="compliance">
          <metadata>
            <title>Restrict Maximum Password Lifetime to 60 Days</title>
            <reference source="CCE" ref_id="CCE-95345-5"/>
            <reference source="macos_security" ref_id="pwpolicy_max_lifetime_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 60 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_max_lifetime_enforce_recommended" test_ref="oval:mscp:tst:337"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:338" version="1" class="compliance">
          <metadata>
            <title>Restrict Maximum Password Lifetime to 365 Days</title>
            <reference source="CCE" ref_id="CCE-95345-5"/>
            <reference source="macos_security" ref_id="pwpolicy_max_lifetime_enforce_cis_lvl1"/>
            <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 365 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_max_lifetime_enforce_cis_lvl1" test_ref="oval:mscp:tst:338"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:339" version="1" class="compliance">
          <metadata>
            <title>Restrict Maximum Password Lifetime to 365 Days</title>
            <reference source="CCE" ref_id="CCE-95345-5"/>
            <reference source="macos_security" ref_id="pwpolicy_max_lifetime_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 365 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_max_lifetime_enforce_cis_lvl2" test_ref="oval:mscp:tst:339"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:340" version="1" class="compliance">
          <metadata>
            <title>Restrict Maximum Password Lifetime to 60 Days</title>
            <reference source="CCE" ref_id="CCE-95345-5"/>
            <reference source="macos_security" ref_id="pwpolicy_max_lifetime_enforce_stig"/>
            <description>The macOS _MUST_ be configured to enforce a maximum password lifetime limit of at least 60 days.

This rule ensures that users are forced to change their passwords frequently enough to prevent malicious users from gaining and maintaining access to the system.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_max_lifetime_enforce_stig" test_ref="oval:mscp:tst:340"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:341" version="1" class="compliance">
          <metadata>
            <title>Prohibit Password Reuse for a Minimum of 5 Generations</title>
            <reference source="CCE" ref_id="CCE-95343-0"/>
            <reference source="macos_security" ref_id="pwpolicy_history_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to enforce a password history of at least 5 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 5 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_history_enforce_recommended" test_ref="oval:mscp:tst:341"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:342" version="1" class="compliance">
          <metadata>
            <title>Prohibit Password Reuse for a Minimum of 15 Generations</title>
            <reference source="CCE" ref_id="CCE-95343-0"/>
            <reference source="macos_security" ref_id="pwpolicy_history_enforce_cis_lvl1"/>
            <description>The macOS _MUST_ be configured to enforce a password history of at least 15 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 15 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_history_enforce_cis_lvl1" test_ref="oval:mscp:tst:342"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:343" version="1" class="compliance">
          <metadata>
            <title>Prohibit Password Reuse for a Minimum of 15 Generations</title>
            <reference source="CCE" ref_id="CCE-95343-0"/>
            <reference source="macos_security" ref_id="pwpolicy_history_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to enforce a password history of at least 15 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 15 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_history_enforce_cis_lvl2" test_ref="oval:mscp:tst:343"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:344" version="1" class="compliance">
          <metadata>
            <title>Prohibit Password Reuse for a Minimum of 5 Generations</title>
            <reference source="CCE" ref_id="CCE-95343-0"/>
            <reference source="macos_security" ref_id="pwpolicy_history_enforce_stig"/>
            <description>The macOS _MUST_ be configured to enforce a password history of at least 5 previous passwords when a password is created.

This rule ensures that users are  not allowed to re-use a password that was used in any of the 5 previous password generations.

Limiting password reuse protects against malicious users attempting to gain access to the system via brute-force hacking methods.

NOTE: The guidance for password based authentication in NIST 800-53 (Rev 5) and NIST 800-63B state that complexity rules should be organizationally defined. The values defined are based off of common complexity values. But your organization may define its own password complexity rules.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_history_enforce_stig" test_ref="oval:mscp:tst:344"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:347" version="1" class="compliance">
          <metadata>
            <title>Limit Consecutive Failed Login Attempts to 3</title>
            <reference source="CCE" ref_id="CCE-95337-2"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 3. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_enforce_recommended" test_ref="oval:mscp:tst:347"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:348" version="1" class="compliance">
          <metadata>
            <title>Limit Consecutive Failed Login Attempts to 5</title>
            <reference source="CCE" ref_id="CCE-95337-2"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_enforce_cis_lvl1"/>
            <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 5. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_enforce_cis_lvl1" test_ref="oval:mscp:tst:348"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:349" version="1" class="compliance">
          <metadata>
            <title>Limit Consecutive Failed Login Attempts to 5</title>
            <reference source="CCE" ref_id="CCE-95337-2"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 5. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_enforce_cis_lvl2" test_ref="oval:mscp:tst:349"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:350" version="1" class="compliance">
          <metadata>
            <title>Limit Consecutive Failed Login Attempts to 3</title>
            <reference source="CCE" ref_id="CCE-95337-2"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_enforce_stig"/>
            <description>The macOS _MUST_ be configured to limit the number of failed login attempts to a maximum of 3. When the maximum number of failed attempts is reached, the account _MUST_ be locked for a period of time after.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_enforce_stig" test_ref="oval:mscp:tst:350"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:351" version="1" class="compliance">
          <metadata>
            <title>Prohibit Repeating, Ascending, and Descending Character Sequences</title>
            <reference source="CCE" ref_id="CCE-95349-7"/>
            <reference source="macos_security" ref_id="pwpolicy_simple_sequence_disable_recommended"/>
            <description>The macOS _MUST_ be configured to prohibit the use of repeating, ascending, and descending character sequences when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: pwpolicy_simple_sequence_disable prevents use of passwords which are regularly found in compromised password lists.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_simple_sequence_disable_recommended" test_ref="oval:mscp:tst:351"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:353" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Lowercase Character</title>
            <reference source="CCE" ref_id="CCE-95344-8"/>
            <reference source="macos_security" ref_id="pwpolicy_lower_case_character_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to require at least one lower-case character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: macOS 14 supports password policy complexity with custom regex deployed with a mobileconfig file. To use a mobileconfig file use *pwpolicy_custom_regex_enforce*.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_lower_case_character_enforce_recommended" test_ref="oval:mscp:tst:353"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:355" version="1" class="compliance">
          <metadata>
            <title>Set Account Lockout Time to 15 Minutes</title>
            <reference source="CCE" ref_id="CCE-95338-0"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_timeout_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_timeout_enforce_recommended" test_ref="oval:mscp:tst:355"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:356" version="1" class="compliance">
          <metadata>
            <title>Set Account Lockout Time to 15 Minutes</title>
            <reference source="CCE" ref_id="CCE-95338-0"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_timeout_enforce_stig"/>
            <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_timeout_enforce_stig" test_ref="oval:mscp:tst:356"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:357" version="1" class="compliance">
          <metadata>
            <title>Set Account Lockout Time to 15 Minutes</title>
            <reference source="CCE" ref_id="CCE-95338-0"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_timeout_enforce_cis_lvl1"/>
            <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl1" test_ref="oval:mscp:tst:357"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:358" version="1" class="compliance">
          <metadata>
            <title>Set Account Lockout Time to 15 Minutes</title>
            <reference source="CCE" ref_id="CCE-95338-0"/>
            <reference source="macos_security" ref_id="pwpolicy_account_lockout_timeout_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to enforce a lockout time period of at least 15 minutes when the maximum number of failed logon attempts is reached.

This rule protects against malicious users attempting to gain access to the system via brute-force hacking methods.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl2" test_ref="oval:mscp:tst:358"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:359" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Special Character</title>
            <reference source="CCE" ref_id="CCE-95350-5"/>
            <reference source="macos_security" ref_id="pwpolicy_special_character_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_special_character_enforce_recommended" test_ref="oval:mscp:tst:359"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:360" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Special Character</title>
            <reference source="CCE" ref_id="CCE-95350-5"/>
            <reference source="macos_security" ref_id="pwpolicy_special_character_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_special_character_enforce_cis_lvl2" test_ref="oval:mscp:tst:360"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:361" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Special Character</title>
            <reference source="CCE" ref_id="CCE-95350-5"/>
            <reference source="macos_security" ref_id="pwpolicy_special_character_enforce_stig"/>
            <description>The macOS _MUST_ be configured to require at least one special character be used when a password is created.

Special characters are those characters that are not alphanumeric. Examples include: ~ ! @ # $ % ^ *.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_special_character_enforce_stig" test_ref="oval:mscp:tst:361"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:362" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Numeric Character</title>
            <reference source="CCE" ref_id="CCE-95339-8"/>
            <reference source="macos_security" ref_id="pwpolicy_alpha_numeric_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to require at least one numeric character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_alpha_numeric_enforce_recommended" test_ref="oval:mscp:tst:362"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:363" version="1" class="compliance">
          <metadata>
            <title>Require a Minimum Password Length of 15 Characters</title>
            <reference source="CCE" ref_id="CCE-95346-3"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_length_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_length_enforce_recommended" test_ref="oval:mscp:tst:363"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:364" version="1" class="compliance">
          <metadata>
            <title>Require a Minimum Password Length of 15 Characters</title>
            <reference source="CCE" ref_id="CCE-95346-3"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_length_enforce_cis_lvl1"/>
            <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_length_enforce_cis_lvl1" test_ref="oval:mscp:tst:364"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:365" version="1" class="compliance">
          <metadata>
            <title>Require a Minimum Password Length of 15 Characters</title>
            <reference source="CCE" ref_id="CCE-95346-3"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_length_enforce_cis_lvl2"/>
            <description>The macOS _MUST_ be configured to require a minimum of 15 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_length_enforce_cis_lvl2" test_ref="oval:mscp:tst:365"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:366" version="1" class="compliance">
          <metadata>
            <title>Require a Minimum Password Length of 14 Characters</title>
            <reference source="CCE" ref_id="CCE-95346-3"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_length_enforce_stig"/>
            <description>The macOS _MUST_ be configured to require a minimum of 14 characters be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_length_enforce_stig" test_ref="oval:mscp:tst:366"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:367" version="1" class="compliance">
          <metadata>
            <title>Require Passwords Contain a Minimum of One Uppercase Character</title>
            <reference source="CCE" ref_id="CCE-95353-9"/>
            <reference source="macos_security" ref_id="pwpolicy_upper_case_character_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to require at least one uppercase character be used when a password is created.

This rule enforces password complexity by requiring users to set passwords that are less vulnerable to malicious users.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.

NOTE: macOS 14 supports password policy complexity with custom regex deployed with a mobileconfig file. To use a mobileconfig file use *pwpolicy_custom_regex_enforce*.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_upper_case_character_enforce_recommended" test_ref="oval:mscp:tst:367"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:369" version="1" class="compliance">
          <metadata>
            <title>Set Minimum Password Lifetime to 24 Hours</title>
            <reference source="CCE" ref_id="CCE-95347-1"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_lifetime_enforce_recommended"/>
            <description>The macOS _MUST_ be configured to enforce a minimum password lifetime limit of 24 hours.

This rule discourages users from cycling through their previous passwords to get back to a preferred one.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_lifetime_enforce_recommended" test_ref="oval:mscp:tst:369"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:370" version="1" class="compliance">
          <metadata>
            <title>Set Minimum Password Lifetime to 24 Hours</title>
            <reference source="CCE" ref_id="CCE-95347-1"/>
            <reference source="macos_security" ref_id="pwpolicy_minimum_lifetime_enforce_stig"/>
            <description>The macOS _MUST_ be configured to enforce a minimum password lifetime limit of 24 hours.

This rule discourages users from cycling through their previous passwords to get back to a preferred one.

NOTE: To comply with Executive Order 14028, “Improving the Nation's Cybersecurity”, OMB M-22-09, “Moving the U.S. Government Toward Zero Trust Cybersecurity Principles”, and NIST SP-800-63b, “Digital Identity Guidelines: Authentication and Lifecycle Management” federal, military, and intelligence communities must adopt the following configuration settings. Password policies must not require the use of complexity policies such as upper characters, lower characters, or special characters. Password policies must also not require the use of regular rotation. Password policies should define a minimum length. Multifactor authentication should be used where ever possible.</description>
          </metadata>
          <criteria>
            <criterion comment="pwpolicy_minimum_lifetime_enforce_stig" test_ref="oval:mscp:tst:370"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:371" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Photo Library</title>
            <reference source="CCE" ref_id="CCE-95150-9"/>
            <reference source="macos_security" ref_id="icloud_photos_disable_recommended"/>
            <description>The macOS built-in Photos.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated photo synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_photos_disable_recommended" test_ref="oval:mscp:tst:371"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:372" version="1" class="compliance">
          <metadata>
            <title>Disable the System Setting for Apple ID</title>
            <reference source="CCE" ref_id="CCE-95141-8"/>
            <reference source="macos_security" ref_id="icloud_appleid_system_settings_disable_recommended"/>
            <description>The system setting for Apple ID _MUST_ be disabled.

Disabling the system setting prevents login to Apple ID and iCloud.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_appleid_system_settings_disable_recommended" test_ref="oval:mscp:tst:372"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:373" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Reminders</title>
            <reference source="CCE" ref_id="CCE-95152-5"/>
            <reference source="macos_security" ref_id="icloud_reminders_disable_recommended"/>
            <description>The macOS built-in Reminders.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated reminders synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_reminders_disable_recommended" test_ref="oval:mscp:tst:373"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:374" version="1" class="compliance">
          <metadata>
            <title>Disable the iCloud Freeform Services</title>
            <reference source="CCE" ref_id="CCE-95145-9"/>
            <reference source="macos_security" ref_id="icloud_freeform_disable_recommended"/>
            <description>The macOS built-in Freeform.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_freeform_disable_recommended" test_ref="oval:mscp:tst:374"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:375" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Desktop and Document Folder Sync</title>
            <reference source="CCE" ref_id="CCE-95153-3"/>
            <reference source="macos_security" ref_id="icloud_sync_disable_recommended"/>
            <description>The macOS system's ability to automatically synchronize a user's desktop and documents folder to their iCloud Drive _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated file synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_sync_disable_recommended" test_ref="oval:mscp:tst:375"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:376" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Game Center</title>
            <reference source="CCE" ref_id="CCE-95146-7"/>
            <reference source="macos_security" ref_id="icloud_game_center_disable_recommended"/>
            <description>This works only with supervised devices (MDM) and allows to disable Apple Game Center. The rationale is Game Center is using Apple ID and will shared data on AppleID based services, therefore, Game Center _MUST_ be disabled.
This setting also prohibits functionality of adding friends to Game Center.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_game_center_disable_recommended" test_ref="oval:mscp:tst:376"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:377" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Keychain Sync</title>
            <reference source="CCE" ref_id="CCE-95147-5"/>
            <reference source="macos_security" ref_id="icloud_keychain_disable_recommended"/>
            <description>The macOS system's ability to automatically synchronize a user's passwords to their iCloud account _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, password management and synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_keychain_disable_recommended" test_ref="oval:mscp:tst:377"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:378" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Notes</title>
            <reference source="CCE" ref_id="CCE-95149-1"/>
            <reference source="macos_security" ref_id="icloud_notes_disable_recommended"/>
            <description>The macOS built-in Notes.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated Notes synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_notes_disable_recommended" test_ref="oval:mscp:tst:378"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:379" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Private Relay</title>
            <reference source="CCE" ref_id="CCE-95151-7"/>
            <reference source="macos_security" ref_id="icloud_private_relay_disable_recommended"/>
            <description>Enterprise networks may be required to audit all network traffic by policy, therefore, iCloud Private Relay _MUST_ be disabled.

Network administrators can also prevent the use of this feature by blocking DNS resolution of mask.icloud.com and mask-h2.icloud.com.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_private_relay_disable_recommended" test_ref="oval:mscp:tst:379"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:380" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Document Sync</title>
            <reference source="CCE" ref_id="CCE-95144-2"/>
            <reference source="macos_security" ref_id="icloud_drive_disable_recommended"/>
            <description>The macOS built-in iCloud document synchronization service _MUST_ be disabled to prevent organizational data from being synchronized to personal or non-approved storage.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated document synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_drive_disable_recommended" test_ref="oval:mscp:tst:380"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:381" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Bookmarks</title>
            <reference source="CCE" ref_id="CCE-95142-6"/>
            <reference source="macos_security" ref_id="icloud_bookmarks_disable_recommended"/>
            <description>The macOS built-in Safari.app bookmark synchronization via the iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated bookmark synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_bookmarks_disable_recommended" test_ref="oval:mscp:tst:381"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:382" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Mail</title>
            <reference source="CCE" ref_id="CCE-95148-3"/>
            <reference source="macos_security" ref_id="icloud_mail_disable_recommended"/>
            <description>The macOS built-in Mail.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated mail synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_mail_disable_recommended" test_ref="oval:mscp:tst:382"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:383" version="1" class="compliance">
          <metadata>
            <title>Disable the iCloud Calendar Services</title>
            <reference source="CCE" ref_id="CCE-95143-4"/>
            <reference source="macos_security" ref_id="icloud_calendar_disable_recommended"/>
            <description>The macOS built-in Calendar.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data and, therefore, automated calendar synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_calendar_disable_recommended" test_ref="oval:mscp:tst:383"/>
          </criteria>
        </definition>
        <definition id="oval:mscp:def:384" version="1" class="compliance">
          <metadata>
            <title>Disable iCloud Address Book</title>
            <reference source="CCE" ref_id="CCE-95140-0"/>
            <reference source="macos_security" ref_id="icloud_addressbook_disable_recommended"/>
            <description>The macOS built-in Contacts.app connection to Apple's iCloud service _MUST_ be disabled.

Apple's iCloud service does not provide an organization with enough control over the storage and access of data, and, therefore, automated contact synchronization _MUST_ be controlled by an organization approved service.</description>
          </metadata>
          <criteria>
            <criterion comment="icloud_addressbook_disable_recommended" test_ref="oval:mscp:tst:384"/>
          </criteria>
        </definition>
      </definitions>
      <tests>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:1" version="1" comment="system_settings_internet_accounts_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:1"/>
          <state state_ref="oval:mscp:ste:1"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:2" version="1" comment="system_settings_time_machine_encrypted_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:2"/>
          <state state_ref="oval:mscp:ste:2"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:3" version="1" comment="system_settings_install_macos_updates_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:3"/>
          <state state_ref="oval:mscp:ste:3"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:4" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:4"/>
          <state state_ref="oval:mscp:ste:4"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:5" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:5"/>
          <state state_ref="oval:mscp:ste:5"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:6" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:6"/>
          <state state_ref="oval:mscp:ste:6"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:7" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:7"/>
          <state state_ref="oval:mscp:ste:7"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:8" version="1" comment="system_settings_wallet_applepay_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:8"/>
          <state state_ref="oval:mscp:ste:8"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:9" version="1" comment="system_settings_location_services_menu_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:9"/>
          <state state_ref="oval:mscp:ste:9"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:10" version="1" comment="system_settings_guest_access_smb_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:10"/>
          <state state_ref="oval:mscp:ste:10"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:11" version="1" comment="system_settings_printer_sharing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:11"/>
          <state state_ref="oval:mscp:ste:11"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:12" version="1" comment="system_settings_bluetooth_menu_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:12"/>
          <state state_ref="oval:mscp:ste:12"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:13" version="1" comment="system_settings_system_wide_preferences_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:13"/>
          <state state_ref="oval:mscp:ste:13"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:14" version="1" comment="system_settings_location_services_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:14"/>
          <state state_ref="oval:mscp:ste:14"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:15" version="1" comment="system_settings_improve_search_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:15"/>
          <state state_ref="oval:mscp:ste:15"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:16" version="1" comment="system_settings_guest_account_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:16"/>
          <state state_ref="oval:mscp:ste:16"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:17" version="1" comment="system_settings_software_update_download_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:17"/>
          <state state_ref="oval:mscp:ste:17"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:18" version="1" comment="system_settings_personalized_advertising_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:18"/>
          <state state_ref="oval:mscp:ste:18"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:19" version="1" comment="system_settings_bluetooth_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:19"/>
          <state state_ref="oval:mscp:ste:19"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:20" version="1" comment="system_settings_remote_management_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:20"/>
          <state state_ref="oval:mscp:ste:20"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:21" version="1" comment="system_settings_loginwindow_prompt_username_password_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:21"/>
          <state state_ref="oval:mscp:ste:21"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:22" version="1" comment="system_settings_apple_watch_unlock_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:22"/>
          <state state_ref="oval:mscp:ste:22"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:23" version="1" comment="system_settings_smbd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:23"/>
          <state state_ref="oval:mscp:ste:23"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:24" version="1" comment="system_settings_hot_corners_secure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:24"/>
          <state state_ref="oval:mscp:ste:24"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:25" version="1" comment="system_settings_screensaver_timeout_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:25"/>
          <state state_ref="oval:mscp:ste:25"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:26" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:26"/>
          <state state_ref="oval:mscp:ste:26"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:27" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:27"/>
          <state state_ref="oval:mscp:ste:27"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:28" version="1" comment="system_settings_screensaver_timeout_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:28"/>
          <state state_ref="oval:mscp:ste:28"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:29" version="1" comment="system_settings_automatic_logout_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:29"/>
          <state state_ref="oval:mscp:ste:29"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:30" version="1" comment="system_settings_automatic_logout_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:30"/>
          <state state_ref="oval:mscp:ste:30"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:31" version="1" comment="system_settings_password_hints_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:31"/>
          <state state_ref="oval:mscp:ste:31"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:32" version="1" comment="system_settings_screen_sharing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:32"/>
          <state state_ref="oval:mscp:ste:32"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:33" version="1" comment="system_settings_time_machine_auto_backup_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:33"/>
          <state state_ref="oval:mscp:ste:33"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:34" version="1" comment="system_settings_touchid_unlock_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:34"/>
          <state state_ref="oval:mscp:ste:34"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:36" version="1" comment="system_settings_softwareupdate_current_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:36"/>
          <state state_ref="oval:mscp:ste:36"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:37" version="1" comment="system_settings_external_intelligence_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:37"/>
          <state state_ref="oval:mscp:ste:37"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:38" version="1" comment="system_settings_siri_listen_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:38"/>
          <state state_ref="oval:mscp:ste:38"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:39" version="1" comment="system_settings_internet_sharing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:39"/>
          <state state_ref="oval:mscp:ste:39"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:40" version="1" comment="system_settings_filevault_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:40"/>
          <state state_ref="oval:mscp:ste:40"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:41" version="1" comment="system_settings_gatekeeper_override_disallow_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:41"/>
          <state state_ref="oval:mscp:ste:41"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:42" version="1" comment="system_settings_ssh_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:42"/>
          <state state_ref="oval:mscp:ste:42"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:43" version="1" comment="system_settings_siri_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:43"/>
          <state state_ref="oval:mscp:ste:43"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:44" version="1" comment="system_settings_content_caching_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:44"/>
          <state state_ref="oval:mscp:ste:44"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:45" version="1" comment="system_settings_ssh_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:45"/>
          <state state_ref="oval:mscp:ste:45"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:46" version="1" comment="system_settings_gatekeeper_identified_developers_allowed_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:46"/>
          <state state_ref="oval:mscp:ste:46"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:47" version="1" comment="system_settings_screensaver_password_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:47"/>
          <state state_ref="oval:mscp:ste:47"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:48" version="1" comment="system_settings_firewall_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:48"/>
          <state state_ref="oval:mscp:ste:48"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:49" version="1" comment="system_settings_find_my_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:49"/>
          <state state_ref="oval:mscp:ste:49"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:50" version="1" comment="system_settings_hot_corners_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:50"/>
          <state state_ref="oval:mscp:ste:50"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:51" version="1" comment="system_settings_diagnostics_reports_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:51"/>
          <state state_ref="oval:mscp:ste:51"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:52" version="1" comment="system_settings_critical_update_install_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:52"/>
          <state state_ref="oval:mscp:ste:52"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:53" version="1" comment="system_settings_wake_network_access_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:53"/>
          <state state_ref="oval:mscp:ste:53"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:54" version="1" comment="system_settings_bluetooth_sharing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:54"/>
          <state state_ref="oval:mscp:ste:54"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:55" version="1" comment="system_settings_automatic_login_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:55"/>
          <state state_ref="oval:mscp:ste:55"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:56" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:56"/>
          <state state_ref="oval:mscp:ste:56"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:57" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:57"/>
          <state state_ref="oval:mscp:ste:57"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:58" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:58"/>
          <state state_ref="oval:mscp:ste:58"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:59" version="1" comment="system_settings_improve_siri_dictation_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:59"/>
          <state state_ref="oval:mscp:ste:59"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:60" version="1" comment="system_settings_download_software_update_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:60"/>
          <state state_ref="oval:mscp:ste:60"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:61" version="1" comment="system_settings_touch_id_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:61"/>
          <state state_ref="oval:mscp:ste:61"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:62" version="1" comment="system_settings_external_intelligence_sign_in_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:62"/>
          <state state_ref="oval:mscp:ste:62"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:63" version="1" comment="system_settings_bluetooth_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:63"/>
          <state state_ref="oval:mscp:ste:63"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:64" version="1" comment="system_settings_location_services_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:64"/>
          <state state_ref="oval:mscp:ste:64"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:65" version="1" comment="system_settings_usb_restricted_mode_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:65"/>
          <state state_ref="oval:mscp:ste:65"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:66" version="1" comment="system_settings_time_server_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:66"/>
          <state state_ref="oval:mscp:ste:66"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:67" version="1" comment="system_settings_time_server_configure_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:67"/>
          <state state_ref="oval:mscp:ste:67"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:68" version="1" comment="system_settings_time_server_configure_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:68"/>
          <state state_ref="oval:mscp:ste:68"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:69" version="1" comment="system_settings_time_server_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:69"/>
          <state state_ref="oval:mscp:ste:69"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:70" version="1" comment="system_settings_time_server_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:70"/>
          <state state_ref="oval:mscp:ste:70"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:71" version="1" comment="system_settings_siri_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:71"/>
          <state state_ref="oval:mscp:ste:71"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:72" version="1" comment="system_settings_improve_assistive_voice_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:72"/>
          <state state_ref="oval:mscp:ste:72"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:73" version="1" comment="system_settings_airplay_receiver_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:73"/>
          <state state_ref="oval:mscp:ste:73"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:74" version="1" comment="system_settings_security_update_install_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:74"/>
          <state state_ref="oval:mscp:ste:74"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:75" version="1" comment="system_settings_token_removal_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:75"/>
          <state state_ref="oval:mscp:ste:75"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:76" version="1" comment="system_settings_media_sharing_disabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:76"/>
          <state state_ref="oval:mscp:ste:76"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:77" version="1" comment="system_settings_wifi_menu_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:77"/>
          <state state_ref="oval:mscp:ste:77"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:78" version="1" comment="system_settings_firewall_stealth_mode_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:78"/>
          <state state_ref="oval:mscp:ste:78"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:79" version="1" comment="system_settings_rae_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:79"/>
          <state state_ref="oval:mscp:ste:79"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:81" version="1" comment="auth_pam_login_smartcard_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:81"/>
          <state state_ref="oval:mscp:ste:81"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:82" version="1" comment="auth_smartcard_allow_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:82"/>
          <state state_ref="oval:mscp:ste:82"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:83" version="1" comment="auth_pam_sudo_smartcard_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:83"/>
          <state state_ref="oval:mscp:ste:83"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:84" version="1" comment="auth_smartcard_certificate_trust_enforce_high_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:84"/>
          <state state_ref="oval:mscp:ste:84"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:85" version="1" comment="auth_smartcard_certificate_trust_enforce_moderate_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:85"/>
          <state state_ref="oval:mscp:ste:85"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:86" version="1" comment="auth_smartcard_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:86"/>
          <state state_ref="oval:mscp:ste:86"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:87" version="1" comment="auth_pam_su_smartcard_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:87"/>
          <state state_ref="oval:mscp:ste:87"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:88" version="1" comment="auth_ssh_password_authentication_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:88"/>
          <state state_ref="oval:mscp:ste:88"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:89" version="1" comment="audit_flags_fd_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:89"/>
          <state state_ref="oval:mscp:ste:89"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:91" version="1" comment="audit_folder_group_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:91"/>
          <state state_ref="oval:mscp:ste:91"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:92" version="1" comment="audit_failure_halt_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:92"/>
          <state state_ref="oval:mscp:ste:92"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:93" version="1" comment="audit_flags_fm_failed_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:93"/>
          <state state_ref="oval:mscp:ste:93"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:96" version="1" comment="audit_control_mode_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:96"/>
          <state state_ref="oval:mscp:ste:96"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:97" version="1" comment="audit_acls_folders_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:97"/>
          <state state_ref="oval:mscp:ste:97"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:98" version="1" comment="audit_flags_fm_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:98"/>
          <state state_ref="oval:mscp:ste:98"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:99" version="1" comment="audit_auditd_enabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:99"/>
          <state state_ref="oval:mscp:ste:99"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:100" version="1" comment="audit_flags_ad_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:100"/>
          <state state_ref="oval:mscp:ste:100"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:101" version="1" comment="audit_flags_ex_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:101"/>
          <state state_ref="oval:mscp:ste:101"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:102" version="1" comment="audit_files_mode_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:102"/>
          <state state_ref="oval:mscp:ste:102"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:103" version="1" comment="audit_flags_aa_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:103"/>
          <state state_ref="oval:mscp:ste:103"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:104" version="1" comment="audit_control_owner_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:104"/>
          <state state_ref="oval:mscp:ste:104"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:105" version="1" comment="audit_files_owner_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:105"/>
          <state state_ref="oval:mscp:ste:105"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:106" version="1" comment="audit_retention_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:106"/>
          <state state_ref="oval:mscp:ste:106"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:107" version="1" comment="audit_retention_configure_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:107"/>
          <state state_ref="oval:mscp:ste:107"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:108" version="1" comment="audit_retention_configure_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:108"/>
          <state state_ref="oval:mscp:ste:108"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:109" version="1" comment="audit_retention_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:109"/>
          <state state_ref="oval:mscp:ste:109"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:110" version="1" comment="audit_flags_fr_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:110"/>
          <state state_ref="oval:mscp:ste:110"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:111" version="1" comment="audit_settings_failure_notify_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:111"/>
          <state state_ref="oval:mscp:ste:111"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:112" version="1" comment="audit_folder_owner_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:112"/>
          <state state_ref="oval:mscp:ste:112"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:114" version="1" comment="audit_control_acls_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:114"/>
          <state state_ref="oval:mscp:ste:114"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:115" version="1" comment="audit_flags_lo_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:115"/>
          <state state_ref="oval:mscp:ste:115"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:117" version="1" comment="audit_flags_fw_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:117"/>
          <state state_ref="oval:mscp:ste:117"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:118" version="1" comment="audit_folders_mode_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:118"/>
          <state state_ref="oval:mscp:ste:118"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:119" version="1" comment="audit_configure_capacity_notify_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:119"/>
          <state state_ref="oval:mscp:ste:119"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:120" version="1" comment="audit_configure_capacity_notify_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:120"/>
          <state state_ref="oval:mscp:ste:120"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:121" version="1" comment="audit_files_group_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:121"/>
          <state state_ref="oval:mscp:ste:121"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:122" version="1" comment="audit_control_group_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:122"/>
          <state state_ref="oval:mscp:ste:122"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:123" version="1" comment="audit_acls_files_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:123"/>
          <state state_ref="oval:mscp:ste:123"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:126" version="1" comment="os_sshd_unused_connection_timeout_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:126"/>
          <state state_ref="oval:mscp:ste:126"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:127" version="1" comment="os_sshd_unused_connection_timeout_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:127"/>
          <state state_ref="oval:mscp:ste:127"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:129" version="1" comment="os_sshd_login_grace_time_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:129"/>
          <state state_ref="oval:mscp:ste:129"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:130" version="1" comment="os_sshd_login_grace_time_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:130"/>
          <state state_ref="oval:mscp:ste:130"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:132" version="1" comment="os_newsyslog_files_owner_group_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:132"/>
          <state state_ref="oval:mscp:ste:132"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:133" version="1" comment="os_firewall_default_deny_require_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:133"/>
          <state state_ref="oval:mscp:ste:133"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:136" version="1" comment="os_dvdram_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:136"/>
          <state state_ref="oval:mscp:ste:136"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:138" version="1" comment="os_sshd_fips_compliant_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:138"/>
          <state state_ref="oval:mscp:ste:138"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:139" version="1" comment="os_firmware_password_require_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:139"/>
          <state state_ref="oval:mscp:ste:139"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:140" version="1" comment="os_photos_enhanced_search_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:140"/>
          <state state_ref="oval:mscp:ste:140"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:141" version="1" comment="os_power_nap_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:141"/>
          <state state_ref="oval:mscp:ste:141"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:142" version="1" comment="os_safari_warn_fraudulent_website_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:142"/>
          <state state_ref="oval:mscp:ste:142"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:143" version="1" comment="os_power_nap_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:143"/>
          <state state_ref="oval:mscp:ste:143"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:144" version="1" comment="os_root_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:144"/>
          <state state_ref="oval:mscp:ste:144"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:146" version="1" comment="os_policy_banner_ssh_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:146"/>
          <state state_ref="oval:mscp:ste:146"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:148" version="1" comment="os_safari_clear_history_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:148"/>
          <state state_ref="oval:mscp:ste:148"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:150" version="1" comment="os_password_proximity_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:150"/>
          <state state_ref="oval:mscp:ste:150"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:151" version="1" comment="os_library_validation_enabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:151"/>
          <state state_ref="oval:mscp:ste:151"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:152" version="1" comment="os_notes_transcription_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:152"/>
          <state state_ref="oval:mscp:ste:152"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:153" version="1" comment="os_mdm_require_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:153"/>
          <state state_ref="oval:mscp:ste:153"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:154" version="1" comment="os_skip_apple_intelligence_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:154"/>
          <state state_ref="oval:mscp:ste:154"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:159" version="1" comment="os_anti_virus_installed_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:159"/>
          <state state_ref="oval:mscp:ste:159"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:161" version="1" comment="os_screensaver_loginwindow_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:161"/>
          <state state_ref="oval:mscp:ste:161"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:162" version="1" comment="os_mail_smart_reply_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:162"/>
          <state state_ref="oval:mscp:ste:162"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:163" version="1" comment="os_world_writable_system_folder_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:163"/>
          <state state_ref="oval:mscp:ste:163"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:164" version="1" comment="os_handoff_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:164"/>
          <state state_ref="oval:mscp:ste:164"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:166" version="1" comment="os_iphone_mirroring_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:166"/>
          <state state_ref="oval:mscp:ste:166"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:170" version="1" comment="os_safari_open_safe_downloads_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:170"/>
          <state state_ref="oval:mscp:ste:170"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:171" version="1" comment="os_ssh_server_alive_interval_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:171"/>
          <state state_ref="oval:mscp:ste:171"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:172" version="1" comment="os_ssh_server_alive_interval_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:172"/>
          <state state_ref="oval:mscp:ste:172"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:173" version="1" comment="os_mail_summary_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:173"/>
          <state state_ref="oval:mscp:ste:173"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:174" version="1" comment="os_ssh_fips_compliant_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:174"/>
          <state state_ref="oval:mscp:ste:174"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:178" version="1" comment="os_rapid_security_response_allow_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:178"/>
          <state state_ref="oval:mscp:ste:178"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:181" version="1" comment="os_network_storage_restriction_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:181"/>
          <state state_ref="oval:mscp:ste:181"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:182" version="1" comment="os_time_offset_limit_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:182"/>
          <state state_ref="oval:mscp:ste:182"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:183" version="1" comment="os_tftpd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:183"/>
          <state state_ref="oval:mscp:ste:183"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:184" version="1" comment="os_password_autofill_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:184"/>
          <state state_ref="oval:mscp:ste:184"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:185" version="1" comment="os_sshd_client_alive_interval_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:185"/>
          <state state_ref="oval:mscp:ste:185"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:186" version="1" comment="os_sshd_client_alive_interval_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:186"/>
          <state state_ref="oval:mscp:ste:186"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:188" version="1" comment="os_asl_log_files_permissions_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:188"/>
          <state state_ref="oval:mscp:ste:188"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:191" version="1" comment="os_safari_private_browsing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:191"/>
          <state state_ref="oval:mscp:ste:191"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:192" version="1" comment="os_password_sharing_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:192"/>
          <state state_ref="oval:mscp:ste:192"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:193" version="1" comment="os_blank_bluray_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:193"/>
          <state state_ref="oval:mscp:ste:193"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:195" version="1" comment="os_notes_transcription_summary_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:195"/>
          <state state_ref="oval:mscp:ste:195"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:197" version="1" comment="os_authenticated_root_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:197"/>
          <state state_ref="oval:mscp:ste:197"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:198" version="1" comment="os_screensaver_timeout_loginwindow_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:198"/>
          <state state_ref="oval:mscp:ste:198"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:200" version="1" comment="os_safari_advertising_privacy_protection_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:200"/>
          <state state_ref="oval:mscp:ste:200"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:202" version="1" comment="os_config_data_install_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:202"/>
          <state state_ref="oval:mscp:ste:202"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:203" version="1" comment="os_setup_assistant_filevault_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:203"/>
          <state state_ref="oval:mscp:ste:203"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:207" version="1" comment="os_sleep_and_display_sleep_apple_silicon_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:207"/>
          <state state_ref="oval:mscp:ste:207"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:208" version="1" comment="os_guest_folder_removed_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:208"/>
          <state state_ref="oval:mscp:ste:208"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:210" version="1" comment="os_password_hint_remove_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:210"/>
          <state state_ref="oval:mscp:ste:210"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:211" version="1" comment="os_disk_image_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:211"/>
          <state state_ref="oval:mscp:ste:211"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:212" version="1" comment="os_sshd_client_alive_count_max_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:212"/>
          <state state_ref="oval:mscp:ste:212"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:213" version="1" comment="os_sshd_client_alive_count_max_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:213"/>
          <state state_ref="oval:mscp:ste:213"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:215" version="1" comment="os_privacy_setup_prompt_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:215"/>
          <state state_ref="oval:mscp:ste:215"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:217" version="1" comment="os_software_update_app_update_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:217"/>
          <state state_ref="oval:mscp:ste:217"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:219" version="1" comment="os_image_playground_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:219"/>
          <state state_ref="oval:mscp:ste:219"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:220" version="1" comment="os_secure_boot_verify_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:220"/>
          <state state_ref="oval:mscp:ste:220"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:221" version="1" comment="os_sudo_log_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:221"/>
          <state state_ref="oval:mscp:ste:221"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:223" version="1" comment="os_uucp_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:223"/>
          <state state_ref="oval:mscp:ste:223"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:224" version="1" comment="os_burn_support_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:224"/>
          <state state_ref="oval:mscp:ste:224"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:225" version="1" comment="os_policy_banner_loginwindow_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:225"/>
          <state state_ref="oval:mscp:ste:225"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:226" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:226"/>
          <state state_ref="oval:mscp:ste:226"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:227" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:227"/>
          <state state_ref="oval:mscp:ste:227"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:228" version="1" comment="os_policy_banner_loginwindow_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:228"/>
          <state state_ref="oval:mscp:ste:228"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:229" version="1" comment="os_writing_tools_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:229"/>
          <state state_ref="oval:mscp:ste:229"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:230" version="1" comment="os_user_app_installation_prohibit_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:230"/>
          <state state_ref="oval:mscp:ste:230"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:234" version="1" comment="os_rapid_security_response_removal_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:234"/>
          <state state_ref="oval:mscp:ste:234"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:235" version="1" comment="os_touchid_prompt_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:235"/>
          <state state_ref="oval:mscp:ste:235"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:236" version="1" comment="os_filevault_autologin_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:236"/>
          <state state_ref="oval:mscp:ste:236"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:237" version="1" comment="os_skip_screen_time_prompt_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:237"/>
          <state state_ref="oval:mscp:ste:237"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:239" version="1" comment="os_blank_cd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:239"/>
          <state state_ref="oval:mscp:ste:239"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:241" version="1" comment="os_messages_app_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:241"/>
          <state state_ref="oval:mscp:ste:241"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:242" version="1" comment="os_config_profile_ui_install_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:242"/>
          <state state_ref="oval:mscp:ste:242"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:244" version="1" comment="os_sshd_per_source_penalties_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:244"/>
          <state state_ref="oval:mscp:ste:244"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:246" version="1" comment="os_genmoji_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:246"/>
          <state state_ref="oval:mscp:ste:246"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:247" version="1" comment="os_airdrop_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:247"/>
          <state state_ref="oval:mscp:ste:247"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:248" version="1" comment="os_sudoers_timestamp_type_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:248"/>
          <state state_ref="oval:mscp:ste:248"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:251" version="1" comment="os_parental_controls_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:251"/>
          <state state_ref="oval:mscp:ste:251"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:254" version="1" comment="os_system_read_only_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:254"/>
          <state state_ref="oval:mscp:ste:254"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:255" version="1" comment="os_ssh_server_alive_count_max_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:255"/>
          <state state_ref="oval:mscp:ste:255"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:256" version="1" comment="os_ssh_server_alive_count_max_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:256"/>
          <state state_ref="oval:mscp:ste:256"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:257" version="1" comment="os_hibernate_mode_destroyfvkeyonstandby_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:257"/>
          <state state_ref="oval:mscp:ste:257"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:258" version="1" comment="os_nfsd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:258"/>
          <state state_ref="oval:mscp:ste:258"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:260" version="1" comment="os_sshd_permit_root_login_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:260"/>
          <state state_ref="oval:mscp:ste:260"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:261" version="1" comment="os_account_modification_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:261"/>
          <state state_ref="oval:mscp:ste:261"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:262" version="1" comment="os_httpd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:262"/>
          <state state_ref="oval:mscp:ste:262"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:264" version="1" comment="os_asl_log_files_owner_group_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:264"/>
          <state state_ref="oval:mscp:ste:264"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:265" version="1" comment="os_hibernate_mode_intel_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:265"/>
          <state state_ref="oval:mscp:ste:265"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:268" version="1" comment="os_recovery_lock_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:268"/>
          <state state_ref="oval:mscp:ste:268"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:269" version="1" comment="os_blank_dvd_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:269"/>
          <state state_ref="oval:mscp:ste:269"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:270" version="1" comment="os_loginwindow_adminhostinfo_disabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:270"/>
          <state state_ref="oval:mscp:ste:270"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:271" version="1" comment="os_safari_show_full_website_address_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:271"/>
          <state state_ref="oval:mscp:ste:271"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:273" version="1" comment="os_mobile_file_integrity_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:273"/>
          <state state_ref="oval:mscp:ste:273"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:274" version="1" comment="os_gatekeeper_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:274"/>
          <state state_ref="oval:mscp:ste:274"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:275" version="1" comment="os_sip_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:275"/>
          <state state_ref="oval:mscp:ste:275"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:276" version="1" comment="os_removable_media_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:276"/>
          <state state_ref="oval:mscp:ste:276"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:277" version="1" comment="os_world_writable_library_folder_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:277"/>
          <state state_ref="oval:mscp:ste:277"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:278" version="1" comment="os_dictation_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:278"/>
          <state state_ref="oval:mscp:ste:278"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:279" version="1" comment="os_policy_banner_ssh_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:279"/>
          <state state_ref="oval:mscp:ste:279"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:280" version="1" comment="os_policy_banner_ssh_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:280"/>
          <state state_ref="oval:mscp:ste:280"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:281" version="1" comment="os_terminal_secure_keyboard_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:281"/>
          <state state_ref="oval:mscp:ste:281"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:283" version="1" comment="os_time_server_enabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:283"/>
          <state state_ref="oval:mscp:ste:283"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:284" version="1" comment="os_unlock_active_user_session_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:284"/>
          <state state_ref="oval:mscp:ste:284"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:285" version="1" comment="os_unlock_active_user_session_disable_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:285"/>
          <state state_ref="oval:mscp:ste:285"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:286" version="1" comment="os_unlock_active_user_session_disable_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:286"/>
          <state state_ref="oval:mscp:ste:286"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:287" version="1" comment="os_unlock_active_user_session_disable_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:287"/>
          <state state_ref="oval:mscp:ste:287"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:289" version="1" comment="os_sudo_timeout_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:289"/>
          <state state_ref="oval:mscp:ste:289"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:290" version="1" comment="os_sudo_timeout_configure_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:290"/>
          <state state_ref="oval:mscp:ste:290"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:291" version="1" comment="os_sudo_timeout_configure_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:291"/>
          <state state_ref="oval:mscp:ste:291"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:292" version="1" comment="os_sudo_timeout_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:292"/>
          <state state_ref="oval:mscp:ste:292"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:293" version="1" comment="os_siri_prompt_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:293"/>
          <state state_ref="oval:mscp:ste:293"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:294" version="1" comment="os_appleid_prompt_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:294"/>
          <state state_ref="oval:mscp:ste:294"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:297" version="1" comment="os_directory_services_configured_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:297"/>
          <state state_ref="oval:mscp:ste:297"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:298" version="1" comment="os_safari_show_status_bar_enabled_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:298"/>
          <state state_ref="oval:mscp:ste:298"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:300" version="1" comment="os_skip_unlock_with_watch_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:300"/>
          <state state_ref="oval:mscp:ste:300"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:301" version="1" comment="os_safari_reader_summary_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:301"/>
          <state state_ref="oval:mscp:ste:301"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:303" version="1" comment="os_system_wide_applications_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:303"/>
          <state state_ref="oval:mscp:ste:303"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:305" version="1" comment="os_software_update_deferral_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:305"/>
          <state state_ref="oval:mscp:ste:305"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:306" version="1" comment="os_software_update_deferral_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:306"/>
          <state state_ref="oval:mscp:ste:306"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:307" version="1" comment="os_software_update_deferral_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:307"/>
          <state state_ref="oval:mscp:ste:307"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:308" version="1" comment="os_newsyslog_files_permissions_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:308"/>
          <state state_ref="oval:mscp:ste:308"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:309" version="1" comment="os_home_folders_secure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:309"/>
          <state state_ref="oval:mscp:ste:309"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:310" version="1" comment="os_bluray_read_only_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:310"/>
          <state state_ref="oval:mscp:ste:310"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:311" version="1" comment="os_facetime_app_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:311"/>
          <state state_ref="oval:mscp:ste:311"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:312" version="1" comment="os_camera_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:312"/>
          <state state_ref="oval:mscp:ste:312"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:313" version="1" comment="os_on_device_dictation_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:313"/>
          <state state_ref="oval:mscp:ste:313"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:314" version="1" comment="os_external_storage_access_defined_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:314"/>
          <state state_ref="oval:mscp:ste:314"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:315" version="1" comment="os_install_log_retention_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:315"/>
          <state state_ref="oval:mscp:ste:315"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:316" version="1" comment="os_install_log_retention_configure_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:316"/>
          <state state_ref="oval:mscp:ste:316"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:317" version="1" comment="os_install_log_retention_configure_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:317"/>
          <state state_ref="oval:mscp:ste:317"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:318" version="1" comment="os_install_log_retention_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:318"/>
          <state state_ref="oval:mscp:ste:318"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:319" version="1" comment="os_icloud_storage_prompt_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:319"/>
          <state state_ref="oval:mscp:ste:319"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:320" version="1" comment="os_erase_content_and_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:320"/>
          <state state_ref="oval:mscp:ste:320"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:321" version="1" comment="os_ir_support_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:321"/>
          <state state_ref="oval:mscp:ste:321"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:322" version="1" comment="os_cd_read_only_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:322"/>
          <state state_ref="oval:mscp:ste:322"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:323" version="1" comment="os_sshd_channel_timeout_configure_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:323"/>
          <state state_ref="oval:mscp:ste:323"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:324" version="1" comment="os_sshd_channel_timeout_configure_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:324"/>
          <state state_ref="oval:mscp:ste:324"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:325" version="1" comment="os_safari_prevent_cross-site_tracking_enable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:325"/>
          <state state_ref="oval:mscp:ste:325"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:326" version="1" comment="os_mail_app_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:326"/>
          <state state_ref="oval:mscp:ste:326"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:329" version="1" comment="os_bonjour_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:329"/>
          <state state_ref="oval:mscp:ste:329"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:330" version="1" comment="os_calendar_app_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:330"/>
          <state state_ref="oval:mscp:ste:330"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:331" version="1" comment="pwpolicy_account_inactivity_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:331"/>
          <state state_ref="oval:mscp:ste:331"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:332" version="1" comment="pwpolicy_account_inactivity_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:332"/>
          <state state_ref="oval:mscp:ste:332"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:333" version="1" comment="pwpolicy_custom_regex_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:333"/>
          <state state_ref="oval:mscp:ste:333"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:334" version="1" comment="pwpolicy_custom_regex_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:334"/>
          <state state_ref="oval:mscp:ste:334"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:335" version="1" comment="pwpolicy_custom_regex_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:335"/>
          <state state_ref="oval:mscp:ste:335"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:337" version="1" comment="pwpolicy_max_lifetime_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:337"/>
          <state state_ref="oval:mscp:ste:337"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:338" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:338"/>
          <state state_ref="oval:mscp:ste:338"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:339" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:339"/>
          <state state_ref="oval:mscp:ste:339"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:340" version="1" comment="pwpolicy_max_lifetime_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:340"/>
          <state state_ref="oval:mscp:ste:340"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:341" version="1" comment="pwpolicy_history_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:341"/>
          <state state_ref="oval:mscp:ste:341"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:342" version="1" comment="pwpolicy_history_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:342"/>
          <state state_ref="oval:mscp:ste:342"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:343" version="1" comment="pwpolicy_history_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:343"/>
          <state state_ref="oval:mscp:ste:343"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:344" version="1" comment="pwpolicy_history_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:344"/>
          <state state_ref="oval:mscp:ste:344"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:347" version="1" comment="pwpolicy_account_lockout_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:347"/>
          <state state_ref="oval:mscp:ste:347"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:348" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:348"/>
          <state state_ref="oval:mscp:ste:348"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:349" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:349"/>
          <state state_ref="oval:mscp:ste:349"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:350" version="1" comment="pwpolicy_account_lockout_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:350"/>
          <state state_ref="oval:mscp:ste:350"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:351" version="1" comment="pwpolicy_simple_sequence_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:351"/>
          <state state_ref="oval:mscp:ste:351"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:353" version="1" comment="pwpolicy_lower_case_character_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:353"/>
          <state state_ref="oval:mscp:ste:353"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:355" version="1" comment="pwpolicy_account_lockout_timeout_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:355"/>
          <state state_ref="oval:mscp:ste:355"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:356" version="1" comment="pwpolicy_account_lockout_timeout_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:356"/>
          <state state_ref="oval:mscp:ste:356"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:357" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:357"/>
          <state state_ref="oval:mscp:ste:357"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:358" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:358"/>
          <state state_ref="oval:mscp:ste:358"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:359" version="1" comment="pwpolicy_special_character_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:359"/>
          <state state_ref="oval:mscp:ste:359"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:360" version="1" comment="pwpolicy_special_character_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:360"/>
          <state state_ref="oval:mscp:ste:360"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:361" version="1" comment="pwpolicy_special_character_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:361"/>
          <state state_ref="oval:mscp:ste:361"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:362" version="1" comment="pwpolicy_alpha_numeric_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:362"/>
          <state state_ref="oval:mscp:ste:362"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:363" version="1" comment="pwpolicy_minimum_length_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:363"/>
          <state state_ref="oval:mscp:ste:363"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:364" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl1_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:364"/>
          <state state_ref="oval:mscp:ste:364"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:365" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl2_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:365"/>
          <state state_ref="oval:mscp:ste:365"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:366" version="1" comment="pwpolicy_minimum_length_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:366"/>
          <state state_ref="oval:mscp:ste:366"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:367" version="1" comment="pwpolicy_upper_case_character_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:367"/>
          <state state_ref="oval:mscp:ste:367"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:369" version="1" comment="pwpolicy_minimum_lifetime_enforce_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:369"/>
          <state state_ref="oval:mscp:ste:369"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:370" version="1" comment="pwpolicy_minimum_lifetime_enforce_stig_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:370"/>
          <state state_ref="oval:mscp:ste:370"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:371" version="1" comment="icloud_photos_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:371"/>
          <state state_ref="oval:mscp:ste:371"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:372" version="1" comment="icloud_appleid_system_settings_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:372"/>
          <state state_ref="oval:mscp:ste:372"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:373" version="1" comment="icloud_reminders_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:373"/>
          <state state_ref="oval:mscp:ste:373"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:374" version="1" comment="icloud_freeform_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:374"/>
          <state state_ref="oval:mscp:ste:374"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:375" version="1" comment="icloud_sync_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:375"/>
          <state state_ref="oval:mscp:ste:375"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:376" version="1" comment="icloud_game_center_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:376"/>
          <state state_ref="oval:mscp:ste:376"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:377" version="1" comment="icloud_keychain_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:377"/>
          <state state_ref="oval:mscp:ste:377"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:378" version="1" comment="icloud_notes_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:378"/>
          <state state_ref="oval:mscp:ste:378"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:379" version="1" comment="icloud_private_relay_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:379"/>
          <state state_ref="oval:mscp:ste:379"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:380" version="1" comment="icloud_drive_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:380"/>
          <state state_ref="oval:mscp:ste:380"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:381" version="1" comment="icloud_bookmarks_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:381"/>
          <state state_ref="oval:mscp:ste:381"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:382" version="1" comment="icloud_mail_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:382"/>
          <state state_ref="oval:mscp:ste:382"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:383" version="1" comment="icloud_calendar_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:383"/>
          <state state_ref="oval:mscp:ste:383"/>
        </shellcommand_test>
        <shellcommand_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:tst:384" version="1" comment="icloud_addressbook_disable_recommended_test" check_existence="all_exist" check="all">
          <object object_ref="oval:mscp:obj:384"/>
          <state state_ref="oval:mscp:ste:384"/>
        </shellcommand_test>
      </tests>
      <objects>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:1" version="1" comment="system_settings_internet_accounts_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep com.apple.Internet-Accounts-Settings.extension</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:2" version="1" comment="system_settings_time_machine_encrypted_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/defaults read /Library/Preferences/com.apple.TimeMachine.plist | grep -c NotEncrypted</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:3" version="1" comment="system_settings_install_macos_updates_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticallyInstallMacOSUpdates').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:4" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:5" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:6" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:7" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let delay = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPasswordDelay'))
  if ( delay &lt;= 5 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:8" version="1" comment="system_settings_wallet_applepay_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep "com.apple.WalletSettingsExtension"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:9" version="1" comment="system_settings_location_services_menu_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/defaults read /Library/Preferences/com.apple.locationmenu.plist ShowSystemServices</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:10" version="1" comment="system_settings_guest_access_smb_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/defaults read /Library/Preferences/SystemConfiguration/com.apple.smb.server AllowGuestAccess</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:11" version="1" comment="system_settings_printer_sharing_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/cupsctl | /usr/bin/grep "_share_printers=0"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:12" version="1" comment="system_settings_bluetooth_menu_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.controlcenter')\
.objectForKey('Bluetooth').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:13" version="1" comment="system_settings_system_wide_preferences_configure_recommended_object">
          <shell>zsh</shell>
          <command>authDBs=("system.preferences" "system.preferences.energysaver" "system.preferences.network" "system.preferences.printing" "system.preferences.sharing" "system.preferences.softwareupdate" "system.preferences.startupdisk" "system.preferences.timemachine")
result="1"
for section in ${authDBs[@]}; do
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "shared")]/following-sibling::*[1])' -) != "false" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath '//*[contains(text(), "group")]/following-sibling::*[1]/text()' - ) != "admin" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "authenticate-user")]/following-sibling::*[1])' -) != "true" ]]; then
    result="0"
  fi
  if [[ $(/usr/bin/security -q authorizationdb read "$section" | /usr/bin/xmllint -xpath 'name(//*[contains(text(), "session-owner")]/following-sibling::*[1])' -) != "false" ]]; then
    result="0"
  fi
done
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:14" version="1" comment="system_settings_location_services_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo -u _locationd /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.locationd')\
.objectForKey('LocationServicesEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:15" version="1" comment="system_settings_improve_search_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\
.objectForKey('Search Queries Data Sharing Status').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:16" version="1" comment="system_settings_guest_account_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('DisableGuestAccount'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('EnableGuestAccount'))
  if ( pref1 == true &amp;&amp; pref2 == false ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:17" version="1" comment="system_settings_software_update_download_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticDownload').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:18" version="1" comment="system_settings_personalized_advertising_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowApplePersonalizedAdvertising').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:19" version="1" comment="system_settings_bluetooth_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCXBluetooth')\
.objectForKey('DisableBluetooth').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:20" version="1" comment="system_settings_remote_management_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep "RemoteDesktopEnabled = 0"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:21" version="1" comment="system_settings_loginwindow_prompt_username_password_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('SHOWFULLNAME').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:22" version="1" comment="system_settings_apple_watch_unlock_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAutoUnlock').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:23" version="1" comment="system_settings_smbd_disable_recommended_object">
          <shell>zsh</shell>
          <command>/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.smbd" =&gt; disabled'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:24" version="1" comment="system_settings_hot_corners_secure_recommended_object">
          <shell>zsh</shell>
          <command>CURRENT_USER=$(/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow.plist lastUserName)
bl_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-bl-corner 2&gt;/dev/null)"
tl_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tl-corner 2&gt;/dev/null)"
tr_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-tr-corner 2&gt;/dev/null)"
br_corner="$(/usr/bin/defaults read /Users/"$CURRENT_USER"/Library/Preferences/com.apple.dock wvous-br-corner 2&gt;/dev/null)"

if [[ "$bl_corner" != "6" ]] &amp;&amp; [[ "$tl_corner" != "6" ]] &amp;&amp; [[ "$tr_corner" != "6" ]] &amp;&amp; [[ "$br_corner" != "6" ]]; then
  echo "0"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:25" version="1" comment="system_settings_screensaver_timeout_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:26" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:27" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:28" version="1" comment="system_settings_screensaver_timeout_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('idleTime'))
  if ( timeout &lt;= 900 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:29" version="1" comment="system_settings_automatic_logout_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('.GlobalPreferences')\
.objectForKey('com.apple.autologout.AutoLogOutDelay').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:30" version="1" comment="system_settings_automatic_logout_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('.GlobalPreferences')\
.objectForKey('com.apple.autologout.AutoLogOutDelay').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:31" version="1" comment="system_settings_password_hints_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('RetriesUntilHint').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:32" version="1" comment="system_settings_screen_sharing_disable_recommended_object">
          <shell>zsh</shell>
          <command>result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.screensharing" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.screensharing 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:33" version="1" comment="system_settings_time_machine_auto_backup_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.TimeMachine')\
.objectForKey('AutoBackup').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:34" version="1" comment="system_settings_touchid_unlock_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFingerprintForUnlock').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:36" version="1" comment="system_settings_softwareupdate_current_recommended_object">
          <shell>zsh</shell>
          <command>softwareupdate_date_epoch=$(/bin/date -j -f "%Y-%m-%d" "$(/usr/bin/defaults read /Library/Preferences/com.apple.SoftwareUpdate.plist LastFullSuccessfulDate | /usr/bin/awk '{print $1}')" "+%s")
thirty_days_epoch=$(/bin/date -v -30d "+%s")
if [[ $softwareupdate_date_epoch -lt $thirty_days_epoch ]]; then
  /bin/echo "0"
else
  /bin/echo "1"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:37" version="1" comment="system_settings_external_intelligence_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowExternalIntelligenceIntegrations').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:38" version="1" comment="system_settings_siri_listen_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Siri')\
.objectForKey('VoiceTriggerUserEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:39" version="1" comment="system_settings_internet_sharing_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('forceInternetSharingOff').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:40" version="1" comment="system_settings_filevault_enforce_recommended_object">
          <shell>zsh</shell>
          <command>dontAllowDisable=$(/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('dontAllowFDEDisable').js
EOS
)
fileVault=$(/usr/bin/fdesetup status | /usr/bin/grep -c "FileVault is On.")
if [[ "$dontAllowDisable" == "true" ]] &amp;&amp; [[ "$fileVault" == 1 ]]; then
  echo "1"
else
  echo "0"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:41" version="1" comment="system_settings_gatekeeper_override_disallow_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.managed')\
.objectForKey('DisableOverride').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:42" version="1" comment="system_settings_ssh_disable_recommended_object">
          <shell>zsh</shell>
          <command>result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.openssh.sshd" =&gt; enabled')
running=$(/bin/launchctl print system/com.openssh.sshd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:43" version="1" comment="system_settings_siri_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAssistant').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:44" version="1" comment="system_settings_content_caching_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowContentCaching').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:45" version="1" comment="system_settings_ssh_enable_recommended_object">
          <shell>zsh</shell>
          <command>/bin/launchctl print-disabled system | /usr/bin/grep '"com.openssh.sshd" =&gt; enabled'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:46" version="1" comment="system_settings_gatekeeper_identified_developers_allowed_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('AllowIdentifiedDevelopers'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('EnableAssessment'))
  if ( pref1 == true &amp;&amp; pref2 == true ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:47" version="1" comment="system_settings_screensaver_password_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('askForPassword').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:48" version="1" comment="system_settings_firewall_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
.objectForKey('EnableFirewall').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:49" version="1" comment="system_settings_find_my_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFindMyDevice'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowFindMyFriends'))
  let pref3 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.icloud.managed')\
.objectForKey('DisableFMMiCloudSetting'))
  if ( pref1 == false &amp;&amp; pref2 == false &amp;&amp; pref3 == true ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:50" version="1" comment="system_settings_hot_corners_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '"wvous-bl-corner" = 0|"wvous-br-corner" = 0|"wvous-tl-corner" = 0|"wvous-tr-corner" = 0'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:51" version="1" comment="system_settings_diagnostics_reports_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
let pref1 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.SubmitDiagInfo')\
.objectForKey('AutoSubmit').js
let pref2 = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowDiagnosticSubmission').js
if ( pref1 == false &amp;&amp; pref2 == false ){
    return("true")
} else {
    return("false")
}
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:52" version="1" comment="system_settings_critical_update_install_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('CriticalUpdateInstall').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:53" version="1" comment="system_settings_wake_network_access_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pmset -g custom | /usr/bin/awk '/womp/ { sum+=$2 } END {print sum}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:54" version="1" comment="system_settings_bluetooth_sharing_disable_recommended_object">
          <shell>zsh</shell>
          <command>CURRENT_USER=$(/usr/bin/defaults read /Library/Preferences/com.apple.loginwindow.plist lastUserName)
/usr/bin/sudo -u "$CURRENT_USER" /usr/bin/defaults -currentHost read com.apple.Bluetooth PrefKeyServicesEnabled</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:55" version="1" comment="system_settings_automatic_login_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('com.apple.login.mcx.DisableAutoLoginClient').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:56" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:57" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:58" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS | /usr/bin/base64
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('LoginwindowText').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:59" version="1" comment="system_settings_improve_siri_dictation_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.assistant.support')\
.objectForKey('Siri Data Sharing Opt-In Status').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:60" version="1" comment="system_settings_download_software_update_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/plutil -convert json /var/db/softwareupdate/SoftwareUpdateDDMStatePersistence.plist -o - | /usr/bin/jq --raw-output .'SUCorePersistedStatePolicyFields.SUCoreDDMDeclarationGlobalSettings.automaticallyDownload'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:61" version="1" comment="system_settings_touch_id_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep "com.apple.Touch-ID-Settings.extension"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:62" version="1" comment="system_settings_external_intelligence_sign_in_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowExternalIntelligenceIntegrationsSignIn').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:63" version="1" comment="system_settings_bluetooth_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep com.apple.BluetoothSettings</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:64" version="1" comment="system_settings_location_services_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo -u _locationd /usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.locationd')\
.objectForKey('LocationServicesEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:65" version="1" comment="system_settings_usb_restricted_mode_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
  function run() {
    let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
  .objectForKey('allowUSBRestrictedMode'))
    if ( pref1 == false ) {
      return("false")
    } else {
      return("true")
    }
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:66" version="1" comment="system_settings_time_server_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:67" version="1" comment="system_settings_time_server_configure_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:68" version="1" comment="system_settings_time_server_configure_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:69" version="1" comment="system_settings_time_server_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('timeServer').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:70" version="1" comment="system_settings_time_server_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.timed')\
.objectForKey('TMAutomaticTimeOnlyEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:71" version="1" comment="system_settings_siri_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep com.apple.Siri-Settings.extension</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:72" version="1" comment="system_settings_improve_assistive_voice_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Accessibility')\
.objectForKey('AXSAudioDonationSiriImprovementEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:73" version="1" comment="system_settings_airplay_receiver_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAirPlayIncomingRequests').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:74" version="1" comment="system_settings_security_update_install_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/plutil -convert json /var/db/softwareupdate/SoftwareUpdateDDMStatePersistence.plist -o - | /usr/bin/jq --raw-output .'SUCorePersistedStatePolicyFields.SUCoreDDMDeclarationGlobalSettings.automaticallyInstallSystemAndSecurityUpdates'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:75" version="1" comment="system_settings_token_removal_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('tokenRemovalAction').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:76" version="1" comment="system_settings_media_sharing_disabled_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMediaSharing'))
  let pref2 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMediaSharingModification'))
  if ( pref1 == false &amp;&amp; pref2 == false ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:77" version="1" comment="system_settings_wifi_menu_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.controlcenter')\
.objectForKey('WiFi').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:78" version="1" comment="system_settings_firewall_stealth_mode_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.firewall')\
.objectForKey('EnableStealthMode').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:79" version="1" comment="system_settings_rae_disable_recommended_object">
          <shell>zsh</shell>
          <command>/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.AEServer" =&gt; disabled'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:81" version="1" comment="auth_pam_login_smartcard_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)' /etc/pam.d/login</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:82" version="1" comment="auth_smartcard_allow_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('allowSmartCard').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:83" version="1" comment="auth_pam_sudo_smartcard_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_deny.so)' /etc/pam.d/sudo</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:84" version="1" comment="auth_smartcard_certificate_trust_enforce_high_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('checkCertificateTrust').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:85" version="1" comment="auth_smartcard_certificate_trust_enforce_moderate_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('checkCertificateTrust').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:86" version="1" comment="auth_smartcard_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.smartcard')\
.objectForKey('enforceSmartCard').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:87" version="1" comment="auth_pam_su_smartcard_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/grep -Ec '^(auth\s+sufficient\s+pam_smartcard.so|auth\s+required\s+pam_rootok.so)' /etc/pam.d/su</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:88" version="1" comment="auth_ssh_password_authentication_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/grep -Ec '^(passwordauthentication\s+no|kbdinteractiveauthentication\s+no)'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:89" version="1" comment="audit_flags_fd_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fd'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:91" version="1" comment="audit_folder_group_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $4}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:92" version="1" comment="audit_failure_halt_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^policy/ {print $NF}' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'ahlt'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:93" version="1" comment="audit_flags_fm_failed_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fm'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:96" version="1" comment="audit_control_mode_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -l /etc/security/audit_control|/usr/bin/awk '!/-r--[r-]-----|current|total/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:97" version="1" comment="audit_acls_folders_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -lde /var/audit | /usr/bin/awk '{print $1}' | /usr/bin/grep ":"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:98" version="1" comment="audit_flags_fm_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '^fm'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:99" version="1" comment="audit_auditd_enabled_recommended_object">
          <shell>zsh</shell>
          <command>LAUNCHD_RUNNING=$(/bin/launchctl print system | /usr/bin/grep -c -E '\tcom.apple.auditd')
AUDITD_RUNNING=$(/usr/sbin/audit -c | /usr/bin/grep -c "AUC_AUDITING")
if [[ $LAUNCHD_RUNNING == 1 ]] &amp;&amp; [[ -e /etc/security/audit_control ]] &amp;&amp; [[ $AUDITD_RUNNING == 1 ]]; then
  echo "pass"
else
  echo "fail"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:100" version="1" comment="audit_flags_ad_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'ad'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:101" version="1" comment="audit_flags_ex_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-ex'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:102" version="1" comment="audit_files_mode_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -l $(/usr/bin/grep '^dir' /etc/security/audit_control|/usr/bin/awk -F: '{print $2}')|/usr/bin/awk '!/-r--r-----|current|total/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:103" version="1" comment="audit_flags_aa_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec 'aa'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:104" version="1" comment="audit_control_owner_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $3}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:105" version="1" comment="audit_files_owner_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$3} END {print s}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:106" version="1" comment="audit_retention_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:107" version="1" comment="audit_retention_configure_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:108" version="1" comment="audit_retention_configure_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:109" version="1" comment="audit_retention_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/expire-after/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:110" version="1" comment="audit_flags_fr_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fr'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:111" version="1" comment="audit_settings_failure_notify_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/grep "logger -s -p" /etc/security/audit_warn</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:112" version="1" comment="audit_folder_owner_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -dn $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $3}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:114" version="1" comment="audit_control_acls_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -le /etc/security/audit_control | /usr/bin/awk '{print $1}' | /usr/bin/grep ":"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:115" version="1" comment="audit_flags_lo_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '^lo'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:117" version="1" comment="audit_flags_fw_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F':' '/^flags/ { print $NF }' /etc/security/audit_control | /usr/bin/tr ',' '\n' | /usr/bin/grep -Ec '\-fw'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:118" version="1" comment="audit_folders_mode_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/stat -f %A $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}')</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:119" version="1" comment="audit_configure_capacity_notify_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:120" version="1" comment="audit_configure_capacity_notify_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/awk -F: '/^minfree/{print $2}' /etc/security/audit_control</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:121" version="1" comment="audit_files_group_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -n $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{s+=$4} END {print s}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:122" version="1" comment="audit_control_group_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -dn /etc/security/audit_control | /usr/bin/awk '{print $4}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:123" version="1" comment="audit_acls_files_configure_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -le $(/usr/bin/grep '^dir' /etc/security/audit_control | /usr/bin/awk -F: '{print $2}') | /usr/bin/awk '{print $1}' | /usr/bin/grep ":"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:126" version="1" comment="os_sshd_unused_connection_timeout_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectiontimeout/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:127" version="1" comment="os_sshd_unused_connection_timeout_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/unusedconnectiontimeout/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:129" version="1" comment="os_sshd_login_grace_time_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:130" version="1" comment="os_sshd_login_grace_time_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/logingracetime/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:132" version="1" comment="os_newsyslog_files_owner_group_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf|/usr/bin/awk '{ print $1 }')|/usr/bin/awk '!/^root:wheel:/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:133" version="1" comment="os_firewall_default_deny_require_recommended_object">
          <shell>zsh</shell>
          <command>/sbin/pfctl -a '*' -sr &amp;&gt; /dev/null | /usr/bin/grep "block drop in all"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:136" version="1" comment="os_dvdram_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["dvdram"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:138" version="1" comment="os_sshd_fips_compliant_recommended_object">
          <shell>zsh</shell>
          <command>fips_sshd_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
total=0
for config in $fips_sshd_config; do
  total=$(expr $(/usr/sbin/sshd -G | /usr/bin/grep -i -c "$config") + $total)
done

echo $total</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:139" version="1" comment="os_firmware_password_require_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/firmwarepasswd -check | /usr/bin/grep "Password Enabled: Yes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:140" version="1" comment="os_photos_enhanced_search_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.photos.shareddefaults')\
.objectForKey('IPXDefaultEnhancedVisualSearchEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:141" version="1" comment="os_power_nap_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pmset -g custom | /usr/bin/awk '/powernap/ { sum+=$2 } END {print sum}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:142" version="1" comment="os_safari_warn_fraudulent_website_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep 'WarnAboutFraudulentWebsites = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:143" version="1" comment="os_power_nap_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pmset -g custom | /usr/bin/awk '/powernap/ { sum+=$2 } END {print sum}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:144" version="1" comment="os_root_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/dscl . -read /Users/root UserShell 2&gt;&amp;1 | /usr/bin/grep "/usr/bin/false"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:146" version="1" comment="os_policy_banner_ssh_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/grep -c "^banner /etc/banner"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:148" version="1" comment="os_safari_clear_history_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariHistoryClearing').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:150" version="1" comment="os_password_proximity_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordProximityRequests').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:151" version="1" comment="os_library_validation_enabled_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.security.libraryvalidation')\
.objectForKey('DisableLibraryValidation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:152" version="1" comment="os_notes_transcription_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowNotesTranscription').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:153" version="1" comment="os_mdm_require_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles status -type enrollment | /usr/bin/awk -F: '/MDM enrollment/ {print $2}' | /usr/bin/grep "Yes (User Approved)"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:154" version="1" comment="os_skip_apple_intelligence_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Intelligence")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:159" version="1" comment="os_anti_virus_installed_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/xprotect status | /usr/bin/grep -cE "(launch scans: enabled|background scans: enabled)"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:161" version="1" comment="os_screensaver_loginwindow_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('moduleName').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:162" version="1" comment="os_mail_smart_reply_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMailSmartReplies').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:163" version="1" comment="os_world_writable_system_folder_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/find /System/Volumes/Data/System -type d -perm -2 -ls|/usr/bin/grep -vE "downloadDir|locks"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:164" version="1" comment="os_handoff_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowActivityContinuation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:166" version="1" comment="os_iphone_mirroring_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowiPhoneMirroring').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:170" version="1" comment="os_safari_open_safe_downloads_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep 'AutoOpenSafeDownloads = 0' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:171" version="1" comment="os_ssh_server_alive_interval_configure_recommended_object">
          <shell>zsh</shell>
          <command>ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveraliveinterval 900")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:172" version="1" comment="os_ssh_server_alive_interval_configure_stig_object">
          <shell>zsh</shell>
          <command>ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveraliveinterval 900")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:173" version="1" comment="os_mail_summary_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowMailSummary').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:174" version="1" comment="os_ssh_fips_compliant_recommended_object">
          <shell>zsh</shell>
          <command>fips_ssh_config=("Ciphers aes128-gcm@openssh.com" "HostbasedAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com" "HostKeyAlgorithms ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com,ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com" "KexAlgorithms ecdh-sha2-nistp256" "MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-256" "PubkeyAcceptedAlgorithms ecdsa-sha2-nistp256,ecdsa-sha2-nistp256-cert-v01@openssh.com,sk-ecdsa-sha2-nistp256-cert-v01@openssh.com" "CASignatureAlgorithms ecdsa-sha2-nistp256,sk-ecdsa-sha2-nistp256@openssh.com")
total=0
ret="pass"
for config in $fips_ssh_config; do
  if [[ "$ret" == "fail" ]]; then
    break
  fi
  for u in $(/usr/bin/dscl . list /users shell | /usr/bin/egrep -v '(^_)|(root)|(/usr/bin/false)' | /usr/bin/awk '{print $1}'); do
    sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -ci "$config")
    if [[ "$sshCheck" == "0" ]]; then
      ret="fail"
      break
    fi
  done
done
echo $ret</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:178" version="1" comment="os_rapid_security_response_allow_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowRapidSecurityResponseInstallation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:181" version="1" comment="os_network_storage_restriction_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/plutil -convert json /var/db/ManagedConfigurationFiles/DiskManagement/DiskManagement_Settings.plist -o - | /usr/bin/jq --raw-output '.Restrictions.NetworkStorage'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:182" version="1" comment="os_time_offset_limit_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sntp $(/usr/sbin/systemsetup -getnetworktimeserver | /usr/bin/awk '{print $4}') | /usr/bin/awk -F'.' '/\+\/\-/{if (substr($1,2) &gt;= 270) {print "No"} else {print "Yes"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:183" version="1" comment="os_tftpd_disable_recommended_object">
          <shell>zsh</shell>
          <command>result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.tftpd" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.tftpd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:184" version="1" comment="os_password_autofill_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordAutoFill').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:185" version="1" comment="os_sshd_client_alive_interval_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:186" version="1" comment="os_sshd_client_alive_interval_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/clientaliveinterval/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:188" version="1" comment="os_asl_log_files_permissions_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/*|/usr/bin/awk '{ print $2 }')|/usr/bin/awk '!/640/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:191" version="1" comment="os_safari_private_browsing_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariPrivateBrowsing').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:192" version="1" comment="os_password_sharing_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowPasswordSharing').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:193" version="1" comment="os_blank_bluray_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankbd"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:195" version="1" comment="os_notes_transcription_summary_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowNotesTranscriptionSummary').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:197" version="1" comment="os_authenticated_root_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep "AuthenticatedRootVolumeEnabled = 1;"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:198" version="1" comment="os_screensaver_timeout_loginwindow_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.screensaver')\
.objectForKey('loginWindowIdleTime'))
  if ( timeout &lt;= 1200 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:200" version="1" comment="os_safari_advertising_privacy_protection_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep '"WebKitPreferences.privateClickMeasurementEnabled" = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:202" version="1" comment="os_config_data_install_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('ConfigDataInstall').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:203" version="1" comment="os_setup_assistant_filevault_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX.FileVault2')\
.objectForKey('ForceEnableInSetupAssistant')
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:207" version="1" comment="os_sleep_and_display_sleep_apple_silicon_enable_recommended_object">
          <shell>zsh</shell>
          <command>error_count=0
if /usr/sbin/ioreg -rd1 -c IOPlatformExpertDevice 2&gt;&amp;1 | /usr/bin/grep -q "MacBook"; then
  sleepMode=$(/usr/bin/pmset -b -g | /usr/bin/grep '^\s*sleep' 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  displaysleepMode=$(/usr/bin/pmset -b -g | /usr/bin/grep displaysleep 2&gt;&amp;1 | /usr/bin/awk '{print $2}')

  if [[ "$sleepMode" == "" ]] || [[ "$sleepMode" -gt 15 ]]; then
    ((error_count++))
  fi
  if [[ "$displaysleepMode" == "" ]] || [[ "$displaysleepMode" -gt 10 ]] || [[ "$displaysleepMode" -gt "$sleepMode" ]]; then
    ((error_count++))
  fi
fi
echo "$error_count"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:208" version="1" comment="os_guest_folder_removed_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls /Users/ | /usr/bin/grep "Guest"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:210" version="1" comment="os_password_hint_remove_recommended_object">
          <shell>zsh</shell>
          <command>HINT=$(/usr/bin/dscl . -list /Users hint | /usr/bin/awk '{ print $2 }')

if [ -z "$HINT" ]; then
  echo "PASS"
else
  echo "FAIL"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:211" version="1" comment="os_disk_image_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["disk-image"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:212" version="1" comment="os_sshd_client_alive_count_max_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:213" version="1" comment="os_sshd_client_alive_count_max_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/clientalivecountmax/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:215" version="1" comment="os_privacy_setup_prompt_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Privacy")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:217" version="1" comment="os_software_update_app_update_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SoftwareUpdate')\
.objectForKey('AutomaticallyInstallAppUpdates').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:219" version="1" comment="os_image_playground_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowImagePlayground').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:220" version="1" comment="os_secure_boot_verify_recommended_object">
          <shell>zsh</shell>
          <command>/usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep "SecureBootLevel = full"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:221" version="1" comment="os_sudo_log_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep "Log when a command is allowed by sudoers"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:223" version="1" comment="os_uucp_disable_recommended_object">
          <shell>zsh</shell>
          <command>result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"com.apple.uucp" =&gt; enabled')
running=$(/bin/launchctl print system/com.apple.uucp 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:224" version="1" comment="os_burn_support_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep -Ec '(BurnSupport = off;|ProhibitBurn = 1;)'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:225" version="1" comment="os_policy_banner_loginwindow_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/bin/ls -ld /Library/Security/PolicyBanner.rtf*</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:226" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/bin/ls -ld /Library/Security/PolicyBanner.rtf*</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:227" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/bin/ls -ld /Library/Security/PolicyBanner.rtf*</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:228" version="1" comment="os_policy_banner_loginwindow_enforce_stig_object">
          <shell>zsh</shell>
          <command>/bin/ls -ld /Library/Security/PolicyBanner.rtf*</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:229" version="1" comment="os_writing_tools_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowWritingTools').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:230" version="1" comment="os_user_app_installation_prohibit_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Users/" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:234" version="1" comment="os_rapid_security_response_removal_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowRapidSecurityResponseRemoval').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:235" version="1" comment="os_touchid_prompt_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Biometric")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:236" version="1" comment="os_filevault_autologin_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.objectForKey('DisableFDEAutoLogin').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:237" version="1" comment="os_skip_screen_time_prompt_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("ScreenTime")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:239" version="1" comment="os_blank_cd_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankcd"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:241" version="1" comment="os_messages_app_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Messages.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:242" version="1" comment="os_config_profile_ui_install_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowUIConfigurationProfileInstallation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:244" version="1" comment="os_sshd_per_source_penalties_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/grep -q "persourcepenalties no" &amp;&amp; echo "no" || echo "yes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:246" version="1" comment="os_genmoji_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowGenmoji').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:247" version="1" comment="os_airdrop_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAirDrop').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:248" version="1" comment="os_sudoers_timestamp_type_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/awk -F": " '/Type of authentication timestamp record/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:251" version="1" comment="os_parental_controls_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
.objectForKey('familyControlsEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:254" version="1" comment="os_system_read_only_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/system_profiler SPStorageDataType | /usr/bin/awk '/Mount Point: \/$/{x=NR+2}(NR==x){print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:255" version="1" comment="os_ssh_server_alive_count_max_configure_recommended_object">
          <shell>zsh</shell>
          <command>ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveralivecountmax 0")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:256" version="1" comment="os_ssh_server_alive_count_max_configure_stig_object">
          <shell>zsh</shell>
          <command>ret="pass"
for u in $(/usr/bin/dscl . -list /Users UniqueID | /usr/bin/awk '$2 &gt; 500 {print $1}'); do
  sshCheck=$(/usr/bin/sudo -u $u /usr/bin/ssh -G . | /usr/bin/grep -c "^serveralivecountmax 0")
  if [[ "$sshCheck" == "0" ]]; then
    ret="fail"
    break
  fi
done
/bin/echo $ret</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:257" version="1" comment="os_hibernate_mode_destroyfvkeyonstandby_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.MCX')\
.objectForKey('DestroyFVKeyOnStandby').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:258" version="1" comment="os_nfsd_disable_recommended_object">
          <shell>zsh</shell>
          <command>isDisabled=$(/sbin/nfsd status | /usr/bin/awk '/nfsd service/ {print $NF}')    
if [[ "$isDisabled" == "disabled" ]] &amp;&amp; [[ -z $(/usr/bin/pgrep nfsd) ]]; then
  echo "pass"
else
  echo "fail"
fi</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:260" version="1" comment="os_sshd_permit_root_login_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/permitrootlogin/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:261" version="1" comment="os_account_modification_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowAccountModification').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:262" version="1" comment="os_httpd_disable_recommended_object">
          <shell>zsh</shell>
          <command>result="FAIL"
enabled=$(/bin/launchctl print-disabled system | /usr/bin/grep '"org.apache.httpd" =&gt; enabled')
running=$(/bin/launchctl print system/org.apache.httpd 2&gt;/dev/null)

if [[ -z "$running" ]] &amp;&amp; [[ -z "$enabled" ]]; then
  result="PASS"
elif [[ -n "$running" ]]; then
  result=result+" RUNNING"
elif [[ -n "$enabled" ]]; then
  result=result+" ENABLED"
fi
echo $result</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:264" version="1" comment="os_asl_log_files_owner_group_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/stat -f '%Su:%Sg:%N' $(/usr/bin/grep -e '^&gt;' /etc/asl.conf /etc/asl/*|/usr/bin/awk '{ print $2 }')|/usr/bin/awk '!/^root:wheel:/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:265" version="1" comment="os_hibernate_mode_intel_enable_recommended_object">
          <shell>zsh</shell>
          <command>error_count=0
if /usr/sbin/ioreg -rd1 -c IOPlatformExpertDevice 2&gt;&amp;1 | /usr/bin/grep -q "MacBook"; then
  hibernateMode=$(/usr/bin/pmset -b -g | /usr/bin/grep hibernatemode 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyLowValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelaylow 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyHighValue=$(/usr/bin/pmset -g | /usr/bin/grep standbydelayhigh 2&gt;&amp;1 | /usr/bin/awk '{print $2}')
  hibernateStandbyThreshValue=$(/usr/bin/pmset -g | /usr/bin/grep highstandbythreshold 2&gt;&amp;1 | /usr/bin/awk '{print $2}')

  if [[ "$hibernateStandbyLowValue" == "" ]] || [[ "$hibernateStandbyLowValue" -gt 900 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateStandbyHighValue" == "" ]] || [[ "$hibernateStandbyHighValue" -gt 900 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateStandbyThreshValue" == "" ]] || [[ "$hibernateStandbyThreshValue" -lt 90 ]]; then
    ((error_count++))
  fi
  if [[ "$hibernateMode" == "" ]] || [[ "$hibernateMode" != 25 ]]; then
    ((error_count++))
  fi
fi
echo "$error_count"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:268" version="1" comment="os_recovery_lock_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/libexec/mdmclient QuerySecurityInfo 2&gt;/dev/null | /usr/bin/grep "IsRecoveryLockEnabled = 1"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:269" version="1" comment="os_blank_dvd_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["blankdvd"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:270" version="1" comment="os_loginwindow_adminhostinfo_disabled_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.loginwindow')\
.integerForKey('AdminHostInfo')
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:271" version="1" comment="os_safari_show_full_website_address_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep 'ShowFullURLInSmartSearchField = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:273" version="1" comment="os_mobile_file_integrity_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/nvram -p | /usr/bin/grep "amfi_get_out_of_my_way=1"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:274" version="1" comment="os_gatekeeper_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.systempolicy.control')\
.objectForKey('EnableAssessment').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:275" version="1" comment="os_sip_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/csrutil status | /usr/bin/grep 'System Integrity Protection status: enabled.'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:276" version="1" comment="os_removable_media_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["harddisk-external"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:277" version="1" comment="os_world_writable_library_folder_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/find /Library -type d -perm -002 ! -perm -1000 ! -xattrname com.apple.rootless 2&gt;/dev/null</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:278" version="1" comment="os_dictation_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowDictation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:279" version="1" comment="os_policy_banner_ssh_configure_recommended_object">
          <shell>zsh</shell>
          <command>bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions:
-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.
-At any time, the USG may inspect and seize data stored on this IS.
-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG authorized purpose.
-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.
-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
test "$(cat /etc/banner)" = "$bannerText" &amp;&amp; echo "1" || echo "0"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:280" version="1" comment="os_policy_banner_ssh_configure_stig_object">
          <shell>zsh</shell>
          <command>bannerText="You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests--not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details."
test "$(cat /etc/banner)" = "$bannerText" &amp;&amp; echo "1" || echo "0"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:281" version="1" comment="os_terminal_secure_keyboard_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.Terminal')\
.objectForKey('SecureKeyboardEntry').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:283" version="1" comment="os_time_server_enabled_recommended_object">
          <shell>zsh</shell>
          <command>/bin/launchctl print system | /usr/bin/grep -E '\tcom.apple.timed'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:284" version="1" comment="os_unlock_active_user_session_disable_recommended_object">
          <shell>zsh</shell>
          <command>RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:285" version="1" comment="os_unlock_active_user_session_disable_cis_lvl1_object">
          <shell>zsh</shell>
          <command>RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:286" version="1" comment="os_unlock_active_user_session_disable_cis_lvl2_object">
          <shell>zsh</shell>
          <command>RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:287" version="1" comment="os_unlock_active_user_session_disable_stig_object">
          <shell>zsh</shell>
          <command>RESULT="FAIL"
SS_RULE=$(/usr/bin/security -q authorizationdb read system.login.screensaver  2&gt;&amp;1 | /usr/bin/xmllint --xpath "//dict/key[.='rule']/following-sibling::array[1]/string/text()" -)

if [[ "${SS_RULE}" == "authenticate-session-owner" ]]; then
    RESULT="PASS"
else
    PSSO_CHECK=$(/usr/bin/security -q authorizationdb read "$SS_RULE"  2&gt;&amp;1 | /usr/bin/xmllint --xpath '//key[.="rule"]/following-sibling::array[1]/string/text()' -)
    if /usr/bin/grep -Fxq "authenticate-session-owner" &lt;&lt;&lt;"$PSSO_CHECK"; then
        RESULT="PASS"
    fi
fi

echo $RESULT</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:289" version="1" comment="os_sudo_timeout_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep "Authentication timestamp timeout: 0.0 minutes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:290" version="1" comment="os_sudo_timeout_configure_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep "Authentication timestamp timeout: 0.0 minutes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:291" version="1" comment="os_sudo_timeout_configure_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep "Authentication timestamp timeout: 0.0 minutes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:292" version="1" comment="os_sudo_timeout_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/sudo /usr/bin/sudo -V | /usr/bin/grep "Authentication timestamp timeout: 0.0 minutes"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:293" version="1" comment="os_siri_prompt_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("Siri")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:294" version="1" comment="os_appleid_prompt_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("AppleID")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:297" version="1" comment="os_directory_services_configured_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/dscl localhost -list . | /usr/bin/grep -qvE '(Contact|Search|Local|^$)'; /bin/echo $?</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:298" version="1" comment="os_safari_show_status_bar_enabled_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep 'ShowOverlayStatusBar = 1' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:300" version="1" comment="os_skip_unlock_with_watch_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("WatchMigration")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:301" version="1" comment="os_safari_reader_summary_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowSafariSummary').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:303" version="1" comment="os_system_wide_applications_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/find /Applications -iname "*\.app" -type d -perm -2 -ls</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:305" version="1" comment="os_software_update_deferral_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:306" version="1" comment="os_software_update_deferral_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:307" version="1" comment="os_software_update_deferral_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let timeout = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('enforcedSoftwareUpdateDelay')) || 0
  if ( timeout &lt;= 30 ) {
    return("true")
  } else {
    return("false")
  }
}
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:308" version="1" comment="os_newsyslog_files_permissions_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/stat -f '%A:%N' $(/usr/bin/grep -v '^#' /etc/newsyslog.conf|/usr/bin/awk '{ print $1 }')|/usr/bin/awk '!/640/{print $1}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:309" version="1" comment="os_home_folders_secure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/find /System/Volumes/Data/Users -mindepth 1 -maxdepth 1 -type d ! \( -perm 700 -o -perm 711 \)|/usr/bin/grep -v "Shared"|/usr/bin/grep -v "Guest"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:310" version="1" comment="os_bluray_read_only_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["bd"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:311" version="1" comment="os_facetime_app_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/FaceTime.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:312" version="1" comment="os_camera_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCamera').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:313" version="1" comment="os_on_device_dictation_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('forceOnDeviceOnlyDictation').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:314" version="1" comment="os_external_storage_access_defined_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/plutil -convert json /var/db/ManagedConfigurationFiles/DiskManagement/DiskManagement_Settings.plist -o - | /usr/bin/jq --raw-output '.Restrictions.ExternalStorage'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:315" version="1" comment="os_install_log_retention_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:316" version="1" comment="os_install_log_retention_configure_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:317" version="1" comment="os_install_log_retention_configure_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:318" version="1" comment="os_install_log_retention_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/aslmanager -dd 2&gt;&amp;1 | /usr/bin/awk '/\/var\/log\/install.log$/ {count++} /Processing module com.apple.install/,/Finished/ { for (i=1;i&lt;=NR;i++) { if ($i == "TTL" &amp;&amp; $(i+2) &gt;= 365) { ttl="True" }; if ($i == "MAX") {max="True"}}} END{if (count &gt; 1) { print "Multiple config files for /var/log/install, manually remove the extra files"} else if (max == "True") { print "all_max setting is configured, must be removed" } if (ttl != "True") { print "TTL not configured" } else { print "Yes" }}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:319" version="1" comment="os_icloud_storage_prompt_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript 2&gt;/dev/null &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.SetupAssistant.managed')\
.objectForKey('SkipSetupItems').containsObject("iCloudStorage")
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:320" version="1" comment="os_erase_content_and_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowEraseContentAndSettings').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:321" version="1" comment="os_ir_support_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.driver.AppleIRController')\
.objectForKey('DeviceEnabled').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:322" version="1" comment="os_cd_read_only_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.systemuiserver')\
.objectForKey('mount-controls'))["cd"]
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:323" version="1" comment="os_sshd_channel_timeout_configure_recommended_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/channeltimeout/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:324" version="1" comment="os_sshd_channel_timeout_configure_stig_object">
          <shell>zsh</shell>
          <command>/usr/sbin/sshd -G | /usr/bin/awk '/channeltimeout/{print $2}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:325" version="1" comment="os_safari_prevent_cross-site_tracking_enable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles -P -o stdout | /usr/bin/grep -cE '"WebKitPreferences.storageBlockingPolicy" = 1|"WebKitStorageBlockingPolicy" = 1|"BlockStoragePolicy" =2' | /usr/bin/awk '{ if ($1 &gt;= 1) {print "1"} else {print "0"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:326" version="1" comment="os_mail_app_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Mail.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:329" version="1" comment="os_bonjour_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.mDNSResponder')\
.objectForKey('NoMulticastAdvertisements').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:330" version="1" comment="os_calendar_app_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
function run() {
  let pref1 = ObjC.unwrap($.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('familyControlsEnabled'))
  let pathlist = $.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess.new')\
  .objectForKey('pathBlackList').js
  for ( let app in pathlist ) {
      if ( ObjC.unwrap(pathlist[app]) == "/Applications/Calendar.app" &amp;&amp; pref1 == true ){
          return("true")
      }
  }
  return("false")
  }
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:331" version="1" comment="pwpolicy_account_inactivity_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeInactiveDays"]/following-sibling::integer[1]/text()' -</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:332" version="1" comment="pwpolicy_account_inactivity_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeInactiveDays"]/following-sibling::integer[1]/text()' -</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:333" version="1" comment="pwpolicy_custom_regex_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:334" version="1" comment="pwpolicy_custom_regex_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:335" version="1" comment="pwpolicy_custom_regex_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath 'boolean(//*[contains(text(),"policyAttributePassword matches '\''^(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9]).*$'\''")])' -</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:337" version="1" comment="pwpolicy_max_lifetime_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 60 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:338" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 365 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:339" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 365 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:340" version="1" comment="pwpolicy_max_lifetime_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeExpiresEveryNDays"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 60 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:341" version="1" comment="pwpolicy_history_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 5 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:342" version="1" comment="pwpolicy_history_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:343" version="1" comment="pwpolicy_history_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:344" version="1" comment="pwpolicy_history_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributePasswordHistoryDepth"]/following-sibling::*[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 5 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:347" version="1" comment="pwpolicy_account_lockout_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 3) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:348" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 5) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:349" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 5) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:350" version="1" comment="pwpolicy_account_lockout_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMaximumFailedAuthentications"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &lt;= 3) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:351" version="1" comment="pwpolicy_simple_sequence_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyIdentifier"]/following-sibling::*[1]/text()' - | /usr/bin/grep "allowSimple" -c</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:353" version="1" comment="pwpolicy_lower_case_character_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="minimumAlphaCharactersLowerCase"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 1 ) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:355" version="1" comment="pwpolicy_account_lockout_timeout_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:356" version="1" comment="pwpolicy_account_lockout_timeout_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:357" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:358" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="autoEnableInSeconds"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1/60 &gt;= 15 ) {print "pass"} else {print "fail"}}' | /usr/bin/uniq</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:359" version="1" comment="pwpolicy_special_character_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:360" version="1" comment="pwpolicy_special_character_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:361" version="1" comment="pwpolicy_special_character_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | /usr/bin/tail -n +2 | /usr/bin/xmllint --xpath "//string[contains(text(), \"policyAttributePassword matches '(.*[^a-zA-Z0-9].*){\")]" - 2&gt;/dev/null | /usr/bin/awk -F"{|}" '{if ($2 &gt;= 1) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:362" version="1" comment="pwpolicy_alpha_numeric_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyIdentifier"]/following-sibling::*[1]/text()' - | /usr/bin/grep "requireAlphanumeric" -c</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:363" version="1" comment="pwpolicy_minimum_length_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:364" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl1_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:365" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl2_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=15 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:366" version="1" comment="pwpolicy_minimum_length_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies 2&gt;/dev/null | tail +2 | grep -oE "policyAttributePassword matches '.\{[0-9]+," | awk -F'[{,]' -v ODV=14 '{if ($2 &gt; max) max=$2} END {print (max &gt;= ODV) ? "pass" : "fail"}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:367" version="1" comment="pwpolicy_upper_case_character_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="minimumAlphaCharactersUpperCase"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 1 ) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:369" version="1" comment="pwpolicy_minimum_lifetime_enforce_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMinimumLifetimeHours"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 24 ) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:370" version="1" comment="pwpolicy_minimum_lifetime_enforce_stig_object">
          <shell>zsh</shell>
          <command>/usr/bin/pwpolicy -getaccountpolicies | /usr/bin/tail +2 | /usr/bin/xmllint --xpath '//dict/key[text()="policyAttributeMinimumLifetimeHours"]/following-sibling::integer[1]/text()' - | /usr/bin/awk '{ if ($1 &gt;= 24 ) {print "pass"} else {print "fail"}}'</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:371" version="1" comment="icloud_photos_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudPhotoLibrary').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:372" version="1" comment="icloud_appleid_system_settings_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/profiles show -output stdout-xml | /usr/bin/xmllint --xpath '//key[text()="DisabledSystemSettings"]/following-sibling::*[1]' - | /usr/bin/grep "com.apple.systempreferences.AppleIDSettings"</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:373" version="1" comment="icloud_reminders_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudReminders').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:374" version="1" comment="icloud_freeform_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudFreeform').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:375" version="1" comment="icloud_sync_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudDesktopAndDocuments').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:376" version="1" comment="icloud_game_center_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowGameCenter').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:377" version="1" comment="icloud_keychain_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudKeychainSync').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:378" version="1" comment="icloud_notes_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudNotes').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:379" version="1" comment="icloud_private_relay_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudPrivateRelay').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:380" version="1" comment="icloud_drive_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudDocumentSync').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:381" version="1" comment="icloud_bookmarks_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudBookmarks').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:382" version="1" comment="icloud_mail_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudMail').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:383" version="1" comment="icloud_calendar_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudCalendar').js
EOS</command>
        </shellcommand_object>
        <shellcommand_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:obj:384" version="1" comment="icloud_addressbook_disable_recommended_object">
          <shell>zsh</shell>
          <command>/usr/bin/osascript -l JavaScript &lt;&lt; EOS
$.NSUserDefaults.alloc.initWithSuiteName('com.apple.applicationaccess')\
.objectForKey('allowCloudAddressBook').js
EOS</command>
        </shellcommand_object>
      </objects>
      <states>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:1" version="1" comment="system_settings_internet_accounts_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:2" version="1" comment="system_settings_time_machine_encrypted_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:3" version="1" comment="system_settings_install_macos_updates_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:4" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:5" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_stig_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:6" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl1_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:7" version="1" comment="system_settings_screensaver_ask_for_password_delay_enforce_cis_lvl2_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:8" version="1" comment="system_settings_wallet_applepay_settings_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:9" version="1" comment="system_settings_location_services_menu_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:10" version="1" comment="system_settings_guest_access_smb_disable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:11" version="1" comment="system_settings_printer_sharing_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:12" version="1" comment="system_settings_bluetooth_menu_enable_recommended_state">
          <stdout_line operation="equals">18</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:13" version="1" comment="system_settings_system_wide_preferences_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:14" version="1" comment="system_settings_location_services_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:15" version="1" comment="system_settings_improve_search_disable_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:16" version="1" comment="system_settings_guest_account_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:17" version="1" comment="system_settings_software_update_download_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:18" version="1" comment="system_settings_personalized_advertising_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:19" version="1" comment="system_settings_bluetooth_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:20" version="1" comment="system_settings_remote_management_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:21" version="1" comment="system_settings_loginwindow_prompt_username_password_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:22" version="1" comment="system_settings_apple_watch_unlock_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:23" version="1" comment="system_settings_smbd_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:24" version="1" comment="system_settings_hot_corners_secure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:25" version="1" comment="system_settings_screensaver_timeout_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:26" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl1_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:27" version="1" comment="system_settings_screensaver_timeout_enforce_cis_lvl2_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:28" version="1" comment="system_settings_screensaver_timeout_enforce_stig_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:29" version="1" comment="system_settings_automatic_logout_enforce_recommended_state">
          <stdout_line operation="equals">86400</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:30" version="1" comment="system_settings_automatic_logout_enforce_stig_state">
          <stdout_line operation="equals">86400</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:31" version="1" comment="system_settings_password_hints_disable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:32" version="1" comment="system_settings_screen_sharing_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:33" version="1" comment="system_settings_time_machine_auto_backup_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:34" version="1" comment="system_settings_touchid_unlock_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:36" version="1" comment="system_settings_softwareupdate_current_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:37" version="1" comment="system_settings_external_intelligence_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:38" version="1" comment="system_settings_siri_listen_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:39" version="1" comment="system_settings_internet_sharing_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:40" version="1" comment="system_settings_filevault_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:41" version="1" comment="system_settings_gatekeeper_override_disallow_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:42" version="1" comment="system_settings_ssh_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:43" version="1" comment="system_settings_siri_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:44" version="1" comment="system_settings_content_caching_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:45" version="1" comment="system_settings_ssh_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:46" version="1" comment="system_settings_gatekeeper_identified_developers_allowed_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:47" version="1" comment="system_settings_screensaver_password_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:48" version="1" comment="system_settings_firewall_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:49" version="1" comment="system_settings_find_my_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:50" version="1" comment="system_settings_hot_corners_disable_recommended_state">
          <stdout_line operation="equals">4</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:51" version="1" comment="system_settings_diagnostics_reports_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:52" version="1" comment="system_settings_critical_update_install_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:53" version="1" comment="system_settings_wake_network_access_disable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:54" version="1" comment="system_settings_bluetooth_sharing_disable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:55" version="1" comment="system_settings_automatic_login_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:56" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_recommended_state">
          <stdout_line operation="equals">Center for Internet Security Test Message</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:57" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl1_state">
          <stdout_line operation="equals">Center for Internet Security Test Message</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:58" version="1" comment="system_settings_loginwindow_loginwindowtext_enable_cis_lvl2_state">
          <stdout_line operation="equals">Center for Internet Security Test Message</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:59" version="1" comment="system_settings_improve_siri_dictation_disable_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:60" version="1" comment="system_settings_download_software_update_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:61" version="1" comment="system_settings_touch_id_settings_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:62" version="1" comment="system_settings_external_intelligence_sign_in_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:63" version="1" comment="system_settings_bluetooth_settings_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:64" version="1" comment="system_settings_location_services_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:65" version="1" comment="system_settings_usb_restricted_mode_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:66" version="1" comment="system_settings_time_server_configure_recommended_state">
          <stdout_line operation="equals">time.nist.gov</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:67" version="1" comment="system_settings_time_server_configure_cis_lvl1_state">
          <stdout_line operation="equals">time.apple.com</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:68" version="1" comment="system_settings_time_server_configure_cis_lvl2_state">
          <stdout_line operation="equals">time.apple.com</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:69" version="1" comment="system_settings_time_server_configure_stig_state">
          <stdout_line operation="equals">time.nist.gov</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:70" version="1" comment="system_settings_time_server_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:71" version="1" comment="system_settings_siri_settings_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:72" version="1" comment="system_settings_improve_assistive_voice_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:73" version="1" comment="system_settings_airplay_receiver_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:74" version="1" comment="system_settings_security_update_install_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:75" version="1" comment="system_settings_token_removal_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:76" version="1" comment="system_settings_media_sharing_disabled_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:77" version="1" comment="system_settings_wifi_menu_enable_recommended_state">
          <stdout_line operation="equals">18</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:78" version="1" comment="system_settings_firewall_stealth_mode_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:79" version="1" comment="system_settings_rae_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:81" version="1" comment="auth_pam_login_smartcard_enforce_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:82" version="1" comment="auth_smartcard_allow_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:83" version="1" comment="auth_pam_sudo_smartcard_enforce_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:84" version="1" comment="auth_smartcard_certificate_trust_enforce_high_recommended_state">
          <stdout_line operation="equals">3</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:85" version="1" comment="auth_smartcard_certificate_trust_enforce_moderate_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:86" version="1" comment="auth_smartcard_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:87" version="1" comment="auth_pam_su_smartcard_enforce_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:88" version="1" comment="auth_ssh_password_authentication_disable_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:89" version="1" comment="audit_flags_fd_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:91" version="1" comment="audit_folder_group_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:92" version="1" comment="audit_failure_halt_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:93" version="1" comment="audit_flags_fm_failed_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:96" version="1" comment="audit_control_mode_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:97" version="1" comment="audit_acls_folders_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:98" version="1" comment="audit_flags_fm_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:99" version="1" comment="audit_auditd_enabled_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:100" version="1" comment="audit_flags_ad_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:101" version="1" comment="audit_flags_ex_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:102" version="1" comment="audit_files_mode_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:103" version="1" comment="audit_flags_aa_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:104" version="1" comment="audit_control_owner_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:105" version="1" comment="audit_files_owner_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:106" version="1" comment="audit_retention_configure_recommended_state">
          <stdout_line operation="equals">7d</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:107" version="1" comment="audit_retention_configure_cis_lvl1_state">
          <stdout_line operation="equals">60d OR 5G</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:108" version="1" comment="audit_retention_configure_cis_lvl2_state">
          <stdout_line operation="equals">60d OR 5G</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:109" version="1" comment="audit_retention_configure_stig_state">
          <stdout_line operation="equals">7d</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:110" version="1" comment="audit_flags_fr_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:111" version="1" comment="audit_settings_failure_notify_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:112" version="1" comment="audit_folder_owner_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:114" version="1" comment="audit_control_acls_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:115" version="1" comment="audit_flags_lo_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:117" version="1" comment="audit_flags_fw_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:118" version="1" comment="audit_folders_mode_configure_recommended_state">
          <stdout_line operation="equals">700</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:119" version="1" comment="audit_configure_capacity_notify_recommended_state">
          <stdout_line operation="equals">25</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:120" version="1" comment="audit_configure_capacity_notify_stig_state">
          <stdout_line operation="equals">25</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:121" version="1" comment="audit_files_group_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:122" version="1" comment="audit_control_group_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:123" version="1" comment="audit_acls_files_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:126" version="1" comment="os_sshd_unused_connection_timeout_configure_recommended_state">
          <stdout_line operation="equals">900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:127" version="1" comment="os_sshd_unused_connection_timeout_configure_stig_state">
          <stdout_line operation="equals">900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:129" version="1" comment="os_sshd_login_grace_time_configure_recommended_state">
          <stdout_line operation="equals">30</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:130" version="1" comment="os_sshd_login_grace_time_configure_stig_state">
          <stdout_line operation="equals">30</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:132" version="1" comment="os_newsyslog_files_owner_group_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:133" version="1" comment="os_firewall_default_deny_require_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:136" version="1" comment="os_dvdram_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:138" version="1" comment="os_sshd_fips_compliant_recommended_state">
          <stdout_line operation="equals">7</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:139" version="1" comment="os_firmware_password_require_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:140" version="1" comment="os_photos_enhanced_search_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:141" version="1" comment="os_power_nap_disable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:142" version="1" comment="os_safari_warn_fraudulent_website_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:143" version="1" comment="os_power_nap_enable_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:144" version="1" comment="os_root_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:146" version="1" comment="os_policy_banner_ssh_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:148" version="1" comment="os_safari_clear_history_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:150" version="1" comment="os_password_proximity_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:151" version="1" comment="os_library_validation_enabled_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:152" version="1" comment="os_notes_transcription_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:153" version="1" comment="os_mdm_require_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:154" version="1" comment="os_skip_apple_intelligence_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:159" version="1" comment="os_anti_virus_installed_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:161" version="1" comment="os_screensaver_loginwindow_enforce_recommended_state">
          <stdout_line operation="equals">Tahoe</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:162" version="1" comment="os_mail_smart_reply_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:163" version="1" comment="os_world_writable_system_folder_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:164" version="1" comment="os_handoff_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:166" version="1" comment="os_iphone_mirroring_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:170" version="1" comment="os_safari_open_safe_downloads_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:171" version="1" comment="os_ssh_server_alive_interval_configure_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:172" version="1" comment="os_ssh_server_alive_interval_configure_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:173" version="1" comment="os_mail_summary_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:174" version="1" comment="os_ssh_fips_compliant_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:178" version="1" comment="os_rapid_security_response_allow_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:181" version="1" comment="os_network_storage_restriction_recommended_state">
          <stdout_line operation="equals">Allowed</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:182" version="1" comment="os_time_offset_limit_configure_recommended_state">
          <stdout_line operation="equals">Yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:183" version="1" comment="os_tftpd_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:184" version="1" comment="os_password_autofill_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:185" version="1" comment="os_sshd_client_alive_interval_configure_recommended_state">
          <stdout_line operation="equals">900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:186" version="1" comment="os_sshd_client_alive_interval_configure_stig_state">
          <stdout_line operation="equals">900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:188" version="1" comment="os_asl_log_files_permissions_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:191" version="1" comment="os_safari_private_browsing_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:192" version="1" comment="os_password_sharing_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:193" version="1" comment="os_blank_bluray_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:195" version="1" comment="os_notes_transcription_summary_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:197" version="1" comment="os_authenticated_root_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:198" version="1" comment="os_screensaver_timeout_loginwindow_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:200" version="1" comment="os_safari_advertising_privacy_protection_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:202" version="1" comment="os_config_data_install_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:203" version="1" comment="os_setup_assistant_filevault_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:207" version="1" comment="os_sleep_and_display_sleep_apple_silicon_enable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:208" version="1" comment="os_guest_folder_removed_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:210" version="1" comment="os_password_hint_remove_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:211" version="1" comment="os_disk_image_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:212" version="1" comment="os_sshd_client_alive_count_max_configure_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:213" version="1" comment="os_sshd_client_alive_count_max_configure_stig_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:215" version="1" comment="os_privacy_setup_prompt_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:217" version="1" comment="os_software_update_app_update_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:219" version="1" comment="os_image_playground_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:220" version="1" comment="os_secure_boot_verify_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:221" version="1" comment="os_sudo_log_enforce_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:223" version="1" comment="os_uucp_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:224" version="1" comment="os_burn_support_disable_recommended_state">
          <stdout_line operation="equals">2</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:225" version="1" comment="os_policy_banner_loginwindow_enforce_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:226" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl1_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:227" version="1" comment="os_policy_banner_loginwindow_enforce_cis_lvl2_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:228" version="1" comment="os_policy_banner_loginwindow_enforce_stig_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:229" version="1" comment="os_writing_tools_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:230" version="1" comment="os_user_app_installation_prohibit_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:234" version="1" comment="os_rapid_security_response_removal_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:235" version="1" comment="os_touchid_prompt_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:236" version="1" comment="os_filevault_autologin_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:237" version="1" comment="os_skip_screen_time_prompt_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:239" version="1" comment="os_blank_cd_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:241" version="1" comment="os_messages_app_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:242" version="1" comment="os_config_profile_ui_install_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:244" version="1" comment="os_sshd_per_source_penalties_configure_recommended_state">
          <stdout_line operation="equals">yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:246" version="1" comment="os_genmoji_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:247" version="1" comment="os_airdrop_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:248" version="1" comment="os_sudoers_timestamp_type_configure_recommended_state">
          <stdout_line operation="equals">tty</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:251" version="1" comment="os_parental_controls_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:254" version="1" comment="os_system_read_only_recommended_state">
          <stdout_line operation="equals">No</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:255" version="1" comment="os_ssh_server_alive_count_max_configure_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:256" version="1" comment="os_ssh_server_alive_count_max_configure_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:257" version="1" comment="os_hibernate_mode_destroyfvkeyonstandby_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:258" version="1" comment="os_nfsd_disable_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:260" version="1" comment="os_sshd_permit_root_login_configure_recommended_state">
          <stdout_line operation="equals">no</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:261" version="1" comment="os_account_modification_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:262" version="1" comment="os_httpd_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:264" version="1" comment="os_asl_log_files_owner_group_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:265" version="1" comment="os_hibernate_mode_intel_enable_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:268" version="1" comment="os_recovery_lock_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:269" version="1" comment="os_blank_dvd_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:270" version="1" comment="os_loginwindow_adminhostinfo_disabled_recommended_state">
          <stdout_line operation="equals">-1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:271" version="1" comment="os_safari_show_full_website_address_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:273" version="1" comment="os_mobile_file_integrity_enable_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:274" version="1" comment="os_gatekeeper_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:275" version="1" comment="os_sip_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:276" version="1" comment="os_removable_media_disable_recommended_state">
          <stdout_line operation="equals">deny</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:277" version="1" comment="os_world_writable_library_folder_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:278" version="1" comment="os_dictation_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:279" version="1" comment="os_policy_banner_ssh_configure_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:280" version="1" comment="os_policy_banner_ssh_configure_stig_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:281" version="1" comment="os_terminal_secure_keyboard_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:283" version="1" comment="os_time_server_enabled_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:284" version="1" comment="os_unlock_active_user_session_disable_recommended_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:285" version="1" comment="os_unlock_active_user_session_disable_cis_lvl1_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:286" version="1" comment="os_unlock_active_user_session_disable_cis_lvl2_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:287" version="1" comment="os_unlock_active_user_session_disable_stig_state">
          <stdout_line operation="equals">PASS</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:289" version="1" comment="os_sudo_timeout_configure_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:290" version="1" comment="os_sudo_timeout_configure_cis_lvl1_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:291" version="1" comment="os_sudo_timeout_configure_cis_lvl2_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:292" version="1" comment="os_sudo_timeout_configure_stig_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:293" version="1" comment="os_siri_prompt_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:294" version="1" comment="os_appleid_prompt_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:297" version="1" comment="os_directory_services_configured_recommended_state">
          <stdout_line operation="equals">0</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:298" version="1" comment="os_safari_show_status_bar_enabled_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:300" version="1" comment="os_skip_unlock_with_watch_enable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:301" version="1" comment="os_safari_reader_summary_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:303" version="1" comment="os_system_wide_applications_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:305" version="1" comment="os_software_update_deferral_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:306" version="1" comment="os_software_update_deferral_cis_lvl1_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:307" version="1" comment="os_software_update_deferral_cis_lvl2_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:308" version="1" comment="os_newsyslog_files_permissions_configure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:309" version="1" comment="os_home_folders_secure_recommended_state">
          <stdout_line check_existence="none_exist"/>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:310" version="1" comment="os_bluray_read_only_enforce_recommended_state">
          <stdout_line operation="equals">read-only</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:311" version="1" comment="os_facetime_app_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:312" version="1" comment="os_camera_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:313" version="1" comment="os_on_device_dictation_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:314" version="1" comment="os_external_storage_access_defined_recommended_state">
          <stdout_line operation="equals">Allowed</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:315" version="1" comment="os_install_log_retention_configure_recommended_state">
          <stdout_line operation="equals">Yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:316" version="1" comment="os_install_log_retention_configure_cis_lvl1_state">
          <stdout_line operation="equals">Yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:317" version="1" comment="os_install_log_retention_configure_cis_lvl2_state">
          <stdout_line operation="equals">Yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:318" version="1" comment="os_install_log_retention_configure_stig_state">
          <stdout_line operation="equals">Yes</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:319" version="1" comment="os_icloud_storage_prompt_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:320" version="1" comment="os_erase_content_and_settings_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:321" version="1" comment="os_ir_support_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:322" version="1" comment="os_cd_read_only_enforce_recommended_state">
          <stdout_line operation="equals">read-only</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:323" version="1" comment="os_sshd_channel_timeout_configure_recommended_state">
          <stdout_line operation="equals">session:*=900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:324" version="1" comment="os_sshd_channel_timeout_configure_stig_state">
          <stdout_line operation="equals">session:*=900</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:325" version="1" comment="os_safari_prevent_cross-site_tracking_enable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:326" version="1" comment="os_mail_app_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:329" version="1" comment="os_bonjour_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:330" version="1" comment="os_calendar_app_disable_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:331" version="1" comment="pwpolicy_account_inactivity_enforce_recommended_state">
          <stdout_line operation="equals">35</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:332" version="1" comment="pwpolicy_account_inactivity_enforce_stig_state">
          <stdout_line operation="equals">35</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:333" version="1" comment="pwpolicy_custom_regex_enforce_recommended_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:334" version="1" comment="pwpolicy_custom_regex_enforce_cis_lvl2_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:335" version="1" comment="pwpolicy_custom_regex_enforce_stig_state">
          <stdout_line operation="equals">true</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:337" version="1" comment="pwpolicy_max_lifetime_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:338" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl1_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:339" version="1" comment="pwpolicy_max_lifetime_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:340" version="1" comment="pwpolicy_max_lifetime_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:341" version="1" comment="pwpolicy_history_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:342" version="1" comment="pwpolicy_history_enforce_cis_lvl1_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:343" version="1" comment="pwpolicy_history_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:344" version="1" comment="pwpolicy_history_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:347" version="1" comment="pwpolicy_account_lockout_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:348" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl1_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:349" version="1" comment="pwpolicy_account_lockout_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:350" version="1" comment="pwpolicy_account_lockout_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:351" version="1" comment="pwpolicy_simple_sequence_disable_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:353" version="1" comment="pwpolicy_lower_case_character_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:355" version="1" comment="pwpolicy_account_lockout_timeout_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:356" version="1" comment="pwpolicy_account_lockout_timeout_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:357" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl1_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:358" version="1" comment="pwpolicy_account_lockout_timeout_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:359" version="1" comment="pwpolicy_special_character_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:360" version="1" comment="pwpolicy_special_character_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:361" version="1" comment="pwpolicy_special_character_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:362" version="1" comment="pwpolicy_alpha_numeric_enforce_recommended_state">
          <stdout_line operation="equals">1</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:363" version="1" comment="pwpolicy_minimum_length_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:364" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl1_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:365" version="1" comment="pwpolicy_minimum_length_enforce_cis_lvl2_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:366" version="1" comment="pwpolicy_minimum_length_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:367" version="1" comment="pwpolicy_upper_case_character_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:369" version="1" comment="pwpolicy_minimum_lifetime_enforce_recommended_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:370" version="1" comment="pwpolicy_minimum_lifetime_enforce_stig_state">
          <stdout_line operation="equals">pass</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:371" version="1" comment="icloud_photos_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:372" version="1" comment="icloud_appleid_system_settings_disable_recommended_state">
          <stdout_line operation="pattern match">.*</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:373" version="1" comment="icloud_reminders_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:374" version="1" comment="icloud_freeform_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:375" version="1" comment="icloud_sync_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:376" version="1" comment="icloud_game_center_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:377" version="1" comment="icloud_keychain_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:378" version="1" comment="icloud_notes_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:379" version="1" comment="icloud_private_relay_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:380" version="1" comment="icloud_drive_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:381" version="1" comment="icloud_bookmarks_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:382" version="1" comment="icloud_mail_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:383" version="1" comment="icloud_calendar_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
        <shellcommand_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:mscp:ste:384" version="1" comment="icloud_addressbook_disable_recommended_state">
          <stdout_line operation="equals">false</stdout_line>
        </shellcommand_state>
      </states>
    </oval_definitions>
  </component>
  <component id="scap_gov.nist.mscp.content_comp_macOS_26.0_check_2" timestamp="2025-09-11T15:25:32">
    <ocil xmlns="http://scap.nist.gov/schema/ocil/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://scap.nist.gov/schema/ocil/2.0 ocil-2.0.xsd">
      <generator>
        <product_name>Manual Labor</product_name>
        <product_version>1</product_version>
        <schema_version>2.0</schema_version>
        <timestamp>2025-09-11T15:25:32</timestamp>
      </generator>
      <questionnaires>
        <questionnaire id="ocil:gov.nist.mscp.content:questionnaire:1">
          <title>Obtain a pass or a fail</title>
          <actions>
            <test_action_ref>ocil:gov.nist.mscp.content:testaction:1</test_action_ref>
          </actions>
        </questionnaire>
      </questionnaires>
      <test_actions>
        <boolean_question_test_action id="ocil:gov.nist.mscp.content:testaction:1" question_ref="ocil:gov.nist.mscp.content:question:1">
          <when_true>
            <result>PASS</result>
          </when_true>
          <when_false>
            <result>FAIL</result>
          </when_false>
        </boolean_question_test_action>
      </test_actions>
      <questions>
        <boolean_question id="ocil:gov.nist.mscp.content:question:1">
          <question_text>Do you wish this checklist item to be considered to have passed?</question_text>
        </boolean_question>
      </questions>
    </ocil>
  </component>
  <component id="scap_gov.nist.mscp.content_comp_macOS_26.0_macOS-cpe-dictionary.xml" timestamp="2025-09-11T15:25:32">
    <?xml-model href="https://scap.nist.gov/schema/cpe/2.3/cpe-dictionary_2.3.xsd" schematypens="http://www.w3.org/2001/XMLSchema" title="CPE XML schema"?>
    <cpe-list xmlns="http://cpe.mitre.org/dictionary/2.0" xmlns:cpe-23="http://scap.nist.gov/schema/cpe-extension/2.3">
      <generator>
        <product_name>macOS Security Compliance Project</product_name>
        <schema_version>2.3</schema_version>
        <timestamp>2025-09-11T15:25:32</timestamp>
      </generator>
      <cpe-item name="cpe:/o:apple:macos:26.0">
        <title xml:lang="en-US">Apple macOS 26.0</title>
        <notes xml:lang="en-US">
          <note>This CPE Name represents macOS 26.0</note>
        </notes>
        <check href="macOS-cpe-oval.xml" system="http://oval.mitre.org/XMLSchema/oval-definitions-5">oval:gov.nist.mscp.content.cpe.oval:def:1</check>
        <cpe-23:cpe23-item name="cpe:2.3:o:apple:macos:26.0:*:*:*:*:*:*:*"/>
      </cpe-item>
    </cpe-list>
  </component>
  <component id="scap_gov.nist.mscp.content_comp_macOS_26.0_macOS-cpe-oval.xml" timestamp="2025-09-11T15:25:32">
    <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#macos https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/macos-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix https://raw.githubusercontent.com/OVAL-Community/OVAL/master/oval-schemas/unix-definitions-schema.xsd">
      <generator>
        <oval:product_name>macOS Security Compliance Project</oval:product_name>
        <oval:schema_version>5.12.1</oval:schema_version>
        <oval:timestamp>2025-09-11T15:25:32</oval:timestamp>
      </generator>
      <definitions>
        <definition id="oval:gov.nist.mscp.content.cpe.oval:def:1" version="1" class="inventory">
          <metadata>
            <title>Apple macOS 26.0 is installed</title>
            <affected family="macos">
              <platform>macOS</platform>
            </affected>
            <reference source="CPE" ref_id="cpe:/o:apple:macos:26.0"/>
            <description>The operating system installed on the system is Apple macOS (26.0).</description>
          </metadata>
          <criteria operator="AND">
            <criterion comment="The Installed Operating System is Part of the Mac OS Family" test_ref="oval:gov.nist.mscp.content.cpe:tst:1"/>
            <criterion comment="Apple macOS version is greater than or equal to 26.0" test_ref="oval:gov.nist.mscp.content.cpe:tst:2"/>
          </criteria>
        </definition>
      </definitions>
      <tests>
        <family_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" check="all" check_existence="only_one_exists" comment="The Installed Operating System is Part of the macOS Family" id="oval:gov.nist.mscp.content.cpe:tst:1" version="1">
          <object object_ref="oval:gov.nist.mscp.content.cpe:obj:1"/>
          <state state_ref="oval:gov.nist.mscp.content.cpe:ste:1"/>
        </family_test>
        <plist511_test xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" check="all" check_existence="only_one_exists" comment="Apple macOS version is greater than 26.0" id="oval:gov.nist.mscp.content.cpe:tst:2" version="2">
          <object object_ref="oval:gov.nist.mscp.content.cpe:obj:2"/>
          <state state_ref="oval:gov.nist.mscp.content.cpe:ste:2"/>
        </plist511_test>
      </tests>
      <objects>
        <family_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:gov.nist.mscp.content.cpe:obj:1" version="1" comment="This variable_object represents the family that the operating system belongs to."/>
        <plist511_object xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="The macOS product version plist object." id="oval:gov.nist.mscp.content.cpe:obj:2" version="1">
          <filepath>/System/Library/CoreServices/SystemVersion.plist</filepath>
          <xpath>//*[contains(text(), "ProductVersion")]/following-sibling::*[1]/text()</xpath>
        </plist511_object>
      </objects>
      <states>
        <family_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" id="oval:gov.nist.mscp.content.cpe:ste:1" version="1" comment="The OS is part of the macOS Family.">
          <family>macos</family>
        </family_state>
        <plist511_state xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" comment="Is the value is greater than or equal to 26.0" id="oval:gov.nist.mscp.content.cpe:ste:2" version="1">
          <value_of datatype="version" operation="greater than or equal">26.0</value_of>
        </plist511_state>
      </states>
    </oval_definitions>
  </component>
</data-stream-collection>
